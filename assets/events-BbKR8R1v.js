import{d,e as u,f as l,g as c,l as m,h as f,j as p,k as s,a as h,m as v,n as F,o as b}from"./controller-DfdUmPnp.js";import{i as T,a as E}from"./reservationsSummary-CBdNx1nm.js";import{l as R}from"./storage-DOnDLvtb.js";function g(){document.querySelectorAll('input[type="time"]').forEach(e=>{e.setAttribute("step","3600"),e.dataset.listenerAttached!=="true"&&(e.addEventListener("change",()=>{if(!e.value)return;const[a]=e.value.split(":");e.value=`${a.padStart(2,"0")}:00`}),e.dataset.listenerAttached="true")})}function y(){return typeof window<"u"&&typeof window.flatpickr=="function"?window.flatpickr.bind(window):typeof globalThis<"u"&&typeof globalThis.flatpickr=="function"?globalThis.flatpickr.bind(globalThis):(console.warn("⚠️ Flatpickr غير متاح - سيتم تخطي تهيئة عناصر التاريخ"),null)}function I(){const t=y();if(!t)return;const e=[["#res-start",{dateFormat:"Y-m-d"}],["#res-end",{dateFormat:"Y-m-d"}],["#filter-start-date",{dateFormat:"Y-m-d"}],["#filter-end-date",{dateFormat:"Y-m-d"}],["#edit-res-start",{dateFormat:"Y-m-d"}],["#edit-res-end",{dateFormat:"Y-m-d"}]],a=[["#res-start-time",{enableTime:!0,noCalendar:!0,dateFormat:"H:i",altInput:!0,altFormat:"h:i K",time_24hr:!1,defaultHour:9,defaultMinute:0}],["#res-end-time",{enableTime:!0,noCalendar:!0,dateFormat:"H:i",altInput:!0,altFormat:"h:i K",time_24hr:!1,defaultHour:9,defaultMinute:0}],["#edit-res-start-time",{enableTime:!0,noCalendar:!0,dateFormat:"H:i",altInput:!0,altFormat:"h:i K",time_24hr:!1,defaultHour:9,defaultMinute:0}],["#edit-res-end-time",{enableTime:!0,noCalendar:!0,dateFormat:"H:i",altInput:!0,altFormat:"h:i K",time_24hr:!1,defaultHour:9,defaultMinute:0}]];[...e,...a].forEach(([n,o])=>{document.querySelector(n)&&t(n,o)});const r=document.querySelector("#res-start-time");r&&r.dispatchEvent(new Event("change",{bubbles:!0}))}function k(){g(),l(()=>h()),c(v()),T({onDraftChange:F,onEditChange:s}),m(),f()}function w(){const t=document.body;t&&t.dataset.reservationsTechListener!=="true"&&(document.addEventListener("technicians:updated",()=>{const{technicians:e=[]}=R();E(e),p(),s()}),t.dataset.reservationsTechListener="true")}function i(){d(),u({onAfterSubmit:b}),k(),I(),w()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",i,{once:!0}):i();export{k as s};
