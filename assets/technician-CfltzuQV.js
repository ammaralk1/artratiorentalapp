import{r as R,n as m,t as c}from"./utils-BcYEmFqz.js";import{d as E,g as T,h as L,j as $,s as M}from"./reservationsUI-Nf5UWmZI.js";import{a as _,i as C}from"./theme-BbjGP3KI.js";R({ar:{"technicianDetails.pageTitle":"معلومات عضو الطاقم","technicianDetails.title":"😎 بيانات عضو الطاقم","technicianDetails.actions.back":"⬅️ العودة","technicianDetails.actions.edit":"✏️ تعديل عضو الطاقم","technicianDetails.filters.search":"🔍 ابحث باسم العميل أو رقم الحجز...","technicianDetails.fields.role":"👔 الوظيفة:","technicianDetails.fields.department":"🧩 القسم:","technicianDetails.fields.phone":"📞 الجوال:","technicianDetails.fields.wage":"💰 الأجر اليومي:","technicianDetails.fields.baseStatus":"⚙️ الحالة الأساسية:","technicianDetails.fields.notes":"📝 الملاحظات:","technicianDetails.fallback.name":"—","technicianDetails.fallback.role":"غير محدد","technicianDetails.fallback.department":"—","technicianDetails.fallback.notes":"—","technicianDetails.errors.missingId":"⚠️ لا يوجد معرف عضو طاقم في الرابط.","technicianDetails.errors.notFound":"⚠️ لم يتم العثور على هذا العضو.","technicianDetails.edit.modalTitle":"✏️ تعديل بيانات عضو الطاقم","technicians.picker.actions.apply":"تم"},en:{"technicianDetails.pageTitle":"Crew Member Details","technicianDetails.title":"😎 Crew Member Profile","technicianDetails.actions.back":"⬅️ Back","technicianDetails.actions.edit":"✏️ Edit Crew Member","technicianDetails.filters.search":"🔍 Search by client or reservation ID...","technicianDetails.fields.role":"👔 Role:","technicianDetails.fields.department":"🧩 Department:","technicianDetails.fields.phone":"📞 Phone:","technicianDetails.fields.wage":"💰 Daily Rate:","technicianDetails.fields.baseStatus":"⚙️ Base Status:","technicianDetails.fields.notes":"📝 Notes:","technicianDetails.fallback.name":"—","technicianDetails.fallback.role":"Not specified","technicianDetails.fallback.department":"—","technicianDetails.fallback.notes":"—","technicianDetails.errors.missingId":"⚠️ Missing crew member identifier in the URL.","technicianDetails.errors.notFound":"⚠️ Crew member not found.","technicianDetails.edit.modalTitle":"✏️ Edit Crew Member","technicians.picker.actions.apply":"Done"}});let y={};function A(e=""){return m(String(e)).trim().toLowerCase()}function F(e,s,a){if(!s||!a)return;const{startDate:t,endDate:i}=T(e);s._flatpickr?t?s._flatpickr.setDate(t,!1,"Y-m-d"):s._flatpickr.clear():s.value=t||"",a._flatpickr?i?a._flatpickr.setDate(i,!1,"Y-m-d"):a._flatpickr.clear():a.value=i||""}function I(e){if(!document.getElementById("technician-reservations"))return;const a=document.getElementById("technician-search-reservation"),t=document.getElementById("technician-filter-start-date"),i=document.getElementById("technician-filter-end-date"),n=document.getElementById("technician-reservation-date-range"),l=document.getElementById("technician-reservation-status-filter"),o=document.getElementById("technician-clear-filters");window.flatpickr&&(t&&window.flatpickr(t,{dateFormat:"Y-m-d"}),i&&window.flatpickr(i,{dateFormat:"Y-m-d"}));const v=()=>{let d=m((t==null?void 0:t.value)||"").trim(),h=m((i==null?void 0:i.value)||"").trim(),f=(n==null?void 0:n.value)||"";if(new Set(["","today","week","month"]).has(f)||(f="",n&&(n.value=""),t&&(t._flatpickr&&t._flatpickr.clear(),t.value=""),i&&(i._flatpickr&&i._flatpickr.clear(),i.value=""),d="",h=""),!d&&!h&&f){const{startDate:g,endDate:D}=T(f);d=g,h=D}const k=(a==null?void 0:a.value)||"",u=A(k);return{searchTerm:u,searchReservationId:u,searchCustomerName:u,startDate:d,endDate:h,status:(l==null?void 0:l.value)||"",quickRange:f,technicianId:e}},r=()=>{y=v(),E("technician-reservations",y)};a&&!a.dataset.listenerAttached&&(a.addEventListener("input",()=>{a.value=m(a.value),r()}),a.dataset.listenerAttached="true"),t&&!t.dataset.listenerAttached&&(t.addEventListener("change",()=>{n&&(n.value=""),r()}),t.dataset.listenerAttached="true"),i&&!i.dataset.listenerAttached&&(i.addEventListener("change",()=>{n&&(n.value=""),r()}),i.dataset.listenerAttached="true"),n&&!n.dataset.listenerAttached&&(n.addEventListener("change",()=>{F(n.value,t,i),r()}),n.dataset.listenerAttached="true"),l&&!l.dataset.listenerAttached&&(l.addEventListener("change",r),l.dataset.listenerAttached="true"),o&&!o.dataset.listenerAttached&&(o.addEventListener("click",()=>{a&&(a.value=""),t&&(t._flatpickr&&t._flatpickr.clear(),t.value=""),i&&(i._flatpickr&&i._flatpickr.clear(),i.value=""),n&&(n.value=""),l&&(l.value=""),r()}),o.dataset.listenerAttached="true"),window.refreshTechnicianReservationsViews=()=>{E("technician-reservations",y)},r()}_();const V=new URLSearchParams(window.location.search),p=V.get("id"),w=document.getElementById("technician-details");window.showReservationDetails=L;C();function N(e){const s=Number(e??0);return Number.isFinite(s)?s.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:2}):"0"}function B(e){const s=e.name||c("technicianDetails.fallback.name","—"),a=e.status==="busy"?"technicians.status.busy":"technicians.status.available",i=`
        <span class="badge ${e.status==="busy"?"bg-danger":"bg-success"}" data-i18n data-i18n-key="${a}">
          ${c(a)}
        </span>
      `,n=e.phone?m(e.phone):`<span data-i18n data-i18n-key="reservations.details.technicians.phoneUnknown">${c("reservations.details.technicians.phoneUnknown","غير متوفر")}</span>`,l=e.role?e.role:`<span data-i18n data-i18n-key="technicianDetails.fallback.role">${c("technicianDetails.fallback.role","غير محدد")}</span>`,o=e.department?e.department:`<span data-i18n data-i18n-key="technicianDetails.fallback.department">${c("technicianDetails.fallback.department","—")}</span>`,v=e.notes?e.notes:`<span data-i18n data-i18n-key="technicianDetails.fallback.notes">${c("technicianDetails.fallback.notes","—")}</span>`,d=`<span data-i18n data-i18n-key="reservations.create.summary.currency">${c("reservations.create.summary.currency","ريال")}</span>`,h=`${N(e.dailyWage)} ${d}`,b=(e.baseStatus||e.status||"available")==="busy"?"technicians.status.busy":"technicians.status.available",k=`<span data-i18n data-i18n-key="${b}">${c(b)}</span>`,u=c("technicianDetails.actions.edit","✏️ تعديل عضو الطاقم"),g=[{key:"technicianDetails.fields.role",value:l},{key:"technicianDetails.fields.department",value:o},{key:"technicianDetails.fields.phone",value:n},{key:"technicianDetails.fields.wage",value:h},{key:"technicianDetails.fields.baseStatus",value:k},{key:"technicianDetails.fields.notes",value:v}].map(({key:D,value:S})=>`
        <p class="technician-detail-row">
          <strong data-i18n data-i18n-key="${D}">${c(D)}</strong>
          <span>${S}</span>
        </p>
      `).join("");w.innerHTML=`
        <div class="technician-details">
          <div class="d-flex align-items-center gap-2 technician-header">
            <h3 class="mb-0 technician-name">${s}</h3>
            ${i}
          </div>
          <div class="technician-details-body">
            ${g}
          </div>
          <div class="d-flex justify-content-start mt-3 gap-2">
            <button type="button" class="btn btn-warning" id="edit-technician-btn" data-i18n data-i18n-key="technicianDetails.actions.edit">${u}</button>
          </div>
        </div>
      `}function x(){if(!p){w.innerHTML=`<p class="text-danger" data-i18n data-i18n-key="technicianDetails.errors.missingId">${c("technicianDetails.errors.missingId","⚠️ لا يوجد معرف عضو طاقم في الرابط.")}</p>`;return}M();const e=$(p);if(!e)w.innerHTML=`<p class="text-danger" data-i18n data-i18n-key="technicianDetails.errors.notFound">${c("technicianDetails.errors.notFound","⚠️ لم يتم العثور على هذا العضو.")}</p>`;else{B(e),I(p);const s=document.getElementById("edit-technician-btn");s&&(s.onclick=()=>{var t;const a=document.getElementById("editTechnicianModal");document.dispatchEvent(new CustomEvent("technician:prefill",{detail:e})),a&&((t=window.bootstrap)!=null&&t.Modal)&&window.bootstrap.Modal.getOrCreateInstance(a).show()})}}document.addEventListener("technicians:updated",()=>{if(!p)return;const e=$(p);if(!e)return;B(e),typeof window.refreshTechnicianReservationsViews=="function"&&window.refreshTechnicianReservationsViews();const s=document.getElementById("edit-technician-btn");s&&e&&(s.onclick=()=>{var t;const a=document.getElementById("editTechnicianModal");document.dispatchEvent(new CustomEvent("technician:prefill",{detail:e})),a&&((t=window.bootstrap)!=null&&t.Modal)&&window.bootstrap.Modal.getOrCreateInstance(a).show()})});x();
