import{l as h}from"./auth.js";const a={projects:["stat-projects","sidebar-stat-projects"],reservations:["stat-reservations","sidebar-stat-reservations"],equipment:["stat-equipment","sidebar-stat-equipment"],technicians:["stat-technicians","sidebar-stat-technicians"]};let c=!1;const d=1632,l=1776;function f(t){if(t==null)return 0;if(typeof t=="number"&&Number.isFinite(t))return t;const e=String(t).trim().replace(/[\s,_]/g,"").replace(/[\u0660-\u0669]/g,s=>String(s.charCodeAt(0)-d)).replace(/[\u06f0-\u06f9]/g,s=>String(s.charCodeAt(0)-l)).replace(/[^0-9.+-]/g,""),r=Number(e);return Number.isFinite(r)?r:0}function g(t){try{const e=f(t);return new Intl.NumberFormat("en-US",{maximumFractionDigits:0,useGrouping:!0}).format(e)}catch{return String(t??0)}}function i(t,e){if(!t)return;const r=document.getElementById(t);r&&(r.textContent=g(e))}function o(){c=!1;let t=null;try{t=h()}catch{t=null}const e=t&&typeof t=="object"?t:{},r=Array.isArray(e.projects)?e.projects.length:0,s=Array.isArray(e.reservations)?e.reservations.length:0,m=Array.isArray(e.equipment)?e.equipment.length:0,p=Array.isArray(e.technicians)?e.technicians.length:0;a.projects.forEach(n=>i(n,r)),a.reservations.forEach(n=>i(n,s)),a.equipment.forEach(n=>i(n,m)),a.technicians.forEach(n=>i(n,p))}function u(){c||(c=!0,typeof requestAnimationFrame=="function"?requestAnimationFrame(o):setTimeout(o,16))}function E(){["reservations:changed","projects:changed","equipment:changed","technicians:changed","customers:changed","maintenance:updated","language:changed"].forEach(e=>{document.addEventListener(e,u,{passive:!0})}),u()}export{E as initDashboardMetrics};
