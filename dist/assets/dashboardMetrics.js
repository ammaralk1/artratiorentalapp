import{l as d}from"./auth.js";const a={projects:["stat-projects","sidebar-stat-projects"],reservations:["stat-reservations","sidebar-stat-reservations"],equipment:["stat-equipment","sidebar-stat-equipment"],technicians:["stat-technicians","sidebar-stat-technicians"]};let c=!1;const p=1632,h=1776;function f(e){if(e==null)return 0;if(typeof e=="number"&&Number.isFinite(e))return e;const t=String(e).trim().replace(/[\s,_]/g,"").replace(/[\u0660-\u0669]/g,s=>String(s.charCodeAt(0)-p)).replace(/[\u06f0-\u06f9]/g,s=>String(s.charCodeAt(0)-h)).replace(/[^0-9.+-]/g,""),n=Number(t);return Number.isFinite(n)?n:0}function l(e){try{const t=f(e);return new Intl.NumberFormat("en-US",{maximumFractionDigits:0,useGrouping:!0}).format(t)}catch{return String(e??0)}}function i(e,t){if(!e)return;const n=document.getElementById(e);n&&(n.textContent=l(t))}function o(){c=!1;const e=d(),t=Array.isArray(e.projects)?e.projects.length:0,n=Array.isArray(e.reservations)?e.reservations.length:0,s=Array.isArray(e.equipment)?e.equipment.length:0,m=Array.isArray(e.technicians)?e.technicians.length:0;a.projects.forEach(r=>i(r,t)),a.reservations.forEach(r=>i(r,n)),a.equipment.forEach(r=>i(r,s)),a.technicians.forEach(r=>i(r,m))}function u(){c||(c=!0,typeof requestAnimationFrame=="function"?requestAnimationFrame(o):setTimeout(o,16))}function A(){["reservations:changed","projects:changed","equipment:changed","technicians:changed","customers:changed","maintenance:updated","language:changed"].forEach(t=>{document.addEventListener(t,u,{passive:!0})}),u()}export{A as initDashboardMetrics};
