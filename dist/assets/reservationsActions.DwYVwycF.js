import{w as p,x as w,j as n,t as o}from"./auth.nraNoQb5.js";import{s as y,r as h}from"./equipment.Bc_ULOIF.js";import{s as g}from"./state.QEOaSBGz.js";import{g as f,h as F,w as l,a as R,J as A,r as S}from"./reservationsService.BDW4iqny.js";function v(){const r=()=>{y(),h(),g()};if(typeof window<"u"){if(typeof window.requestIdleCallback=="function"){window.requestIdleCallback(r,{timeout:200});return}if(typeof window.requestAnimationFrame=="function"){window.requestAnimationFrame(r);return}}r()}let u=!1,d=null;function I(r){if(!r||typeof r!="object")return"";const a=Object.entries(r).filter(([s,e])=>e!=null).map(([s,e])=>[s,String(e)]);return a.length===0?"":JSON.stringify(a.sort(([s],[e])=>s.localeCompare(e)))}async function k(r={}){const{suppressError:a=!0,params:s=null,force:e=!1}=r??{},i=I(s);if(!e&&u&&f().length>0&&i===d)return f();try{const t=await S(s||{});return u=!0,d=i,t}catch(t){if(console.error("âŒ [reservationsActions] Failed to load reservations from API",t),!a)throw t;return f()}}async function C(r,{onAfterChange:a}={}){if(!p())return w(),!1;const e=f()[r];if(!e)return n(o("reservations.toast.notFound","âš ï¸ ØªØ¹Ø°Ø± Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø¬Ø²")),!1;const i=e.id||e.reservationId;if(!i)return n(o("reservations.toast.notFound","âš ï¸ ØªØ¹Ø°Ø± Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø¬Ø²")),!1;try{return await F(i),v(),a?.({type:"deleted",reservation:e}),n(o("reservations.toast.deleted","ğŸ—‘ï¸ ØªÙ… Ø­Ø°Ù Ø§Ù„Ø­Ø¬Ø²")),!0}catch(t){console.error("âŒ [reservationsActions] deleteReservation failed",t);const c=l(t)?t.message:o("reservations.toast.deleteFailed","ØªØ¹Ø°Ø± Ø­Ø°Ù Ø§Ù„Ø­Ø¬Ø²ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰");return n(c,"error"),!1}}async function E(r,{onAfterChange:a}={}){const e=f()[r];if(!e)return n(o("reservations.toast.notFound","âš ï¸ ØªØ¹Ø°Ø± Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø¬Ø²")),!1;const i=e.id||e.reservationId;if(!i)return n(o("reservations.toast.notFound","âš ï¸ ØªØ¹Ø°Ø± Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø¬Ø²")),!1;const{projectLinked:t}=R(e);if(t)return n(o("reservations.toast.confirmBlockedByProject","âš ï¸ Ø­Ø§Ù„Ø© Ù‡Ø°Ø§ Ø§Ù„Ø­Ø¬Ø² ØªØªØ­ÙƒÙ… Ø¨Ù‡Ø§ Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø§Ù„Ù…Ø±ØªØ¨Ø· ÙˆÙ„Ø§ ÙŠÙ…ÙƒÙ† ØªØ£ÙƒÙŠØ¯Ù‡ Ù…Ù† Ù‡Ù†Ø§"),"info"),!1;try{const c=await A(i);return v(),a?.({type:"confirmed",reservation:c}),n(o("reservations.toast.confirmed","âœ… ØªÙ… ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø²")),!0}catch(c){console.error("âŒ [reservationsActions] confirmReservation failed",c);const m=l(c)?c.message:o("reservations.toast.confirmFailed","ØªØ¹Ø°Ø± ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø¬Ø²ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰");return n(m,"error"),!1}}export{E as c,C as d,k as e};
