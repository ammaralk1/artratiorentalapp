const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./app.aHUClWLb.js","./app.CmldlhWc.css"])))=>i.map(i=>d[i]);
import"./modulepreload-polyfill.B5Qt9EMX.js";/* empty css              */import{a as p,c as v,i as b,s as E,b as g,r as w,d as y,e as I,u as _,l as T,_ as s,f as L,g as P,w as R}from"./app.aHUClWLb.js";p();let i=null,c=null,l=null;function x(){return l||(l=s(()=>import("./app.aHUClWLb.js").then(e=>e.k),__vite__mapDeps([0,1]),import.meta.url).then(e=>{try{typeof e.initDashboardMetrics=="function"&&e.initDashboardMetrics()}catch(n){console.error("❌ Failed to initialise dashboard metrics",n)}return e}).catch(e=>{throw console.error("❌ Failed to load dashboard metrics module",e),l=null,e})),l}function D(){const e=()=>{x()};typeof window<"u"&&typeof window.requestIdleCallback=="function"?window.requestIdleCallback(()=>{e()},{timeout:1500}):setTimeout(e,0)}function S(){const e=async()=>{try{const n=[];n.push(s(()=>import("./app.aHUClWLb.js").then(t=>t.p),__vite__mapDeps([0,1]),import.meta.url).then(t=>t.refreshProjectsFromApi().catch(()=>{})).catch(()=>{})),n.push(s(()=>import("./app.aHUClWLb.js").then(t=>t.h),__vite__mapDeps([0,1]),import.meta.url).then(t=>t.refreshReservationsFromApi().catch(()=>{})).catch(()=>{})),n.push(s(()=>import("./app.aHUClWLb.js").then(t=>t.t),__vite__mapDeps([0,1]),import.meta.url).then(t=>t.refreshTechniciansFromApi().catch(()=>{})).catch(()=>{})),n.push(s(()=>import("./app.aHUClWLb.js").then(t=>t.m),__vite__mapDeps([0,1]),import.meta.url).then(t=>t.refreshMaintenanceFromApi().catch(()=>{})).catch(()=>{})),n.push(s(()=>import("./app.aHUClWLb.js").then(t=>t.j),__vite__mapDeps([0,1]),import.meta.url).then(t=>t.refreshEquipmentFromApi({showToastOnError:!1}).catch(()=>{})).catch(()=>{})),await Promise.allSettled(n)}catch{}};typeof window<"u"&&typeof window.requestIdleCallback=="function"?window.requestIdleCallback(()=>{e()},{timeout:2500}):setTimeout(e,500)}async function m(){if(!await v())return;b(),E(),g(),w(),y(),I(),D(),S();const n=document.getElementById("excel-upload");n&&n.addEventListener("change",async a=>{const o=a.target.files&&a.target.files[0];o&&(await _(o),a.target.value="")});const t=document.getElementById("excel-upload-trigger");t&&n&&t.addEventListener("click",a=>{a.preventDefault(),n.click()}),document.getElementById("logout-btn")?.addEventListener("click",T),k(),A()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{m().catch(e=>{console.error("❌ Failed to initialise app",e)})},{once:!0}):m().catch(e=>{console.error("❌ Failed to initialise app",e)});function k(){document.querySelectorAll('input[type="datetime-local"]').forEach(e=>{e.addEventListener("input",()=>{const n=e.value;if(!n.includes("T"))return;const[t,a]=n.split("T"),[o]=a.split(":"),u=`${o.padStart(2,"0")}:00`,d=`${t}T${u}`;e.value!==d&&(e.value=d,setTimeout(()=>e.blur(),150))})})}function A(){const e=new URLSearchParams(window.location.search),n=e.get("reservationEditId"),t=e.get("reservationEditIndex");if(!n&&!t)return;i={reservationId:n,reservationIndex:t!=null?Number(t):null},f(),e.delete("reservationEditId"),e.delete("reservationEditIndex");const a=e.toString(),o=`${window.location.pathname}${a?`?${a}`:""}${window.location.hash||""}`;window.history.replaceState({},document.title,o)}function F(e){const n=document.getElementById(e);return!!(n?.classList.contains("active")&&n?.style.display!=="none")}function q(e){return new Promise(n=>{if(F(e)){n();return}const t=o=>{o?.detail?.tabId===e&&(document.removeEventListener("dashboard:tabChanged",t),n())};document.addEventListener("dashboard:tabChanged",t),document.querySelector(`[data-tab="${e}"]`)?.click()})}function C(e){const n=document.querySelector(`#reservations-tab .sub-tab-button[data-sub-tab="${e}"]`),t=document.getElementById(e);return!!(n?.classList.contains("active")&&t?.classList.contains("active")&&t?.getAttribute("aria-hidden")==="false")}function B(e){return new Promise(n=>{if(C(e)){n();return}const t=o=>{o?.detail?.subTabId===e&&(document.removeEventListener("reservations:subTabChanged",t),n())};document.addEventListener("reservations:subTabChanged",t),document.querySelector(`#reservations-tab .sub-tab-button[data-sub-tab="${e}"]`)?.click()})}async function $(){const e=P("openReservationEditor");if(typeof e=="function")return e;const n=await R("openReservationEditor");if(typeof n=="function")return n;throw new Error("Reservation editor handler is unavailable")}async function f(){if(!i)return;if(c)return c;const e=(async()=>{const t=L().reservations||[];let a=null;if(i.reservationId){const r=t.findIndex(h=>String(h?.id)===i.reservationId||String(h?.reservationId)===i.reservationId);r!==-1&&(a=r)}if(a===null&&typeof i.reservationIndex=="number"&&!Number.isNaN(i.reservationIndex)&&i.reservationIndex>=0&&i.reservationIndex<t.length&&(a=i.reservationIndex),a===null)return;const o="my-reservations-tab",u="reservations-tab",d=i;i=null;try{await q(u),await B(o);const r=await $();typeof r=="function"?r(a):(console.warn("⚠️ Pending reservation edit skipped: editor is not available"),i=d)}catch(r){console.error("❌ Failed to open pending reservation editor",r),i=d}})();c=e;try{await e}finally{c=null}}document.addEventListener("reservations:changed",()=>{i&&f()});
