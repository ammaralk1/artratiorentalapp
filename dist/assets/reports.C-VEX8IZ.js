const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./pdfPages.BHLG7w6e.js","./calculations.Dk4RntRQ.js","./reservationsService.b7HnCOZO.js","./auth.BLFzWQsL.js","./auth.DwoC9zDp.css","./state.DZCwr8Fl.js","./quotePdf.kDBbUcue.js","./canvasColorUtils.CviLtv6S.js","./a4Unified.DNKAc6-H.js","./preview.hfWYnEn2.js"])))=>i.map(i=>d[i]);
import{_ as J}from"./uiBridge.BjhjXnQL.js";import{r as n,b as ve,d as Ie,t as c,f as ne,g as E,h as g,c as R,i as ce,j as Pe,p as be,k as pe,a as De,m as Re,n as Be,o as qe,q as Ne,s as Fe,u as He,v as _e,w as je,x as ze,y as Oe,z as Ue,A as Ge,B as Ve,C as We,D as Ye,E as Ke,F as Je,G as Qe,H as Xe,I as Ze,J as he}from"./calculations.Dk4RntRQ.js";import{d as et,b as j,A as tt,n as Z,p as nt}from"./auth.BLFzWQsL.js";import{K as at,m as rt}from"./reservationsService.b7HnCOZO.js";import{m as xe}from"./state.DZCwr8Fl.js";import{mapMaintenanceFromApi as ke}from"./maintenanceService.DVgMDRbu.js";import"./canvasColorUtils.CviLtv6S.js";function Se(e={}){return{id:e?.id!=null?String(e.id):"",customerName:e?.full_name??e?.customerName??e?.name??"",companyName:e?.company??e?.company_name??e?.companyName??"",phone:e?.phone??""}}function Ee(e={}){const t=String(e?.barcode??"").trim(),a=e?.description??e?.name??"";return{id:e?.id!=null?String(e.id):"",barcode:t,desc:a,description:a,name:e?.name??a,category:e?.category??"",subcategory:e?.subcategory??"",status:e?.status??"",price:Number.parseFloat(e?.unit_price??e?.price??0)||0}}function Ce(e={}){const t=e?.title??e?.name??"",a=e?.project_code??e?.projectCode??"",o=e?.status??"",s=e?.confirmed===!0;return{id:e?.id!=null?String(e.id):"",title:t,code:a,status:o,confirmed:s}}function st(){let e;try{e=et()}catch(v){return console.warn("âš ï¸ [reports] Failed to access cached data",v),!1}if(!e||typeof e!="object")return!1;const{reservations:t=[],customers:a=[],equipment:o=[],technicians:s=[],projects:r=[],maintenance:l=[]}=e;if(!(t.length||a.length||o.length||s.length||r.length))return!1;n.data.reservations=Array.isArray(t)?t.map(at):[],n.data.customers=Array.isArray(a)?a.map(Se):[],n.data.equipment=Array.isArray(o)?o.map(Ee):[],n.data.technicians=Array.isArray(s)?s.map(xe):[],n.data.projects=Array.isArray(r)?r.map(Ce):[],n.data.projectsMap=new Map(n.data.projects.map(v=>[v.id,v])),n.data.maintenance=Array.isArray(l)?l.map(ke):[],n.techniciansIndex=new Map((n.data.technicians||[]).map(v=>[String(v.id),v]));try{ve()}catch{}return!0}async function ae({silent:e=!1,force:t=!1,signature:a=null,autoRender:o=!1}={}){if(n.loading){a&&(n.pendingFetchSignature=a,n.pendingFetchForce=t||n.pendingFetchForce);return}const s=Date.now();if(!(!t&&a&&n.lastFetchSignature===a&&s-n.lastFetchAt<1200)){n.loading=!0,n.errorMessage="",e||n.callbacks.onBeforeRender?.();try{const{startDate:r,endDate:l}=Ie(n.filters||{}),d=b=>{if(!b)return null;const w=b.getFullYear(),A=String(b.getMonth()+1).padStart(2,"0"),q=String(b.getDate()).padStart(2,"0");return`${w}-${A}-${q}`},v=d(r),m=d(l),f=200;let h=0,u=[];const p=50;for(let b=0;b<p;b+=1){const w=new URLSearchParams;w.set("limit",String(f)),w.set("offset",String(h)),v&&w.set("start_date",v),m&&w.set("end_date",m);const A=n.filters||{};A?.status&&A.status!=="all"&&w.set("status",String(A.status)),A?.search&&w.set("search",String(A.search));const q=await j(`/reservations/?${w.toString()}`),D=Array.isArray(q?.data)?q.data:[];if(u=u.concat(D),D.length<f)break;h+=f}const[S,k,C,$,y]=await Promise.all([j("/customers/?limit=500"),j("/equipment/?limit=500"),j("/technicians/?limit=500"),j("/projects/?limit=500"),j("/maintenance/?limit=500")]);n.data.reservations=Array.isArray(u)?u.map(b=>rt(b)):[],n.data.customers=Array.isArray(S?.data)?S.data.map(Se):[],n.data.equipment=Array.isArray(k?.data)?k.data.map(Ee):[],n.data.technicians=Array.isArray(C?.data)?C.data.map(xe):[],n.data.projects=Array.isArray($?.data)?$.data.map(Ce):[],n.data.projectsMap=new Map(n.data.projects.map(b=>[b.id,b])),n.data.maintenance=Array.isArray(y?.data)?y.data.map(ke):[],n.techniciansIndex=new Map((n.data.technicians||[]).map(b=>[String(b.id),b]));try{ve()}catch{}n.lastFetchSignature=a||null,n.lastFetchAt=Date.now()}catch(r){console.error("âŒ [reports] Failed to load reports data",r),n.errorMessage=r instanceof tt?r.message:c("reservations.reports.error.fetchFailed","ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±ØŒ Ø­Ø§ÙˆÙ„ Ù„Ø§Ø­Ù‚Ø§Ù‹"),(!n.data.projectsMap||!(n.data.projectsMap instanceof Map))&&(n.data.projectsMap=new Map)}finally{if(n.loading=!1,n.pendingFetchSignature){const r=n.pendingFetchSignature,l=n.pendingFetchForce;n.pendingFetchSignature=null,n.pendingFetchForce=!1,setTimeout(()=>{ae({silent:!0,force:l,signature:r,autoRender:!0}).catch(d=>{console.error("âŒ [reports] Queued refresh failed",d)})},0)}(!e||o)&&n.callbacks.onAfterRender?.()}}}function _(){const e=document.documentElement;return e.classList.contains("dark")||e.dataset.theme==="dark"?"dark":"light"}function F(e,t){const a=document.getElementById(e);if(a){if(!t||t.length===0){a.innerHTML=`<div class="text-sm text-base-content/60">${c("reservations.reports.progress.empty","Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø¹Ø±Ø¶Ù‡Ø§.","No data to display.")}</div>`;return}a.innerHTML=t.map(o=>{const s=Math.min(Math.max(o.percent??0,0),100),r=c("reservations.reports.progress.meta","{count} Ø­Ø¬Ø²","{count} reservations").replace("{count}",E(o.rawCount??o.value??0)),l=o.className?`reports-progress-fill ${o.className}`:"reports-progress-fill";return`
        <div class="reports-progress-row">
          <div class="reports-progress-top">
            <span>${o.label}</span>
            <span class="reports-progress-value">${E(o.percent??0)}%</span>
          </div>
          <div class="reports-progress-bar">
            <div class="${l}" style="width: ${s}%;"></div>
          </div>
          <div class="reports-progress-meta">${r}</div>
        </div>
      `}).join("")}}function M(e,t){const a=document.querySelector(`[data-chart-loading="${e}"]`);a&&(a.style.display=t?"":"none")}async function ot(e){const t=document.getElementById("reports-volume-chart");if(!t)return;const a=Array.isArray(e)?e:[];if(n.lastTrendData=a,M("volume",!0),!a.length){n.charts.trend&&(n.charts.trend.destroy(),n.charts.trend=null),t.innerHTML=`<p class="text-base-content/60 text-sm">${c("reservations.reports.progress.empty","Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø¹Ø±Ø¶Ù‡Ø§.","No data to display.")}</p>`,M("volume",!1);return}try{const o=await ne();if(!o){t.innerHTML=`<p class="text-base-content/60 text-sm">${c("reservations.reports.progress.empty","Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø¹Ø±Ø¶Ù‡Ø§.","No data to display.")}</p>`,M("volume",!1);return}const s=a.map(y=>y.label),r=a.map(y=>Math.round(y.count||0)),l=a.map(y=>Number(y.revenue||0)),d=a.map(y=>Number(y.netProfit||0)),v=a.map(y=>y.movingAvgRevenue!=null?Number(y.movingAvgRevenue):null),m=r.reduce((y,b)=>y+(Number.isFinite(b)?b:0),0),f=l.reduce((y,b)=>y+(Number.isFinite(b)?b:0),0),h=d.reduce((y,b)=>y+(Number.isFinite(b)?b:0),0);if(m===0&&f===0&&h===0){n.charts.trend&&(n.charts.trend.destroy(),n.charts.trend=null),t.innerHTML=`<p class="text-base-content/60 text-sm">${c("reservations.reports.progress.empty","Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø¹Ø±Ø¶Ù‡Ø§.","No data to display.")}</p>`;return}const u=[{name:c("reservations.reports.chart.volume.series.reservations","Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª","Reservations"),type:"column",data:r},{name:c("reservations.reports.chart.volume.series.revenue","Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª (SR)","Revenue (SR)"),type:"line",data:l,yAxisIndex:1},{name:c("reservations.reports.chart.volume.series.net","ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­ (SR)","Net profit (SR)"),type:"line",data:d,yAxisIndex:1},{name:c("reservations.reports.chart.volume.series.movingAvg","Ù…ØªÙˆØ³Ø· Ù…ØªØ­Ø±Ùƒ (Ù£ Ø£Ø´Ù‡Ø±)","3-mo Moving Avg"),type:"line",data:v,yAxisIndex:1}],p={chart:{type:"line",height:320,stacked:!1,toolbar:{show:!1},background:"transparent",fontFamily:"Tajawal, sans-serif",animations:{enabled:!0},events:{dataPointSelection:(y,b,w)=>{if(w?.dataPointIndex!=null){const A=n.lastTrendData[w.dataPointIndex];n.callbacks.onTrendDrilldown?.(A,w.dataPointIndex)}}}},theme:{mode:_()},stroke:{width:[0,4,4],curve:"smooth"},markers:{size:[0,4,4,0]},colors:["#6366f1","#22c55e","#f97316","#0ea5e9"],dataLabels:{enabled:!1},fill:{type:"solid",opacity:1},stroke:{curve:"smooth",width:[0,2,2,2],dashArray:[0,0,0,6]},xaxis:{categories:s,labels:{style:{colors:_()==="dark"?"#cbd5f5":"#475569"}}},yaxis:[{seriesName:c("reservations.reports.chart.volume.series.reservations","Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª","Reservations"),axisTicks:{show:!0},axisBorder:{show:!0,color:"#6366f1"},labels:{style:{colors:"#6366f1"},formatter:y=>E(y)},title:{text:c("reservations.reports.chart.volume.series.reservations","Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª","Reservations"),style:{color:"#6366f1"}}},{opposite:!0,seriesName:c("reservations.reports.chart.volume.series.revenue","Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª (SR)","Revenue (SR)"),axisTicks:{show:!0},axisBorder:{show:!0,color:"#22c55e"},labels:{style:{colors:"#22c55e"},formatter:y=>g(y)},title:{text:c("reservations.reports.chart.volume.series.revenue","Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª (SR)","Revenue (SR)"),style:{color:"#22c55e"}}}],legend:{position:"bottom"},tooltip:{shared:!0,intersect:!1,custom:({series:y,dataPointIndex:b,w})=>{const A=n.lastTrendData?.[b]||{},q=s?.[b]||"",D=[],G=y?.[0]?.[b];G!=null&&D.push(`<div><span>ğŸ“¦</span> ${E(G)}</div>`);const V=y?.[1]?.[b];if(V!=null){const Y=Number.isFinite(A.yoyChange)?`${A.yoyChange>=0?"+":""}${E(Math.round(A.yoyChange))}% YoY`:"",re=Number.isFinite(A.momChange)?`${A.momChange>=0?"+":""}${E(Math.round(A.momChange))}% MoM`:"",ee=[Y,re].filter(Boolean).join(" Â· ");D.push(`<div><span>ğŸ’°</span> ${g(V)}${ee?` <small class="text-base-content/60">(${ee})</small>`:""}</div>`)}const W=y?.[2]?.[b];W!=null&&D.push(`<div><span>ğŸ§®</span> ${g(W)}</div>`);const H=y?.[3]?.[b];return H!=null&&D.push(`<div><span>ğŸ“ˆ</span> ${g(H)}</div>`),`
            <div class="apex-tooltip">
              <div class="mb-1 font-semibold">${q}</div>
              ${D.join("")}
            </div>
          `}}},S=_(),k=String(s.join("|")),C=n.chartsMeta.trend,$=n.charts.trend&&C.theme===S&&C.categoriesSig===k;n.charts.trend&&$?n.charts.trend.updateSeries(u,!0):n.charts.trend?(n.charts.trend.updateOptions({...p},!0,!0),n.charts.trend.updateSeries(u,!0)):(t.innerHTML="",n.charts.trend=new o(t,{...p,series:u}),n.charts.trend.render()),n.chartsMeta.trend={categoriesSig:k,theme:S},M("volume",!1)}catch(o){console.error("âš ï¸ [reports] Failed to render trend chart",o),t.innerHTML=`<p class="text-base-content/60 text-sm">${c("reservations.reports.progress.empty","Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø¹Ø±Ø¶Ù‡Ø§.","No data to display.")}</p>`,M("volume",!1)}}async function it(e){const t=document.getElementById("reports-status-chart"),a="reports-status-breakdown";if(!t)return;const o=Array.isArray(e)?e:[];n.lastStatusData=o,M("status",!0);const s=o.map(l=>Math.max(0,l.value||0)),r=s.reduce((l,d)=>l+d,0);if(!o.length||r===0){n.charts.status&&(n.charts.status.destroy(),n.charts.status=null),F(a,[]),t.innerHTML=`<p class="text-base-content/60 text-sm">${c("reservations.reports.progress.empty","Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø¹Ø±Ø¶Ù‡Ø§.","No data to display.")}</p>`,M("status",!1);return}try{const l=await ne();if(!l){F(a,[]),t.innerHTML=`<p class="text-base-content/60 text-sm">${c("reservations.reports.progress.empty","Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø¹Ø±Ø¶Ù‡Ø§.","No data to display.")}</p>`,M("status",!1);return}const d=o.map(p=>p.label),v={chart:{type:"donut",height:300,fontFamily:"Tajawal, sans-serif",toolbar:{show:!1},background:"transparent",events:{dataPointSelection:(p,S,k)=>{if(k?.dataPointIndex!=null){const C=n.lastStatusData[k.dataPointIndex];C?.filterKey&&n.callbacks.onStatusDrilldown?.(C,k.dataPointIndex)}}}},theme:{mode:_()},labels:d,series:s,colors:["#22c55e","#f97316","#6366f1","#ef4444"],legend:{position:"bottom"},dataLabels:{formatter:p=>`${Math.round(p)}%`},plotOptions:{pie:{donut:{size:"68%",labels:{show:!0,total:{show:!0,label:c("reservations.reports.chart.status.title","ğŸ§¾ ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª","Status distribution"),formatter:()=>E(s.reduce((p,S)=>p+S,0))}}}}},tooltip:{y:{formatter:(p,S)=>{const k=n.lastStatusData?.[S?.seriesIndex||0],C=k?`${E(k.percent)}%`:`${E(p)}%`;return`${k?E(k.rawCount??k.value??0):E(p)} / ${C}`}}}},m=_(),f=String(d.join("|")),h=n.chartsMeta.status,u=n.charts.status&&h.theme===m&&h.labelsSig===f;n.charts.status&&u?n.charts.status.updateSeries(s,!0):n.charts.status?(n.charts.status.updateOptions({...v},!0,!0),n.charts.status.updateSeries(s,!0)):(t.innerHTML="",n.charts.status=new l(t,{...v,series:s}),n.charts.status.render()),F(a,o),n.chartsMeta.status={labelsSig:f,theme:m},M("status",!1)}catch(l){console.error("âš ï¸ [reports] Failed to render status chart",l),F(a,[]),t.innerHTML=`<p class="text-base-content/60 text-sm">${c("reservations.reports.progress.empty","Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø¹Ø±Ø¶Ù‡Ø§.","No data to display.")}</p>`,M("status",!1)}}async function ct(e){const t=document.getElementById("reports-payment-chart"),a="reports-payment-breakdown";if(!t)return;const o=Array.isArray(e)?e:[];n.lastPaymentData=o,M("payment",!0);const s=o.map(l=>Math.max(0,l.value||0)),r=s.reduce((l,d)=>l+d,0);if(!o.length||r===0){n.charts.payment&&(n.charts.payment.destroy(),n.charts.payment=null),F(a,[]),t.innerHTML=`<p class="text-base-content/60 text-sm">${c("reservations.reports.progress.empty","Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø¹Ø±Ø¶Ù‡Ø§.","No data to display.")}</p>`,M("payment",!1);return}try{const l=await ne();if(!l){F(a,[]),t.innerHTML=`<p class="text-base-content/60 text-sm">${c("reservations.reports.progress.empty","Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø¹Ø±Ø¶Ù‡Ø§.","No data to display.")}</p>`,M("payment",!1);return}const d=o.map(p=>p.label),v={chart:{type:"pie",height:300,fontFamily:"Tajawal, sans-serif",toolbar:{show:!1},background:"transparent",events:{dataPointSelection:(p,S,k)=>{if(k?.dataPointIndex!=null){const C=n.lastPaymentData[k.dataPointIndex];C?.filterKey&&n.callbacks.onPaymentDrilldown?.(C,k.dataPointIndex)}}}},theme:{mode:_()},labels:d,series:s,colors:["#00ac69","#f59e0b","#f43f5e"],legend:{position:"bottom"},dataLabels:{formatter:p=>`${Math.round(p)}%`},tooltip:{y:{formatter:(p,S)=>{const k=n.lastPaymentData?.[S?.seriesIndex||0],C=k?`${E(k.percent)}%`:`${E(p)}%`;return`${k?E(k.rawCount??k.value??0):E(p)} / ${C}`}}}},m=_(),f=String(d.join("|")),h=n.chartsMeta.payment,u=n.charts.payment&&h.theme===m&&h.labelsSig===f;n.charts.payment&&u?n.charts.payment.updateSeries(s,!0):n.charts.payment?(n.charts.payment.updateOptions({...v},!0,!0),n.charts.payment.updateSeries(s,!0)):(t.innerHTML="",n.charts.payment=new l(t,{...v,series:s}),n.charts.payment.render()),F(a,o),n.chartsMeta.payment={labelsSig:f,theme:m},M("payment",!1)}catch(l){console.error("âš ï¸ [reports] Failed to render payment chart",l),F(a,[]),t.innerHTML=`<p class="text-base-content/60 text-sm">${c("reservations.reports.progress.empty","Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø¹Ø±Ø¶Ù‡Ø§.","No data to display.")}</p>`,M("payment",!1)}}async function lt(e){const t=document.getElementById("reports-status-stacked-chart");if(!t)return;const a=Array.isArray(e)?e:[];if(!a.length){t.innerHTML=`<p class="text-base-content/60 text-sm">${c("reservations.reports.progress.empty","Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø¹Ø±Ø¶Ù‡Ø§.","No data to display.")}</p>`;return}try{const o=await ne(),s=a.map(f=>f.label),r=a.map(f=>f.confirmed||0),l=a.map(f=>f.cancelled||0),d=[{name:c("reservations.reports.status.confirmedLabel","Ù…Ø¤ÙƒØ¯Ø©","Confirmed"),data:r},{name:c("reservations.reports.status.cancelledLabel","Ù…Ù„ØºØ§Ø©","Cancelled"),data:l}],v={chart:{type:"bar",height:320,stacked:!0,toolbar:{show:!1}},series:d,xaxis:{categories:s},plotOptions:{bar:{columnWidth:"55%",borderRadius:6}},colors:["#22c55e","#ef4444"],dataLabels:{enabled:!1},legend:{position:"bottom"}};t.innerHTML="",new o(t,v).render()}catch(o){console.error("[reports] failed to render stacked status chart",o)}}function dt(e){const t=document.getElementById("reports-kpi-total"),a=document.getElementById("reports-kpi-total-meta"),o=document.getElementById("reports-kpi-revenue"),s=document.getElementById("reports-kpi-revenue-meta"),r=document.getElementById("reservations-revenue-breakdown"),l=document.getElementById("reports-kpi-outstanding"),d=document.getElementById("reports-kpi-outstanding-meta"),v=document.getElementById("reports-kpi-crew-cost"),m=document.getElementById("reports-kpi-crew-cost-meta"),f=document.getElementById("reports-kpi-equipment-cost"),h=document.getElementById("reports-kpi-equipment-cost-meta"),u=document.getElementById("reports-kpi-margin"),p=document.getElementById("reports-kpi-margin-meta"),S=document.getElementById("reports-kpi-net"),k=document.getElementById("reports-kpi-net-meta"),C=e.total||0,$=e.cancelled||0;e.activeTotal!=null?e.activeTotal:Math.max(0,C-$);const y=e.revenue||0;e.confirmed;const b=e.paidCount||0,w=e.unpaidCount||Math.max(0,(e.activeTotal||0)-b);e.average;const A=e.companyShareTotal||0,q=e.taxTotal||0,D=e.crewTotal||0,G=e.crewCostTotal||0,V=e.equipmentTotal||0,W=e.equipmentCostTotal||0,H=e.netProfit||0,Y=e.maintenanceExpense||0,re=y>0?Math.round(H/y*100):0,ee=e.outstandingTotal||0;if(t&&(t.textContent=E(C)),a){const T=c("reservations.reports.kpi.total.dynamicMeta","Ù…Ù†Ù‡Ø§ {count} Ù…ØºÙ„Ù‚Ø©","Includes {count} closed").replace("{count}",E(e.completed||0)),K=$>0?" "+c("reservations.reports.kpi.total.cancelledPart","â€¢ {count} Ù…Ù„ØºØ§Ø©","â€¢ {count} cancelled").replace("{count}",E($)):"";a.textContent=T+K}if(o&&(o.textContent=g(y)),s)if(C===0)s.textContent=c("reservations.reports.progress.empty","Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø¹Ø±Ø¶Ù‡Ø§.","No data to display.");else{const K=c("reservations.reports.kpi.revenue.metaLite","Ù†Ø³Ø¨Ø© Ø§Ù„Ø´Ø±ÙƒØ© {share}","Company share {share}").replace("{share}",g(A));s.textContent=K}if(r)if(y>0){const T=[{label:c("reservations.reports.kpi.revenue.details.gross","Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯ Ø§Ù„ÙƒÙ„ÙŠ","Gross revenue"),value:g(y),hint:c("reservations.reports.kpi.revenue.details.grossHint","Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù‚ÙŠÙ…Ø© Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª (Ù‚Ø¨Ù„ Ø§Ù„Ø®ØµÙˆÙ…Ø§Øª)","Total bookings value (before discounts)")},{label:c("reservations.reports.kpi.revenue.details.share","Ù†Ø³Ø¨Ø© Ø§Ù„Ø´Ø±ÙƒØ©","Company share"),value:g(A),hint:c("reservations.reports.kpi.revenue.details.shareHint","ØªÙØ­Ø³Ø¨ Ø¨Ø¹Ø¯ Ø§Ù„Ø®ØµÙ…ØŒ ÙˆØªÙØ¶Ø§Ù Ù„Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ","Applied after discount and added to total")},{label:c("reservations.reports.kpi.revenue.details.tax","Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©","Tax"),value:g(q),hint:c("reservations.reports.kpi.revenue.details.taxHint","Ø¶Ø±ÙŠØ¨Ø© 15% Ø¹Ù„Ù‰ (Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø¨Ø¹Ø¯ Ø§Ù„Ø®ØµÙ… + Ù†Ø³Ø¨Ø© Ø§Ù„Ø´Ø±ÙƒØ©)","15% VAT on (after-discount total + company share)")},{label:c("reservations.reports.kpi.revenue.details.crewGross","Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ø§Ù‚Ù…","Crew total"),value:g(D),hint:c("reservations.reports.kpi.revenue.details.crewGrossHint","Ù‚ÙŠÙ…Ø© Ø§Ù„Ø·Ø§Ù‚Ù… Ù„Ù„Ø¹Ù…ÙŠÙ„","Crew price billed to client")},{label:c("reservations.reports.kpi.revenue.details.crew","ØªÙƒÙ„ÙØ© Ø§Ù„Ø·Ø§Ù‚Ù…","Crew cost"),value:g(G),hint:c("reservations.reports.kpi.revenue.details.crewHint","ØªÙƒÙ„ÙØ© Ø§Ù„Ø·Ø§Ù‚Ù… Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙƒØ©","Crew cost to company")},{label:c("reservations.reports.kpi.revenue.details.equipmentGross","Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¹Ø¯Ø§Øª","Equipment total"),value:g(V),hint:c("reservations.reports.kpi.revenue.details.equipmentGrossHint","Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¹Ø¯Ø§Øª Ù„Ù„Ø¹Ù…ÙŠÙ„","Equipment price billed to client")},{label:c("reservations.reports.kpi.revenue.details.equipment","ØªÙƒÙ„ÙØ© Ø§Ù„Ù…Ø¹Ø¯Ø§Øª","Equipment cost"),value:g(W),hint:c("reservations.reports.kpi.revenue.details.equipmentHint","ØªÙƒÙ„ÙØ© Ø§Ù„Ù…Ø¹Ø¯Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙƒØ©","Equipment cost to company")}];Y>0&&T.push({label:c("reservations.reports.kpi.revenue.details.maintenance","Ù…ØµØ§Ø±ÙŠÙ Ø§Ù„ØµÙŠØ§Ù†Ø©","Maintenance expenses"),value:`âˆ’${g(Y)}`}),T.push({label:c("reservations.reports.kpi.revenue.details.net","ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­","Net profit"),value:g(H)}),r.innerHTML=T.map(({label:K,value:Te,hint:Me})=>`
          <div class="reports-kpi-detail-row" title="${Me||""}">
            <span class="reports-kpi-detail-label">${K}</span>
            <span class="reports-kpi-detail-value">${Te}</span>
          </div>
        `).join(""),r.classList.remove("hidden")}else r.innerHTML="",r.classList.add("hidden");if(l&&(l.textContent=g(ee)),d){const T=c("reservations.reports.kpi.outstanding.meta","{count} Ø­Ø¬Ø² ØºÙŠØ± Ù…Ø¯ÙÙˆØ¹/Ø¬Ø²Ø¦ÙŠØ§Ù‹","{count} unpaid/partial reservations").replace("{count}",E(w));d.textContent=T}if(v&&(v.textContent=g(G)),m){const T=c("reservations.reports.kpi.crewCost.meta","Ø§Ù„Ù…ÙÙˆØªØ±Ø© {billable}","Billed {billable}").replace("{billable}",g(D));m.textContent=T}if(f&&(f.textContent=g(W)),h){const T=c("reservations.reports.kpi.equipmentCost.meta","Ø§Ù„Ù…ÙÙˆØªØ±Ø© {billable}","Billed {billable}").replace("{billable}",g(V));h.textContent=T}if(u&&(u.textContent=`${re}%`),p){const T=c("reservations.reports.kpi.margin.meta","ØµØ§ÙÙŠ {net} / Ø¥ÙŠØ±Ø§Ø¯Ø§Øª {rev}","Net {net} / Revenue {rev}").replace("{net}",g(H)).replace("{rev}",g(y));p.textContent=T}if(S&&(S.textContent=g(H)),k){const T=c("reservations.reports.kpi.net.meta","Ø¨Ø¹Ø¯ Ø§Ù„ØµÙŠØ§Ù†Ø© âˆ’ {maint}","After maintenance âˆ’ {maint}").replace("{maint}",g(Y));k.textContent=T}}function L(e=""){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function U(e=""){return String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function ut(e,t,a){const o=document.getElementById("reports-reservations-body");if(!o)return[];if(!e||e.length===0)return o.innerHTML=`<tr><td colspan="8" class="text-base-content/60">${c("reservations.reports.table.emptyPeriod","Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„ÙØªØ±Ø©.","No data for this period.")}</td></tr>`,[];const s=new Map((t||[]).map(u=>[String(u.id),u]));new Map((a||[]).map(u=>[String(u.id),u]));const r={code:c("reservations.reports.results.headers.id","Ø§Ù„Ø­Ø¬Ø²","Reservation"),customer:c("reservations.reports.results.headers.customer","Ø§Ù„Ø¹Ù…ÙŠÙ„","Customer"),company:c("reservations.reports.results.headers.company","Ø§Ù„Ø´Ø±ÙƒØ©","Company"),phone:c("reservations.reports.results.headers.phone","Ø§Ù„Ù‡Ø§ØªÙ","Phone"),date:c("reservations.reports.results.headers.date","Ø§Ù„ØªØ§Ø±ÙŠØ®","Date"),status:c("reservations.reports.results.headers.status","Ø§Ù„Ø­Ø§Ù„Ø©","Status"),payment:c("reservations.reports.results.headers.payment","Ø§Ù„Ø¯ÙØ¹","Payment"),paymentsCount:c("reservations.reports.results.headers.paymentsCount","Ø¹Ø¯Ø¯ Ø§Ù„Ø¯ÙØ¹Ø§Øª","Payments count"),days:c("reservations.reports.results.headers.days","Ø§Ù„Ø£ÙŠØ§Ù…","Days"),equipment:c("reservations.reports.results.headers.equipment","Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¹Ø¯Ø§Øª","Equipment"),crewGross:c("reservations.reports.results.headers.crewGross","Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ø§Ù‚Ù…","Crew total"),crewCost:c("reservations.reports.results.headers.crewCost","ØªÙƒÙ„ÙØ© Ø§Ù„Ø·Ø§Ù‚Ù…","Crew cost"),equipmentCost:c("reservations.reports.results.headers.equipmentCost","ØªÙƒÙ„ÙØ© Ø§Ù„Ù…Ø¹Ø¯Ø§Øª","Equipment cost"),discount:c("reservations.reports.results.headers.discount","Ø§Ù„Ø®ØµÙ…","Discount"),tax:c("reservations.reports.results.headers.tax","Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©","Tax"),total:c("reservations.reports.results.headers.total","Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ","Total"),share:c("reservations.reports.results.headers.share","Ù†Ø³Ø¨Ø© Ø§Ù„Ø´Ø±ÙƒØ©","Company share"),sharePercent:c("reservations.reports.results.headers.sharePercent","Ù†Ø³Ø¨Ø© Ø§Ù„Ø´Ø±ÙƒØ© %","Company share %"),shareAmount:c("reservations.reports.results.headers.shareAmount","Ù…Ø¨Ù„Øº Ù†Ø³Ø¨Ø© Ø§Ù„Ø´Ø±ÙƒØ©","Company share amount"),net:c("reservations.reports.results.headers.net","ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­","Net profit")},l=mt([...e]),{page:d,pageSize:v}=n.pagination,m=Math.max(0,(d-1)*v),h=l.slice(m,m+v).map(u=>{const p=yt(u,s),S=s.get(String(u?.customerId)),C=(Array.isArray(u.paymentHistory)?u.paymentHistory:Array.isArray(u.payment_history)?u.payment_history:[]).length,$=R(u),y={[r.code]:p.code.text,[r.customer]:p.customer.text,[r.company]:S?.companyName||"",[r.phone]:S?.phone||"",[r.date]:p.date.text,[r.status]:p.status.text,[r.payment]:p.payment.text,[r.paymentsCount]:String(C),[r.days]:String($.rentalDays??0),[r.equipment]:g($.equipmentTotal),[r.crewGross]:g($.crewTotal),[r.crewCost]:g($.crewCostTotal??0),[r.equipmentCost]:g($.equipmentCostTotal??0),[r.discount]:g($.discountAmount??0),[r.tax]:g($.taxAmount??0),[r.total]:p.total.text,[r.share]:p.share.text,[r.sharePercent]:`${E($.companySharePercent??0)}%`,[r.shareAmount]:g($.companyShareAmount??0),[r.net]:p.net.text},b=c("common.placeholder.empty","â€”","â€”");return Object.keys(y).forEach(w=>{String(y[w]??"").trim()===""&&(y[w]=b)}),{formatted:p,exportRow:y}});return o.innerHTML=h.map(({formatted:u})=>`
      <tr data-drilldown="reservation" data-search="${U(u.code.text)}">
        <td data-report-column="code">${u.code.html}</td>
        <td data-report-column="customer">${u.customer.html}</td>
        <td data-report-column="date">${u.date.html}</td>
        <td data-report-column="status">${u.status.html}</td>
        <td data-report-column="payment">${u.payment.html}</td>
        <td data-report-column="total">${u.total.html}</td>
        <td data-report-column="share">${u.share.html}</td>
        <td data-report-column="equipmentCost">${u.equipmentCost.html}</td>
        <td data-report-column="net">${u.net.html}</td>
      </tr>
    `).join(""),ft(l.length),pt(),h.map(({exportRow:u})=>u)}function pt(){const e=document.querySelector("#reports-reservations-table thead");e&&e.querySelectorAll("th.sortable").forEach(t=>{t.dataset.sortBound!=="true"&&(t.addEventListener("click",()=>{const a=t.dataset.sortKey;a&&(n.sort.key===a?n.sort.dir=n.sort.dir==="asc"?"desc":"asc":(n.sort.key=a,n.sort.dir="asc"),n.pagination.page=1,n.callbacks.onRender?.())}),t.dataset.sortBound="true")})}function mt(e){const{key:t,dir:a}=n.sort||{key:"date",dir:"desc"},o=a==="asc"?1:-1;return e.sort((s,r)=>o*ht(s,r,t))}function ht(e,t,a){switch(a){case"code":return String(e?.reservationId??e?.id??"").localeCompare(String(t?.reservationId??t?.id??""),"ar",{numeric:!0});case"customer":return String(e?.customerName??e?.customerId??"").localeCompare(String(t?.customerName??t?.customerId??""),"ar",{numeric:!0});case"date":return new Date(e?.start||0)-new Date(t?.start||0);case"status":{const o=ce(e)?.statusValue||"",s=ce(t)?.statusValue||"";return String(o).localeCompare(String(s),"ar")}case"total":{const o=R(e)?.finalTotal||0,s=R(t)?.finalTotal||0;return o-s}case"share":{const o=R(e)?.companyShareAmount||0,s=R(t)?.companyShareAmount||0;return o-s}case"equipmentCost":{const o=R(e)?.equipmentCostTotal||0,s=R(t)?.equipmentCostTotal||0;return o-s}case"net":{const o=R(e)?.netProfit||0,s=R(t)?.netProfit||0;return o-s}default:return new Date(e?.start||0)-new Date(t?.start||0)}}function ft(e){const t=document.getElementById("reports-table-pagination");if(!t)return;const{page:a,pageSize:o}=n.pagination,s=Math.max(1,Math.ceil(e/o)),r=a<=1?"disabled":"",l=a>=s?"disabled":"",d=e===0?0:(a-1)*o+1,v=Math.min(a*o,e);if(e<=o){t.innerHTML=`<div class="page-info">${E(d)}â€“${E(v)} / ${E(e)}</div>`;return}t.innerHTML=`
    <div class="pager">
      <button type="button" ${r} data-page="prev">â—€</button>
      <button type="button" ${l} data-page="next">â–¶</button>
    </div>
    <div class="page-info">${E(d)}â€“${E(v)} / ${E(e)}</div>
    <div class="pager page-size">
      <label>${c("reservations.reports.pageSize","Ù„ÙƒÙ„ ØµÙØ­Ø©","Per page")}</label>
      <button type="button" data-size="25">25</button>
      <button type="button" data-size="50">50</button>
      <button type="button" data-size="100">100</button>
    </div>
  `,t.querySelector('[data-page="prev"]')?.addEventListener("click",()=>{n.pagination.page>1&&(n.pagination.page-=1,n.callbacks.onRender?.())}),t.querySelector('[data-page="next"]')?.addEventListener("click",()=>{const m=Math.max(1,Math.ceil(e/n.pagination.pageSize));n.pagination.page<m&&(n.pagination.page+=1,n.callbacks.onRender?.())}),t.querySelectorAll("[data-size]")?.forEach(m=>{m.addEventListener("click",()=>{const f=Number(m.dataset.size);Number.isFinite(f)&&f>0&&(n.pagination.pageSize=f,n.pagination.page=1,n.callbacks.onRender?.())})})}function yt(e,t,a){const o=e?.reservationId||e?.id||c("common.placeholder.empty","â€”","â€”"),s=Z(String(o)),l=t.get(String(e?.customerId))?.customerName||c("reservations.reports.topCustomers.unknown","Ø¹Ù…ÙŠÙ„ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ","Unknown customer"),d=ce(e),v=gt(d.statusValue),m=vt(d.statusValue,v),f=Array.isArray(e.paymentHistory)?e.paymentHistory:Array.isArray(e.payment_history)?e.payment_history:[],h=bt(d.paidStatus,f),u=f.length;let p=h.html;if(u>0){const A=c("reservations.paymentHistory.countLabel","{count} Ø¯ÙØ¹Ø©","{count} payments").replace("{count}",E(u));p=`<div class="reports-payment-cell">${h.html}<small class="reports-payment-subtext">${L(A)}</small></div>`}const S=Pe(e?.start),k=R(e),C=g(k.finalTotal),$=k.companySharePercent>0?`${E(k.companySharePercent)}% (${g(k.companyShareAmount)})`:c("reservations.reports.results.share.none","Ø¨Ø¯ÙˆÙ† Ù†Ø³Ø¨Ø© Ø§Ù„Ø´Ø±ÙƒØ©","No company share"),y=g(k.netProfit),b=g(k.equipmentCostTotal??0),w=L(l);return{code:{html:L(s),text:s},customer:{html:w,text:l},date:{html:L(S),text:S},status:m,payment:{html:p,text:h.text},total:{html:L(C),text:C},share:{html:L($),text:$},net:{html:L(y),text:y},equipmentCost:{html:L(b),text:b}}}function gt(e){switch(e){case"completed":return Q(c("reservations.list.status.completed","ğŸ“ Ù…ØºÙ„Ù‚","Closed"));case"confirmed":return Q(c("reservations.list.status.confirmed","âœ… Ù…Ø¤ÙƒØ¯","Confirmed"));case"pending":return Q(c("reservations.list.status.pending","â³ ØºÙŠØ± Ù…Ø¤ÙƒØ¯","Pending"));case"cancelled":return Q(c("reservations.list.status.cancelled","âŒ Ù…Ù„ØºÙŠ","Cancelled"));default:return Z(e||c("common.placeholder.empty","â€”","â€”"))}}function vt(e,t){const a=Q(t);return{html:`<span class="reservation-chip status-${["completed","confirmed","pending","cancelled"].includes(e)?e:"info"}">${L(a)}</span>`,text:a}}function bt(e,t=[]){const a=be(e),o=String(e??"").toLowerCase(),s=o==="paid"?"paid":o==="partial"?"partial":"unpaid";let r="";const l=c("reservations.create.summary.currency","Ø±ÙŠØ§Ù„","SR");Array.isArray(t)&&t.length&&(r=t.map(m=>{const f=m?.recordedAt?pe(m.recordedAt):c("common.placeholder.empty","â€”","â€”"),h=Number.isFinite(Number(m?.amount))&&Number(m.amount)>0?`${Z(Number(m.amount).toFixed(2))} ${l}`:"",u=Number.isFinite(Number(m?.percentage))&&Number(m.percentage)>0?`${Z(Number(m.percentage).toFixed(2))}%`:"",p=[f];return h&&p.push(h),u&&p.push(u),p.filter(Boolean).join(" â€¢ ")}).join(`
`));const d=r?` title="${U(r)}"`:"";return{html:`<span class="reservation-chip status-${s}"${d}>${L(a)}</span>`,text:a}}function Q(e){return Z(String(e??"")).replace(/^[^A-Za-z0-9\u0600-\u06FF]+/,"").trim()||c("common.placeholder.empty","â€”","â€”")}function $e(e){const t=pe(new Date).replace(/-/g,"");return`${c("reservations.reports.export.filePrefix","ØªÙ‚Ø±ÙŠØ±-Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª","reservations-report")}-${t}.${e}`}function xt(e,t,a){const o=new Blob([e],{type:a}),s=URL.createObjectURL(o),r=document.createElement("a");r.href=s,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),setTimeout(()=>URL.revokeObjectURL(s),4e3)}function le(e){if(!e||!e.length)return;const t=Object.keys(e[0]),a=[t.join(",")];e.forEach(s=>{const r=t.map(l=>`"${String(s[l]??"").replace(/"/g,'""')}"`);a.push(r.join(","))});const o=`\uFEFF${a.join(`\r
`)}\r
`;xt(o,$e("csv"),"text/csv;charset=utf-8;")}async function kt(e){try{const t=await De();if(!t){le(e);return}const a=t.utils.json_to_sheet(e),o=t.utils.book_new(),s=c("reservations.reports.export.sheetName","Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª","Reservations");t.utils.book_append_sheet(o,a,s),t.writeFile(o,$e("xlsx"))}catch(t){console.error("âš ï¸ [reports] Excel export failed, falling back to CSV",t),le(e)}}async function St(e=[],t={}){const{exportReportsPdf:a}=await J(async()=>{const{exportReportsPdf:s}=await import("./pdfPages.BHLG7w6e.js");return{exportReportsPdf:s}},__vite__mapDeps([0,1,2,3,4,5,6,7]),import.meta.url),o=t?.action==="print"?"print":"save";await a(e,{action:o})}async function Et(e,t){switch(e){case"pdf":await St(t);break;case"excel":await kt(t);break;case"csv":default:le(t);break}}function Ct(e){const t=document.getElementById("reports-top-customers");if(t){if(!e||e.length===0){t.innerHTML=`<tr><td colspan="3" class="text-base-content/60">${c("reservations.reports.table.emptyPeriod","Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„ÙØªØ±Ø©.","No data for this period.")}</td></tr>`;return}t.innerHTML=e.map(a=>`
      <tr class="hover:bg-base-200 cursor-pointer" data-drilldown="customer" data-search="${U(a.name)}">
        <td>${L(a.name)}</td>
        <td>${E(a.count)}</td>
        <td>${g(a.revenue)}</td>
      </tr>
    `).join("")}}function $t(e){const t=document.getElementById("reports-top-equipment");if(t){if(!e||e.length===0){t.innerHTML=`<tr><td colspan="3" class="text-base-content/60">${c("reservations.reports.table.emptyPeriod","Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„ÙØªØ±Ø©.","No data for this period.")}</td></tr>`;return}t.innerHTML=e.map(a=>`
      <tr class="hover:bg-base-200 cursor-pointer" data-drilldown="equipment" data-search="${U(a.name)}">
        <td>${L(a.name)}</td>
        <td>${E(a.count)}</td>
        <td>${g(a.revenue)}</td>
      </tr>
    `).join("")}}function wt(e){const t=document.getElementById("reports-equipment-costs");if(t){if(!e||e.length===0){t.innerHTML=`<tr><td colspan="5" class="text-base-content/60">${c("reservations.reports.table.emptyPeriod","Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„ÙØªØ±Ø©.","No data for this period.")}</td></tr>`;return}t.innerHTML=e.map(a=>`
      <tr class="hover:bg-base-200">
        <td>${L(a.name)}</td>
        <td>${E(a.quantity)}</td>
        <td>${g(a.billable)}</td>
        <td>${g(a.cost)}</td>
        <td>${g(a.net)}</td>
      </tr>
    `).join("")}}function At(e){const t=document.getElementById("reports-crew-work");if(t){if(!e||e.length===0){t.innerHTML=`<tr><td colspan="5" class="text-base-content/60">${c("reservations.reports.table.emptyPeriod","Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„ÙØªØ±Ø©.","No data for this period.")}</td></tr>`;return}t.innerHTML=e.map(a=>`
      <tr class="hover:bg-base-200 cursor-pointer" data-drilldown="technician" data-search="${U(a.name)}">
        <td>${L(a.name)}</td>
        <td>${E(a.days)}</td>
        <td>${g(a.billable)}</td>
        <td>${g(a.cost)}</td>
        <td>${g(a.billable-a.cost)}</td>
      </tr>
    `).join("")}}function Lt(e){const t=document.getElementById("reports-payment-forecast");if(t){if(!e||e.length===0){t.innerHTML=`<tr><td colspan="3" class="text-base-content/60">${c("reservations.reports.table.emptyPeriod","Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„ÙØªØ±Ø©.","No data for this period.")}</td></tr>`;return}t.innerHTML=e.map(a=>`
      <tr>
        <td>${a.date}</td>
        <td>${c("reservations.reports.forecast.count","{count} Ø­Ø¬ÙˆØ²Ø§Øª","{count} reservations").replace("{count}",String(a.count||0))}</td>
        <td>${g(a.amount||0)}</td>
      </tr>
    `).join("")}}function Tt(e){const t=document.getElementById("reports-top-outstanding");if(t){if(!e||e.length===0){t.innerHTML=`<tr><td colspan="3" class="text-base-content/60">${c("reservations.reports.table.emptyPeriod","Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„ÙØªØ±Ø©.","No data for this period.")}</td></tr>`;return}t.innerHTML=e.map(a=>`
      <tr class="hover:bg-base-200 cursor-pointer" data-drilldown="reservation" data-search="${U(a.code)}">
        <td>#${L(String(a.code))} â€” ${L(a.customer||"")}</td>
        <td>${L(be(a.paidStatus))}</td>
        <td>${g(a.outstanding)}</td>
      </tr>
    `).join("")}}function Mt(e,t=[]){const a=document.getElementById("reports-maintenance-costs");if(!a)return;const o=Array.isArray(e?.items)?e.items:[],s=Array.isArray(t)?t:[];if(!o.length){a.innerHTML=`<tr><td colspan="5" class="text-base-content/60">${c("reservations.reports.table.emptyPeriod","Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„ÙØªØ±Ø©.","No data for this period.")}</td></tr>`;return}const r=c("reservations.reports.maintenance.noEquipment","Ù…Ø¹Ø¯Ø© ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙØ©","Unknown equipment"),l=c("reservations.reports.maintenance.noStatus","ØºÙŠØ± Ù…Ø­Ø¯Ø¯Ø©","Not specified"),d=m=>{if(!m)return 0;const f=new Date(m).getTime();return Number.isFinite(f)?f:0},v=o.map(m=>{const f=s.find(S=>String(S.id)===String(m.id)),h=f?.equipmentDesc||f?.equipmentBarcode||r,u=f?.statusLabel||f?.status||l,p=f?.equipmentBarcode||"";return{...m,equipment:h,status:u,barcode:p}}).sort((m,f)=>d(f?.date)-d(m?.date));a.innerHTML=v.map(m=>{const f=m?.id!=null?`#${L(String(m.id))}`:c("common.placeholder.empty","â€”","â€”"),h=m?.date?pe(m.date):c("common.placeholder.empty","â€”","â€”"),u=L(m.equipment||r),p=L(m.status||l),S=m.barcode?`<div class="text-xs text-base-content/70">${L(m.barcode)}</div>`:"";return`
        <tr>
          <td>${f}</td>
          <td>${u}${S}</td>
          <td>${p}</td>
          <td>${h}</td>
          <td>${g(m.cost||0)}</td>
        </tr>
      `}).join("")}const x=n.filters;function It(e){if(n.columnControlsBound)return;const t=document.getElementById("reports-column-controls");t&&(t.querySelectorAll("input[data-column-toggle]").forEach(a=>{const o=a.dataset.columnToggle;o&&(a.checked=n.columnPreferences[o]!==!1,a.addEventListener("change",()=>{n.columnPreferences[o]=a.checked,e()}))}),n.columnControlsBound=!0,e())}function we(){Object.entries(n.columnPreferences).forEach(([e,t])=>{document.querySelectorAll(`[data-report-column="${e}"]`).forEach(a=>{a.classList.toggle("hidden",!t)})})}function Pt(e){if(n.exportHandlersBound)return;const t=document.querySelectorAll("[data-export]");t.length&&(t.forEach(a=>{a.addEventListener("click",async()=>{const{export:o=""}=a.dataset;if(o){a.disabled=!0;try{await e(o)}catch(s){console.error("âš ï¸ [reports] export failed",s)}finally{a.disabled=!1}}})}),n.exportHandlersBound=!0)}function Dt(e,t){n.searchDebounceTimer&&(clearTimeout(n.searchDebounceTimer),n.searchDebounceTimer=null),n.searchDebounceTimer=setTimeout(()=>{x.search=e||"",t()},220)}function Rt(e,t){e&&(x.range="custom",x.start=e.startInput||null,x.end=e.endInput||null,t())}function Bt(e,t){e&&(x.status=x.status===e?"all":e,t())}function qt(e,t){e&&(x.payment=x.payment===e?"all":e,t())}function Nt(e,t){e&&(x.search=e,t())}function Ft({onClear:e}={}){const t=document.getElementById("reservations-active-filters");if(!t)return;const a=[],o=(s,r,l)=>{a.push(`<span class="filter-chip" data-chip="${s}">${r} <button type="button" aria-label="clear" data-clear="${s}">âœ•</button></span>`)};if(x.range&&x.range!=="all"||x.start||x.end){let s="";switch(x.range){case"thisWeek":s=c("reservations.reports.filters.range.thisWeek","Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹","This week");break;case"thisMonth":s=c("reservations.reports.filters.range.thisMonth","Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±","This month");break;case"thisQuarter":s=c("reservations.reports.filters.range.thisQuarter","Ù‡Ø°Ø§ Ø§Ù„Ø±Ø¨Ø¹","This quarter");break;case"thisYear":s=c("reservations.reports.filters.range.thisYear","Ù‡Ø°Ø§ Ø§Ù„Ø¹Ø§Ù…","This year");break;case"custom":default:s=`${c("reservations.reports.filters.range.custom","Ù…Ø®ØµØµ","Custom")} (${x.start||c("common.placeholder.empty","â€”","â€”")} â†’ ${x.end||c("common.placeholder.empty","â€”","â€”")})`}o("range",s)}if(x.status&&x.status!=="all"){const s=c(`reservations.reports.filters.status.${x.status}`,x.status,x.status);o("status",s)}if(x.payment&&x.payment!=="all"){const s=c(`reservations.reports.filters.payment.${x.payment}`,x.payment,x.payment);o("payment",s)}if(x.share&&x.share!=="all"){const s=c(`reservations.reports.filters.share.${x.share}`,x.share,x.share);o("share",s)}x.search&&x.search.trim().length&&o("search",`ğŸ” ${x.search.trim()}`),t.innerHTML=a.join(""),t.querySelectorAll("[data-clear]").forEach(s=>{s.addEventListener("click",()=>{const r=s.dataset.clear;r&&(r==="range"?(x.range="all",x.start=null,x.end=null):r in x&&(r==="search"?x.search="":x[r]="all"),e?.(r))})})}function Ht(e=[],t=[]){const a=document.getElementById("reports-quick-chips");if(!a)return;const o=Array.isArray(e)?e:[],s=Array.isArray(t)?t:[],r=x.status||"all",l=x.payment||"all",d=(u,p,S,k,C)=>`<button type="button" class="${`chip ${C?"chip-active":""}`}" data-quick-${k}="${u}" title="${p}">${p} <span class="chip-count">${S}</span></button>`,v=(u,p)=>u.find(S=>(S.filterKey||"").toLowerCase()===p),m=[];["confirmed","pending","completed","cancelled"].forEach(u=>{const p=v(o,u)||{label:u,rawCount:0};m.push(d(u,p.label||u,p.rawCount||0,"status",r===u))}),m.push('<span style="padding:0 6px;opacity:.6;">|</span>'),["paid","partial","unpaid"].forEach(u=>{const p=v(s,u)||{label:u,rawCount:0};m.push(d(u,p.label||u,p.rawCount||0,"payment",l===u))}),a.innerHTML=m.join("")}const i=n.filters;function me(){const e={range:i.range,status:i.status,payment:i.payment,share:i.share,search:(i.search||"").trim(),start:i.start,end:i.end};return JSON.stringify(e)}function X(){try{const e=document.querySelector(".dashboard-header"),t=Math.max(0,Math.round(e?.getBoundingClientRect()?.height||64));document.documentElement.style.setProperty("--reports-sticky-offset",`${t}px`)}catch{}}const Ae="reports.presets.v1";function te(){try{const e=JSON.parse(localStorage.getItem(Ae)||"[]");return Array.isArray(e)?e:[]}catch{return[]}}function fe(e){try{localStorage.setItem(Ae,JSON.stringify(Array.isArray(e)?e:[]))}catch{}}function _t(e){if(!e||!e.filters)return;const t=e.filters;i.range=t.range??i.range,i.status=t.status??i.status,i.payment=t.payment??i.payment,i.share=t.share??i.share,i.search=t.search??"",i.start=t.start??null,i.end=t.end??null,B(),P(),I()}function se(){const e=document.getElementById("reports-preset-select");if(!e)return;const t=te();e.innerHTML='<option value="">â€”</option>'+t.map((a,o)=>`<option value="${o}">${a.name||"Preset"}</option>`).join("")}function jt(){const e=document.getElementById("reports-preset-select"),t=document.getElementById("reports-preset-save"),a=document.getElementById("reports-preset-delete"),o=document.getElementById("reports-preset-share");!e||e.dataset.bound||(se(),e.addEventListener("change",()=>{const s=Number(e.value),r=te();Number.isInteger(s)&&s>=0&&s<r.length&&_t(r[s])}),t?.addEventListener("click",()=>{const s=window.prompt(c("reservations.reports.presets.savePrompt","Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù‚Ø§Ù„Ø¨","Enter preset name"),"Ù‚Ø§Ù„Ø¨");if(!s)return;const r=te(),l={range:i.range,status:i.status,payment:i.payment,share:i.share,search:i.search||"",start:i.start||null,end:i.end||null},d=r.findIndex(v=>(v.name||"").toLowerCase()===s.toLowerCase());d>=0?r[d]={name:s,filters:l}:r.push({name:s,filters:l}),fe(r),se()}),a?.addEventListener("click",()=>{const s=Number(e.value),r=te();!Number.isInteger(s)||s<0||s>=r.length||window.confirm(c("reservations.reports.presets.deleteConfirm","Ø­Ø°Ù Ø§Ù„Ù‚Ø§Ù„Ø¨ Ø§Ù„Ù…Ø®ØªØ§Ø±ØŸ","Delete selected preset?"))&&(r.splice(s,1),fe(r),se(),e.value="")}),o?.addEventListener("click",async()=>{try{P(),await new Promise(r=>setTimeout(r,140));const s=window.location.href;await(navigator.clipboard?.writeText?navigator.clipboard.writeText(s):Promise.reject()),console.log("[reports] Link copied")}catch{try{const r=document.createElement("a");r.href=window.location.href,r.target="_blank",document.body.appendChild(r),r.click(),r.remove()}catch{}}}),e.dataset.bound="true")}function ye(){he(),N(),setTimeout(()=>{he(),N(),de(),X()},0),de(),X()}let oe=null,ie=null;function N({refresh:e=!1}={}){oe&&clearTimeout(oe),oe=setTimeout(()=>{if(I(),e){const t=me();ae({silent:!0,signature:t,autoRender:!0}).catch(()=>{})}},140)}function O(){N({refresh:!0})}function de(e,t){if(!window.flatpickr)return;e&&(n.startDateInputRef=e),t&&(n.endDateInputRef=t);const a=n.startDateInputRef,o=n.endDateInputRef;if(!a&&!o)return;const s=zt(),r=l=>{const d={dateFormat:"Y-m-d",allowInput:!0,disableMobile:!0,altInput:!1,...l};return s&&(d.locale=s),d};if(n.startDatePicker&&(n.startDatePicker.destroy(),n.startDatePicker=null),n.endDatePicker&&(n.endDatePicker.destroy(),n.endDatePicker=null),a&&(n.startDatePicker=window.flatpickr(a,r({onChange(l,d){i.start=d||null,i.start||i.end?i.range="custom":!i.end&&i.range==="custom"&&(i.range="all"),n.endDatePicker&&(l?.length?n.endDatePicker.set("minDate",l[0]):n.endDatePicker.set("minDate",null)),O()},onValueUpdate(l,d){i.start=d||null,i.start||i.end?i.range="custom":!i.end&&i.range==="custom"&&(i.range="all"),O()}}))),o&&(n.endDatePicker=window.flatpickr(o,r({onChange(l,d){i.end=d||null,i.start||i.end?i.range="custom":!i.start&&i.range==="custom"&&(i.range="all"),n.startDatePicker&&(l?.length?n.startDatePicker.set("maxDate",l[0]):n.startDatePicker.set("maxDate",null)),O()},onValueUpdate(l,d){i.end=d||null,i.start||i.end?i.range="custom":!i.start&&i.range==="custom"&&(i.range="all"),O()}}))),n.startDatePicker&&a){n.startDatePicker.setDate(a.value,!1);const l=n.endDatePicker?.selectedDates?.[0]||n.endDateInputRef?.value;l&&n.startDatePicker.set("maxDate",l)}if(n.endDatePicker&&o){n.endDatePicker.setDate(o.value,!1);const l=n.startDatePicker?.selectedDates?.[0]||n.startDateInputRef?.value;l&&n.endDatePicker.set("minDate",l)}}function zt(){return(nt()||"ar").toLowerCase().startsWith("ar")?window.flatpickr?.l10ns?.ar?"ar":null:window.flatpickr?.l10ns?.en?"en":null}function ue(e,t){e&&(e.classList.add("active"),e.classList.remove("hidden"))}function B(){const e=document.getElementById("reports-range"),t=document.getElementById("reports-status-filter"),a=document.getElementById("reports-payment-filter"),o=document.getElementById("reports-share-filter"),s=document.getElementById("reports-search"),r=document.getElementById("reports-start"),l=document.getElementById("reports-end"),d=document.getElementById("reports-custom-range");e&&e.value!==i.range&&(e.value=i.range),t&&t.value!==i.status&&(t.value=i.status),a&&a.value!==i.payment&&(a.value=i.payment),o&&o.value!==i.share&&(o.value=i.share),s&&s.value!==i.search&&(s.value=i.search||""),r&&r.value!==(i.start||"")&&(r.value=i.start||""),l&&l.value!==(i.end||"")&&(l.value=i.end||""),ue(d)}function Ot(){try{const e=new URLSearchParams(window.location.search),t=o=>e.get(o),a=o=>o==null||o===""?null:o;i.range=t("range")||i.range,i.status=t("status")||i.status,i.payment=t("payment")||i.payment,i.share=t("share")||i.share,i.search=t("search")||"",i.start=a(t("start")),i.end=a(t("end")),(i.start||i.end)&&(i.range="custom")}catch{}}function P(){ie&&clearTimeout(ie),ie=setTimeout(()=>{try{const e=new URLSearchParams,t=(s,r,l)=>{r!=null&&r!==""&&r!==l&&e.set(s,r)};t("range",i.range,"all"),t("status",i.status,"all"),t("payment",i.payment,"all"),t("share",i.share,"all"),t("search",i.search,""),t("start",i.start,null),t("end",i.end,null);const a=e.toString(),o=a?`${location.pathname}?${a}`:location.pathname;window.history.replaceState({},"",o)}catch{}},120)}function Le({active:e,icon:t,title:a,subtitle:o}){const s=document.getElementById("reports-empty-state");if(!s)return;const r=s.querySelector(".reports-empty-icon"),l=s.querySelector("h4"),d=s.querySelector("p");n.emptyDefaults.icon===null&&r&&(n.emptyDefaults.icon=r.textContent),n.emptyDefaults.title===null&&l&&(n.emptyDefaults.title=l.textContent),n.emptyDefaults.subtitle===null&&d&&(n.emptyDefaults.subtitle=d.textContent),s.classList.toggle("active",!!e),s.classList.toggle("hidden",!e),!(!r||!l||!d)&&(e?(r.textContent=t!==void 0?t:n.emptyDefaults.icon??r.textContent,l.textContent=a!==void 0?a:n.emptyDefaults.title??l.textContent,d.textContent=o!==void 0?o:n.emptyDefaults.subtitle??d.textContent):(r.textContent=n.emptyDefaults.icon??r.textContent,l.textContent=n.emptyDefaults.title??l.textContent,d.textContent=n.emptyDefaults.subtitle??d.textContent))}function Ut(e){Le({active:!!e})}function ge(e){const t=document.getElementById("reports-kpi-skeleton"),a=document.getElementById("reservations-reports-kpis"),o=document.getElementById("reports-table-skeleton"),s=document.getElementById("reports-reservations-table"),r=document.getElementById("reservations-revenue-skeleton"),l=document.getElementById("reservations-revenue-breakdown");t&&a&&(t.style.display=e?"":"none",a.style.opacity=e?"0.4":"1"),o&&s&&(o.style.display=e?"":"none",s.style.opacity=e?"0.4":"1"),r&&l&&(r.style.display=e?"":"none",l.style.opacity=e?"0.4":"1")}function Gt(){if(n.drilldownBound)return;const e=document.getElementById("reports-top-customers"),t=document.getElementById("reports-top-equipment"),a=document.getElementById("reports-reservations-body"),o=document.getElementById("reports-quick-chips"),s=r=>{const l=r.target?.closest("[data-drilldown]");if(!l)return;const d=l.dataset.search||"";Nt(d,()=>{B(),I()})};e?.addEventListener("click",s),t?.addEventListener("click",s),a?.addEventListener("click",s),o?.addEventListener("click",r=>{const l=r.target?.closest("[data-quick-status], [data-quick-payment]");if(l){if(l.hasAttribute("data-quick-status")){const d=l.getAttribute("data-quick-status")||"all";i.status=i.status===d?"all":d}else if(l.hasAttribute("data-quick-payment")){const d=l.getAttribute("data-quick-payment")||"all";i.payment=i.payment===d?"all":d}B(),P(),I()}}),n.drilldownBound=!0}function z(){const e=me();ae({silent:!0,signature:e,autoRender:!0}).catch(t=>{console.error("âŒ [reports] Background refresh failed",t)})}function I(){if(B(),P(),Ft({onClear:()=>{B(),P(),I()}}),n.loading){ge(!0);return}if(n.errorMessage){Le({active:!0,icon:"âš ï¸",title:n.errorMessage,subtitle:c("reservations.reports.status.retry","Ø¬Ø±Ù‘Ø¨ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ø£Ùˆ ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø©.")});return}ge(!1);const{reservations:e,customers:t,equipment:a,technicians:o,maintenance:s}=n.data,r=Re(e,i,t,a,o),l=Be(r),d=qe(s,i),v=Ne(l,d.total),m=Fe(r),f=He(r),h=_e(r),u=je(r),p=ze(r,t),S=Oe(r,a),k=Ue(r,o),C=Ge(r),$=Ve(r),y=We(r,t,5);dt(v),ot(m),it(f),lt(h),ct(u),Ht(f,u),Ct(p),$t(S),wt(C),Tt(y),At(k),Mt(d,s);try{Lt($)}catch{}const b=ut(r,t,o);we(),Ut(r.length===0),n.lastSnapshot.filtered=r,n.lastSnapshot.metrics=v,n.lastSnapshot.trend=m,n.lastSnapshot.statusBreakdown=f,n.lastSnapshot.paymentBreakdown=u,n.lastSnapshot.tableRows=b,n.lastSnapshot.maintenance=d,n.lastSnapshot.outstanding=y,n.lastSnapshot.crewWork=k,n.lastSnapshot.equipmentCosts=C,n.lastSnapshot.paymentForecast=$}function Zt(){if(n.initialized)return;n.initialized=!0;const e=document.getElementById("reports-range"),t=document.getElementById("reports-status-filter"),a=document.getElementById("reports-payment-filter"),o=document.getElementById("reports-share-filter"),s=document.getElementById("reports-start"),r=document.getElementById("reports-end"),l=document.getElementById("reports-custom-range"),d=document.getElementById("reports-search");if(!e)return;Ot(),B(),X(),st()&&I(),e.addEventListener("change",()=>{i.range=e.value,ue(l),i.range!=="custom"&&(i.start=null,i.end=null),P(),N({refresh:!0})}),t?.addEventListener("change",()=>{i.status=t.value,(i.status==="pending"||i.status==="cancelled")&&(i.status="all",t.value="all"),P(),N()}),a?.addEventListener("change",()=>{i.payment=a.value,P(),N()}),o?.addEventListener("change",()=>{i.share=o.value,P(),N()}),d?.addEventListener("input",()=>{const h=d.value||"";Dt(h,()=>{B(),P(),N()})}),s?.addEventListener("change",()=>{i.start=s.value||null,(i.start||i.end)&&(i.range="custom"),P(),O()}),r?.addEventListener("change",()=>{i.end=r.value||null,(i.start||i.end)&&(i.range="custom"),P(),O()}),de(s,r),ue(l),jt(),n.languageListenerAttached||(document.addEventListener("language:changed",ye),document.addEventListener("language:translationsReady",ye),n.languageListenerAttached=!0),n.dataListenersAttached||(document.addEventListener("reservations:changed",z),document.addEventListener("customers:changed",z),document.addEventListener("equipment:changed",z),document.addEventListener("projects:changed",z),document.addEventListener("technicians:updated",z),window.addEventListener("maintenance:updated",z),n.dataListenersAttached=!0),It?.(we),Pt(async h=>{const u=n.lastSnapshot.tableRows||[];if(!u.length){console.warn("[reports] No reservation data to export");return}if(h==="pdf")try{const{exportA4ReportPdf:p}=await J(async()=>{const{exportA4ReportPdf:S}=await import("./a4Unified.DNKAc6-H.js");return{exportA4ReportPdf:S}},__vite__mapDeps([8,1,2,3,4,5]),import.meta.url);await p(u,{action:"save",strict:!0});return}catch(p){console.warn("[reports] page-based PDF export failed, falling back to legacy",p)}else if(h==="excel")try{const{exportA4ReportExcel:p}=await J(async()=>{const{exportA4ReportExcel:S}=await import("./a4Unified.DNKAc6-H.js");return{exportA4ReportExcel:S}},__vite__mapDeps([8,1,2,3,4,5]),import.meta.url);await p(u);return}catch(p){console.warn("[reports] A4-based Excel export failed, falling back to legacy",p)}else if(h==="csv")try{const{exportA4ReportCsv:p}=await J(async()=>{const{exportA4ReportCsv:S}=await import("./a4Unified.DNKAc6-H.js");return{exportA4ReportCsv:S}},__vite__mapDeps([8,1,2,3,4,5]),import.meta.url);await p(u);return}catch(p){console.warn("[reports] A4-based CSV export failed, falling back to legacy",p)}await Et(h,u)});const m=document.getElementById("reports-preview-pdf");if(m&&!m.dataset.bound&&(m.addEventListener("click",async()=>{try{const h=await J(()=>import("./preview.hfWYnEn2.js"),__vite__mapDeps([9,1,2,3,4,5,8]),import.meta.url),u=n.lastSnapshot.tableRows||[];h.openReportsPdfPreview(u)}catch(h){console.error("âš ï¸ [reports] Failed to open PDF preview",h)}}),m.dataset.bound="true"),Gt(),n.themeListenerAttached||(document.addEventListener("theme:changed",()=>{setTimeout(()=>{I(),X()},0)}),n.themeListenerAttached=!0),!n.stickyOffsetListenerAttached){const h=()=>X();window.addEventListener("resize",h),setTimeout(h,100),setTimeout(h,500),n.stickyOffsetListenerAttached=!0}Ye(I),Ke(()=>{I()}),Je(()=>{I()}),Qe(h=>{Rt(h,()=>{B(),I()})}),Xe(h=>{Bt(h?.filterKey,()=>{B(),I()})}),Ze(h=>{qt(h?.filterKey,()=>{B(),I()})});const f=me();ae({signature:f}).catch(h=>{console.error("âŒ [reports] Failed to initialise reports data",h)})}export{Zt as initReports,I as renderReports};
