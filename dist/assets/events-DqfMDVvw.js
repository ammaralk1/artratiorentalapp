import{r as s,b as c,i as f,c as m,d as p,l as v,e as h,f as b,u as l,g as I,h as F,j as y}from"./controller-CpHuw6ke.js";import{e as C,w as E,x as w,y as R}from"./projectsService-D6f-zBqg.js";import{e as T}from"./auth-CXJ9BVF7.js";let u=!1;function g(){document.querySelectorAll('input[type="time"]').forEach(t=>{t.setAttribute("step","3600"),t.dataset.listenerAttached!=="true"&&(t.addEventListener("change",()=>{if(!t.value)return;const[r]=t.value.split(":");t.value=`${r.padStart(2,"0")}:00`}),t.dataset.listenerAttached="true")})}function k(){return typeof window<"u"&&typeof window.flatpickr=="function"?window.flatpickr.bind(window):typeof globalThis<"u"&&typeof globalThis.flatpickr=="function"?globalThis.flatpickr.bind(globalThis):(console.warn("⚠️ Flatpickr غير متاح - سيتم تخطي تهيئة عناصر التاريخ"),null)}function M(){const e=k();if(!e)return;const t={dateFormat:"Y-m-d",altInput:!0,altFormat:"Y-m-d",allowInput:!0,disableMobile:!0,altInputClass:"flatpickr-alt-input form-control"},r=[["#res-start",{}],["#res-end",{}],["#filter-start-date",{}],["#filter-end-date",{}],["#edit-res-start",{}],["#edit-res-end",{}]],d=[["#res-start-time",{enableTime:!0,noCalendar:!0,dateFormat:"H:i",altInput:!0,altFormat:"h:iK",time_24hr:!1,defaultHour:9,defaultMinute:0,disableMobile:!0,altInputClass:"flatpickr-alt-input form-control"}],["#res-end-time",{enableTime:!0,noCalendar:!0,dateFormat:"H:i",altInput:!0,altFormat:"h:iK",time_24hr:!1,defaultHour:9,defaultMinute:0,disableMobile:!0,altInputClass:"flatpickr-alt-input form-control"}],["#edit-res-start-time",{enableTime:!0,noCalendar:!0,dateFormat:"H:i",altInput:!0,altFormat:"h:iK",time_24hr:!1,defaultHour:9,defaultMinute:0,disableMobile:!0,altInputClass:"flatpickr-alt-input form-control"}],["#edit-res-end-time",{enableTime:!0,noCalendar:!0,dateFormat:"H:i",altInput:!0,altFormat:"h:iK",time_24hr:!1,defaultHour:9,defaultMinute:0,disableMobile:!0,altInputClass:"flatpickr-alt-input form-control"}]];r.forEach(([a,n])=>{document.querySelector(a)&&e(a,{...t,...n})}),d.forEach(([a,n])=>{document.querySelector(a)&&e(a,n)});const i=document.querySelector("#res-start-time");i&&i.dispatchEvent(new Event("change",{bubbles:!0}))}function S(){g(),m(()=>s()),p(I()),w({onDraftChange:F,onEditChange:l}),v(),h(),u=!0}function L(){const e=document.body;e&&e.dataset.reservationsTechListener!=="true"&&(document.addEventListener("technicians:updated",()=>{const{technicians:t=[]}=T();R(t),b(),l()}),e.dataset.reservationsTechListener="true")}async function o(){await C();try{await E({force:!0})}catch(e){console.warn("⚠️ [reservations/events] Failed to pre-load projects for reservation form",e)}s(),c(),f({onAfterSubmit:y}),u||S(),M(),L()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{o().catch(e=>{console.error("❌ [reservations/events] Failed to initialize reservations UI",e)})},{once:!0}):o().catch(e=>{console.error("❌ [reservations/events] Failed to initialize reservations UI",e)});export{S as s};
