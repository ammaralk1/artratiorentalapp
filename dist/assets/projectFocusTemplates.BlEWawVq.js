import{r as Ft,n as y,t as a,p as It}from"./auth.BLFzWQsL.js";import{c as Lt,e as m,d as kt,t as qt,f as S}from"./state.BK2rhNHf.js";import{d as ct,c as Bt,e as Ot,g as Ht}from"./reservationsService.EFzUE5dL.js";import{f as st}from"./view.CKDEYi6a.js";Ft({ar:{"customerDetails.pageTitle":"Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„","customerDetails.title":"ğŸ‘¤ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„","customerDetails.hero.subtitle":"ğŸ‘‹ Ù‡Ø°Ù‡ Ù†Ø¸Ø±Ø© Ø³Ø±ÙŠØ¹Ø© Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„","customerDetails.fields.taxId":"ğŸ§¾ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø¶Ø±ÙŠØ¨ÙŠ:","customerDetails.fields.document":"ğŸ“ Ù…Ø³ØªÙ†Ø¯ Ø§Ù„Ø¹Ù…ÙŠÙ„","customerDetails.stats.reservations":"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª","customerDetails.stats.upcoming":"Ø­Ø¬ÙˆØ²Ø§Øª Ù‚Ø§Ø¯Ù…Ø©","customerDetails.stats.projects":"Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹","customerDetails.stats.projectsEmpty":"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø´Ø§Ø±ÙŠØ¹ Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù…ÙŠÙ„.","customerDetails.stats.lastActivity":"Ø¢Ø®Ø± Ù†Ø´Ø§Ø·","customerDetails.stats.lastActivityEmpty":"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù†Ø´Ø§Ø· Ø­Ø¯ÙŠØ«","customerDetails.stats.reservationsDesc":"Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª Ø§Ù„ÙƒÙ„ÙŠ","customerDetails.stats.upcomingEmpty":"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­Ø¬ÙˆØ²Ø§Øª Ù‚Ø§Ø¯Ù…Ø©","customerDetails.stats.nextReservation":"Ø£Ù‚Ø±Ø¨ Ø­Ø¬Ø²: {date}","customerDetails.stats.projectsDesc":"Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ø§Ù„Ø¹Ù…ÙŠÙ„","customerDetails.stats.payment":"Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¯ÙÙˆØ¹/Ø§Ù„Ù…Ø³ØªØ­Ù‚","customerDetails.stats.paymentBreakdown":"Ù…Ø¯ÙÙˆØ¹ / Ù…Ø³ØªØ­Ù‚","customerDetails.stats.paymentPaid":"Ø§Ù„Ù…Ø¯ÙÙˆØ¹","customerDetails.stats.paymentOutstandingLabel":"Ø§Ù„Ù…Ø³ØªØ­Ù‚","customerDetails.stats.totalValue":"Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©: {amount}","customerDetails.stats.totalValueEmpty":"Ù„Ù… ÙŠØªÙ… Ø±ØµØ¯ Ù…Ø¨Ø§Ù„Øº Ø¨Ø¹Ø¯.","customerDetails.stats.paymentOutstanding":"Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: {amount}","customerDetails.stats.paymentAllSet":"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¨Ø§Ù„Øº Ù…Ø³ØªØ­Ù‚Ø©","customerDetails.stats.paymentOutstandingEmpty":"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¨Ø§Ù„Øº Ù…Ø³ØªØ­Ù‚Ø©","customerDetails.stats.activityEmpty":"Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù†Ø´Ø§Ø· Ø­Ø¯ÙŠØ«","customerDetails.stats.activityOn":"Ø¨ØªØ§Ø±ÙŠØ® {date}","customerDetails.stats.activityType.reservation":"Ø­Ø¬Ø²","customerDetails.stats.activityType.project":"Ù…Ø´Ø±ÙˆØ¹","customerDetails.stats.activityType.customer":"Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„","customerDetails.stats.complianceEmpty":"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ø¯ÙØ¹ ÙƒØ§ÙÙŠØ©","customerDetails.stats.complianceProjects":"Ù…Ø´Ø§Ø±ÙŠØ¹ Ù…Ø¯ÙÙˆØ¹Ø© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„: {count} Ù…Ù† {total}","customerDetails.stats.complianceLabel.excellent":"Ø§Ù„ØªØ²Ø§Ù… Ù…Ù…ØªØ§Ø²","customerDetails.stats.complianceLabel.good":"Ø¯ÙØ¹ ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø­Ø¯Ø¯","customerDetails.stats.complianceLabel.average":"ÙŠØ­ØªØ§Ø¬ Ù…ØªØ§Ø¨Ø¹Ø©","customerDetails.stats.complianceLabel.poor":"ØªØ£Ø®ÙŠØ± Ù…ØªÙƒØ±Ø±","customerDetails.document.open":"Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø³ØªÙ†Ø¯","customerDetails.document.defaultName":"Ø§Ù„Ù…Ø³ØªÙ†Ø¯ Ø§Ù„Ù…Ø±ØªØ¨Ø·","customerDetails.primaryNav.reservations":"ğŸ“… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª","customerDetails.primaryNav.projects":"ğŸ“ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹","customerTabs.reservations":"ğŸ“… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª","customerTabs.projects":"ğŸ“ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹","customerTabs.customerReservations":"ğŸ“… Ø­Ø¬ÙˆØ²Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„","customerTabs.customerProjects":"ğŸ“ Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„Ø¹Ù…ÙŠÙ„","customerDetails.actions.back":"â¬…ï¸ Ø§Ù„Ø¹ÙˆØ¯Ø©","customerDetails.actions.edit":"âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¹Ù…ÙŠÙ„","customerDetails.filters.search":"ğŸ” Ø§Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø£Ùˆ Ø±Ù‚Ù… Ø§Ù„Ø­Ø¬Ø²...","customerDetails.fields.name":"ğŸ‘¤ Ø§Ù„Ø§Ø³Ù…:","customerDetails.fields.phone":"ğŸ“ Ø§Ù„Ø¬ÙˆØ§Ù„:","customerDetails.fields.company":"ğŸ¢ Ø§Ù„Ø´Ø±ÙƒØ©:","customerDetails.fields.email":"ğŸ“§ Ø§Ù„Ø¨Ø±ÙŠØ¯:","customerDetails.fields.address":"ğŸ“ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:","customerDetails.fields.notes":"ğŸ“ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª:","customerDetails.toast.missingRequired":"âš ï¸ Ø§Ù„Ø§Ø³Ù… ÙˆØ±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø¥Ù„Ø²Ø§Ù…ÙŠØ§Ù†","customerDetails.toast.notFound":"âš ï¸ Ø§Ù„Ø¹Ù…ÙŠÙ„ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯","customerDetails.toast.updateSuccess":"âœ… ØªÙ… ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„","customerDetails.status.loading":"â³ Ø¬Ø§Ø±Ù ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„...","customerDetails.errors.notFound":"âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù…ÙŠÙ„.","customerDetails.errors.loadFailed":"âš ï¸ ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„.","customerDetails.errors.missingId":"âš ï¸ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø¹Ø±Ù Ø¹Ù…ÙŠÙ„ ÙÙŠ Ø§Ù„Ø±Ø§Ø¨Ø·.","customerDetails.edit.modalTitle":"âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¹Ù…ÙŠÙ„","customerProjects.title":"ğŸ“ Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„Ø¹Ù…ÙŠÙ„","customerProjects.empty":"Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø´Ø§Ø±ÙŠØ¹ Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù…ÙŠÙ„."},en:{"customerDetails.pageTitle":"Customer Details","customerDetails.title":"ğŸ‘¤ Client Profile","customerDetails.hero.subtitle":"ğŸ‘‹ Here is a quick look at this client","customerDetails.fields.taxId":"ğŸ§¾ Tax Number:","customerDetails.fields.document":"ğŸ“ Client Document","customerDetails.stats.reservations":"Total Reservations","customerDetails.stats.upcoming":"Upcoming Reservations","customerDetails.stats.projects":"Projects Count","customerDetails.stats.projectsEmpty":"No projects linked yet.","customerDetails.stats.lastActivity":"Last Activity","customerDetails.stats.lastActivityEmpty":"No recent activity","customerDetails.stats.reservationsDesc":"All linked reservations","customerDetails.stats.upcomingEmpty":"No upcoming reservations","customerDetails.stats.nextReservation":"Next reservation: {date}","customerDetails.stats.projectsDesc":"Projects tied to the client","customerDetails.stats.payment":"Paid vs Outstanding","customerDetails.stats.paymentBreakdown":"Paid / Outstanding","customerDetails.stats.paymentPaid":"Paid","customerDetails.stats.paymentOutstandingLabel":"Outstanding","customerDetails.stats.totalValue":"Total value: {amount}","customerDetails.stats.totalValueEmpty":"No financial data recorded yet.","customerDetails.stats.paymentOutstanding":"Outstanding: {amount}","customerDetails.stats.paymentAllSet":"No pending payments","customerDetails.stats.paymentOutstandingEmpty":"No pending payments","customerDetails.stats.activityEmpty":"No recent activity","customerDetails.stats.activityOn":"On {date}","customerDetails.stats.activityType.reservation":"Reservation","customerDetails.stats.activityType.project":"Project","customerDetails.stats.activityType.customer":"Client record","customerDetails.stats.complianceEmpty":"Not enough payment data yet","customerDetails.stats.complianceProjects":"Fully paid projects: {count} of {total}","customerDetails.stats.complianceLabel.excellent":"Excellent commitment","customerDetails.stats.complianceLabel.good":"On-time payments","customerDetails.stats.complianceLabel.average":"Needs follow-up","customerDetails.stats.complianceLabel.poor":"Repeated delays","customerDetails.document.open":"Open document","customerDetails.document.defaultName":"Linked document","customerDetails.primaryNav.reservations":"ğŸ“… Booking Management","customerDetails.primaryNav.projects":"ğŸ“ Project Management","customerTabs.reservations":"ğŸ“… Booking Management","customerTabs.projects":"ğŸ“ Project Management","customerTabs.customerReservations":"ğŸ“… Client Reservations","customerTabs.customerProjects":"ğŸ“ Client Projects","customerDetails.actions.back":"â¬…ï¸ Back","customerDetails.actions.edit":"âœï¸ Edit Client","customerDetails.filters.search":"ğŸ” Search by client or reservation ID...","customerDetails.fields.name":"ğŸ‘¤ Name:","customerDetails.fields.phone":"ğŸ“ Phone:","customerDetails.fields.company":"ğŸ¢ Company:","customerDetails.fields.email":"ğŸ“§ Email:","customerDetails.fields.address":"ğŸ“ Address:","customerDetails.fields.notes":"ğŸ“ Notes:","customerDetails.toast.missingRequired":"âš ï¸ Name and phone are required","customerDetails.toast.notFound":"âš ï¸ Client not found","customerDetails.toast.updateSuccess":"âœ… Client information updated","customerDetails.status.loading":"â³ Loading client information...","customerDetails.errors.notFound":"âš ï¸ This client could not be found.","customerDetails.errors.loadFailed":"âš ï¸ Failed to load client information.","customerDetails.errors.missingId":"âš ï¸ Missing client identifier in the URL.","customerDetails.edit.modalTitle":"âœï¸ Edit Client","customerProjects.title":"ğŸ“ Client Projects","customerProjects.empty":"No projects are linked to this client."}});const F=.15,Vt=2,Mt={upcoming:"Upcoming",ongoing:"In Progress",completed:"Completed"},Wt={upcoming:"timeline-status-badge timeline-status-badge--upcoming",ongoing:"timeline-status-badge timeline-status-badge--ongoing",completed:"timeline-status-badge timeline-status-badge--completed"};function at(t){if(!t)return null;const e=[t?.id,t?.reservationId,t?.reservation_id,t?.reservationID].find(o=>o!=null&&o!=="");return e!=null?String(e):null}function zt(t,n){if(!t)return{dateHtml:"â€”",timeText:""};const e=st(t),o=n?st(n):"",i=g=>{const v=String(g).split(" ").filter(Boolean),T=v.shift()||"",p=v.join(" ");return{date:T,time:p}},c=i(e),l=o?i(o):{date:"",time:""};let s="",d="";const f=a("common.range.from","Ù…Ù†"),D=a("common.range.to","Ø¥Ù„Ù‰");return l.date&&c.date===l.date?(s=`<div class="date-range"><div class="date-line">${c.date}</div></div>`,d=`${f} ${c.time||"â€”:â€”"} ${D} ${l.time||"â€”:â€”"}`):(s=`<div class="date-range"><div class="date-line">${c.date}</div>`+(l.date?`<div class="date-line">${l.date}</div>`:"")+"</div>",d=`${f} ${c.time||"â€”:â€”"} ${D} ${l.time||"â€”:â€”"}`),{dateHtml:s,timeText:d}}function Ut(t=[]){const n=Ht();return t.map(e=>{const o=e?.reservation??e;if(!o||typeof o!="object")return null;let i=Number.isInteger(e?.index)&&e.index>=0?e.index:Number.isInteger(e?.reservationIndex)&&e.reservationIndex>=0?e.reservationIndex:null;if(!Number.isInteger(i)||i<0){const c=at(o);c&&(i=n.findIndex(l=>{const s=at(l);return s&&s===c}))}return{reservation:o,index:Number.isInteger(i)&&i>=0?i:-1}}).filter(Boolean)}function Jt(t){return t?t.id!=null?String(t.id):t.projectId!=null?String(t.projectId):t.project_id!=null?String(t.project_id):null:null}function ne(t,{customer:n=null,techniciansMap:e=new Map,reservations:o=[]}={}){const c=Ut(o).map(({reservation:u})=>u),l=c.length,s=Jt(t),d=s?m(s):"",f=kt(t),D=a(`projects.status.${f}`,Mt[f]),g=Wt[f]||"bg-secondary",v=nt(t)||{},T=Number(v.subtotal||0),p=(c||[]).reduce((u,r)=>u+it(r),0),b=v.applyTax?Number(((T+p)*F).toFixed(2)):0,h=Number((T+p+b).toFixed(2)),w=Array.isArray(t?.paymentHistory)?t.paymentHistory:Array.isArray(t?.payments)?t.payments:[],L=Bt({totalAmount:h,paidAmount:w.length?0:t.paidAmount,paidPercent:w.length?0:t.paidPercent,history:w}),C=Ot({manualStatus:null,paidAmount:L.paidAmount,paidPercent:L.paidPercent,totalAmount:h}),rt=a(`projects.paymentStatus.${C}`,C==="paid"?"Paid":C==="partial"?"Partially Paid":"Unpaid"),lt=C==="paid"?"status-paid":C==="partial"?"status-partial":"status-unpaid",k=[C==="paid"?"project-focus-card--paid":"project-focus-card--unpaid"],$=t?.confirmed===!0||t?.confirmed==="true";$&&k.push("project-focus-card--confirmed");const q=t?.projectCode||(s?`PRJ-${y(s)}`:""),_=q?y(String(q).replace(/^#/,"")):"",ut=_?`<span class="project-code-badge project-focus-card__code">#${m(_)}</span>`:"",B=Kt(t?.type),mt="",dt=`<span class="${g}">${m(D)}</span>`,pt=`<span class="reservation-chip ${lt} project-focus-card__payment-chip">${m(rt)}</span>`,yt=(t?.title||"").trim()||a("projects.fallback.untitled","Untitled project"),O=(t?.description||"").trim(),ft=O?m(qt(O,110)):m(a("projects.fallback.noDescription","No description")),H=Array.isArray(t?.technicians)?t.technicians:[],V=H.map(u=>e.get(String(u))?.name).filter(Boolean);V.length&&Gt(V);const M=n?.customerName||t?.clientName||"";(t?.clientCompany||n?.companyName||"").trim();const N=c.reduce((u,r)=>{const x=it(r),tt=Array.isArray(r?.items)?r.items:[],wt=tt.reduce((Rt,Et)=>Rt+(Number(Et?.qty)||0),0),$t=Array.isArray(r?.technicians)?r.technicians.length:0,et=Array.isArray(r?.crewAssignments)?r.crewAssignments:[],j=et.length?et:Array.isArray(r?.technicians)?r.technicians:[],E=ct({items:tt,technicianIds:Array.isArray(j)&&!j.length?j:[],crewAssignments:Array.isArray(j)&&j.length&&typeof j[0]=="object"?j:[],discount:r?.discount??0,discountType:r?.discountType||"percent",applyTax:!1,start:r?.start,end:r?.end,companySharePercent:null});return{total:u.total+x,equipment:u.equipment+Number(E.equipmentTotal||0),crew:u.crew+Number(E.crewTotal||0),crewCost:u.crewCost+Number(E.crewCostTotal||0),equipmentCountTotal:(u.equipmentCountTotal||0)+wt,crewCountTotal:(u.crewCountTotal||0)+$t}},{total:0,equipment:0,crew:0,crewCost:0,equipmentCountTotal:0,crewCountTotal:0}),W=Number(N.total.toFixed(2)),z=N.equipmentCountTotal||0,U=N.crewCountTotal||H.length,J=nt(t),X=Number(t?.servicesClientPrice??0),P=Number((N.equipment+N.crew+X).toFixed(2)),G=Number.parseFloat(t?.discount??t?.discountValue??0)||0;let A=(t?.discountType==="amount"?"amount":"percent")==="amount"?G:P*(G/100);(!Number.isFinite(A)||A<0)&&(A=0),A>P&&(A=P);const R=Math.max(0,P-A),gt=t?.companyShareEnabled===!0||t?.companyShareEnabled==="true"||t?.company_share_enabled===!0||t?.company_share_enabled==="true",K=Number.parseFloat(t?.companySharePercent??t?.company_share_percent??t?.companyShare??t?.company_share??0)||0,Q=gt&&K>0?K:0,Y=Number((R*(Q/100)).toFixed(2)),bt=J.applyTax?Number(((R+Y)*F).toFixed(2)):0,Dt=Number((R+Y+bt).toFixed(2)),{dateHtml:vt,timeText:Z}=zt(t?.start,t?.end),ht=[_?{icon:"ğŸ†”",label:a("projectCards.meta.code","Ø±Ù‚Ù… Ø§Ù„Ù…Ø´Ø±ÙˆØ¹"),value:`#${_}`}:null,M?{icon:"ğŸ‘¤",label:a("projectCards.meta.client","Ø§Ù„Ø¹Ù…ÙŠÙ„"),value:M}:null,B?{icon:"ğŸ·ï¸",label:a("projects.details.type","Ù†ÙˆØ¹ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹"),value:`<span class="project-type-chip project-type-chip--${t.type||"default"}">${m(B)}</span>`}:null,{icon:"ğŸ“…",label:a("projects.focus.summary.range","Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ©"),value:vt},Z?{icon:"â°",label:a("projects.focus.summary.time","Ø§Ù„ÙˆÙ‚Øª"),value:Z}:null].filter(Boolean);a("projectCards.stats.reservationsShort","Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª"),y(String(l)),a("projectCards.stats.equipmentCount","Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¹Ø¯Ø§Øª"),y(String(z)),a("projectCards.stats.crewCount","Ø¹Ø¯Ø¯ Ø£ÙØ±Ø§Ø¯ Ø§Ù„Ø·Ø§Ù‚Ù…"),y(String(U)),a("projectCards.stats.reservationValue","Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª"),S(W);const Tt=Q>0&&J.applyTax?` ${a("projects.details.chips.vatOn","(Ø´Ø§Ù…Ù„ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©)")}`:"",jt=`${a("projects.details.summary.finalTotal","Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ")}${Tt}`,Ct=[{icon:"ğŸ’¼",label:a("projectCards.stats.servicesClientPrice","Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø¥Ù†ØªØ§Ø¬ÙŠØ©"),value:S(X)},{icon:"ğŸ’µ",label:jt,value:S(Dt)}].map(({icon:u,label:r,value:x})=>I(u,r,x)).join(""),At=[{icon:"ğŸ”—",label:a("projectCards.stats.reservationsShort","Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª"),value:y(String(l))},{icon:"ğŸ“¦",label:a("projectCards.stats.equipmentCount","Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¹Ø¯Ø§Øª"),value:y(String(z))},{icon:"ğŸ˜",label:a("projectCards.stats.crewCount","Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ø§Ù‚Ù…"),value:y(String(U))},{icon:"ğŸ’µ",label:a("projectCards.stats.reservationValue","Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª"),value:S(W)}].map(({icon:u,label:r,value:x})=>I(u,r,x)).join(""),Nt=[Xt("projects.focus.summary.project","Ù…Ù„Ø®Øµ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹",ht),ot("projects.focus.summary.reservations","Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø©",At),ot("projects.focus.summary.payment","Ø§Ù„Ù…Ù„Ø®Øµ Ø§Ù„Ù…Ø§Ù„ÙŠ",Ct)].filter(Boolean).join(""),xt=a("projects.focus.confirmed","âœ… Ù…Ø´Ø±ÙˆØ¹ Ù…Ø¤ÙƒØ¯"),_t=a("projects.focus.pending","âŒ› Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„ØªØ£ÙƒÙŠØ¯"),Pt=`<div class="project-focus-card__actions"><span class="reservation-chip ${$?"status-confirmed":"status-pending"} project-focus-card__confirm-indicator">${m($?xt:_t)}</span></div>`,St=[ut,mt,dt,pt].filter(Boolean).join(`
          `);return`
    <div class="project-card-grid__item">
      <article class="${["project-focus-card",...k].join(" ")}" data-project-id="${d}">
        <div class="project-focus-card__accent"></div>
        <div class="project-focus-card__top">
          ${St}
        </div>
        <h6 class="project-focus-card__title">${m(yt)}</h6>
        <p class="project-focus-card__description">${ft}</p>
        <div class="project-focus-card__sections">
          ${Nt}
        </div>
        ${Pt}
      </article>
    </div>
  `}function I(t,n,e){const o=t?`<span class="project-focus-card__row-icon">${m(t)}</span>`:"",i=String(e??""),s=i.trim().startsWith("<")?i:m(i);return`
    <div class="project-focus-card__row">
      <span class="project-focus-card__row-label">${o}${m(n)}</span>
      <span class="project-focus-card__row-value">${s}</span>
    </div>
  `}function Xt(t,n,e=[]){if(!e.length)return"";const o=e.map(({icon:i,label:c,value:l})=>I(i,c,l)).join("");return`
    <div class="project-focus-card__section">
      <span class="project-focus-card__section-title">${m(a(t,n))}</span>
      <div class="project-focus-card__section-box">
        ${o}
      </div>
    </div>
  `}function ot(t,n,e){return e?`
    <div class="project-focus-card__section">
      <span class="project-focus-card__section-title">${m(a(t,n))}</span>
      <div class="project-focus-card__section-box">
        ${e}
      </div>
    </div>
  `:""}function Gt(t=[]){if(!t.length)return"";const n=t.slice(0,Vt),e=t.length-n.length,o=It()==="ar"?"ØŒ ":", ";let i=n.join(o);return e>0&&(i+=`${o}+${y(String(e))}`),i}function nt(t){const n=Number(t?.equipmentEstimate)||0,e=Lt(t),o=n+e,i=t?.applyTax===!0||t?.applyTax==="true",c=Number.parseFloat(t?.discount??t?.discountValue??0)||0;let s=(t?.discountType==="amount"?"amount":"percent")==="amount"?c:o*(c/100);(!Number.isFinite(s)||s<0)&&(s=0),s>o&&(s=o);const d=Math.max(0,o-s),f=t?.companyShareEnabled===!0||t?.companyShareEnabled==="true"||t?.company_share_enabled===!0||t?.company_share_enabled==="true",D=Number.parseFloat(t?.companySharePercent??t?.company_share_percent??t?.companyShare??t?.company_share??0)||0,g=i||f&&D>0,v=f&&g&&D>0?D:0,T=v>0?Number((d*(v/100)).toFixed(2)):0,p=d+T;let b=g?p*F:0;(!Number.isFinite(b)||b<0)&&(b=0),b=Number(b.toFixed(2));let h=g?Number(t?.totalWithTax):p;return g?(!Number.isFinite(h)||h<=0)&&(h=Number((p+b).toFixed(2))):h=p,{equipmentEstimate:n,expensesTotal:e,baseSubtotal:o,discountAmount:s,subtotalAfterDiscount:d,companyShareAmount:T,subtotal:p,applyTax:g,taxAmount:b,totalWithTax:h}}function it(t){if(!t)return 0;const n=Array.isArray(t?.items)?t.items:[],e=t?.discount??t?.discountValue??0,o=Number(y(String(e)))||0,i=t?.discountType??t?.discount_type??"percent",c=String(i).toLowerCase()==="amount"?"amount":"percent",l=Array.isArray(t?.crewAssignments)?t.crewAssignments:[],s=l.length?l:Array.isArray(t?.technicians)?t.technicians:[],d=ct({items:n,technicianIds:Array.isArray(s)&&!s.length?s:[],crewAssignments:Array.isArray(s)&&s.length&&typeof s[0]=="object"?s:[],discount:o,discountType:c,applyTax:!1,start:t?.start,end:t?.end,companySharePercent:0,groupingSource:t});return Number.isFinite(Number(d?.finalTotal))?Number(d.finalTotal):0}function Kt(t){if(!t)return a("projects.form.types.unknown","Ù†ÙˆØ¹ ØºÙŠØ± Ù…Ø­Ø¯Ø¯");const e={commercial:"projects.form.types.commercial",coverage:"projects.form.types.coverage",photography:"projects.form.types.photography",social:"projects.form.types.social"}[t]||"projects.form.types.unknown";return a(e,t)}function ie(t){if(!t)return null;const n=t.projectId??t.project_id??t.projectID??null;return n!=null?String(n):null}export{F as P,it as a,ne as b,ie as e,Jt as g,nt as r};
