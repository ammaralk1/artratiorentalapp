import{e as p}from"./calculations.BVcyzysX.js";import{p as f}from"./projects.gkU7_r6d.js";import"./reservationsService.BGgi72ed.js";import"./auth.Dym-pMl4.js";import"./state.D0_ft4YH.js";import"./dashboard.DgtQZpbL.js";import"./form.BoSw5-Ka.js";import"./projectsService.CtAJ7Bct.js";import"./constants.Cby_zQyZ.js";import"./customers.BzFjEKEv.js";import"./controller.B2xOwNwT.js";import"./details.BmsEvKGd.js";import"./equipment.CAaKsH40.js";import"./quotePdf.C2lQPEPC.js";import"./canvasColorUtils.C2cKNlRQ.js";import"./reservationsActions.DuW1PrtF.js";import"./uiBridge.BLZZT8b9.js";import"./dashboardShell.DF2kUed9.js";const s=new Map;function u(r){if(!r)return Promise.resolve(null);const e=String(r);if(s.has(e))return s.get(e);const n=new Promise(t=>{try{const o=new Image;o.crossOrigin="anonymous",o.referrerPolicy="no-referrer",o.onload=()=>t(o),o.onerror=()=>t(null),o.src=e}catch{t(null)}});return s.set(e,n),n}function g(r=[]){return Promise.all((r||[]).map(e=>u(e)))}async function y(){try{document.fonts&&document.fonts.ready&&await document.fonts.ready}catch{}}async function F(r){if(!r)throw new Error("No host");let e=null;try{e=await p()}catch{e=null}const n=document.createElement("div");Object.assign(n.style,{position:"fixed",top:"0",left:"-12000px",pointerEvents:"none",zIndex:"-1",backgroundColor:"#ffffff"});const t=document.createElement("div");t.id="templates-a4-root",t.setAttribute("data-render-context","export"),t.setAttribute("dir",r.getAttribute("dir")||document.documentElement.getAttribute("dir")||"rtl");const o=document.createElement("div");o.setAttribute("data-a4-pages","");const l=r.querySelector("[data-a4-pages]")?.cloneNode(!0)||r.cloneNode(!0);l.classList&&l.hasAttribute("data-a4-pages")?t.appendChild(l):(o.appendChild(l),t.appendChild(o)),n.appendChild(t),document.body.appendChild(n);try{try{const i=Array.from(t.querySelectorAll(".cs-logo img")).map(d=>d.getAttribute("src")).filter(Boolean);await g(i)}catch{}if(await y(),Array.from(t.querySelectorAll(".a4-page")).forEach(i=>{f(i)||i.parentElement?.removeChild(i)}),typeof e=="function"){await e().set({margin:0,html2canvas:{scale:2,useCORS:!0,allowTaint:!1,backgroundColor:"#ffffff"},jsPDF:{unit:"mm",format:"a4",orientation:"landscape"},pagebreak:{mode:["css","legacy"]},image:{type:"jpeg",quality:.98}}).from(t).save("template-callsheet.pdf");return}const m=`<!doctype html><html dir="${t.getAttribute("dir")||"rtl"}"><head><meta charset="utf-8"><title>Call Sheet</title><style>@page{size:A4 landscape;margin:0}html,body{margin:0;padding:0;background:#fff}#templates-a4-root{transform:none!important}</style></head><body>${t.innerHTML}</body></html>`,a=document.createElement("iframe");Object.assign(a.style,{position:"fixed",right:"0",bottom:"0",width:"1px",height:"1px",border:"0"}),document.body.appendChild(a);const c=a.contentWindow?.document;c&&(c.open(),c.write(m),c.close(),a.onload=()=>{try{a.contentWindow?.focus(),a.contentWindow?.print()}catch{}setTimeout(()=>a.remove(),1200)})}finally{try{n.remove()}catch{}}}export{F as printCallsheetFromHost};
