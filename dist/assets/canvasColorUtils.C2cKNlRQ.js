const b=/color\([^)]*\)/gi,h=/color-mix\([^)]*\)/gi,x=/oklab\([^)]*\)/gi,k=/oklch\([^)]*\)/gi,a=/(color\(|color-mix\(|oklab|oklch)/i,S=["color","backgroundColor","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","outlineColor","fill","stroke","boxShadow","textShadow","accentColor","caretColor","columnRuleColor"],m=typeof document<"u"?document.createElement("canvas"):null,d=m?.getContext?.("2d")||null;function C(o){return o.replace(/[A-Z]/g,r=>`-${r.toLowerCase()}`)}function g(o,r="#000"){if(!d||!o)return r;try{return d.fillStyle="#000",d.fillStyle=o,d.fillStyle||r}catch{return r}}function E(){const o=window.html2canvas;if(!o?.Color||o.Color.__artRatioPatched)return;const r=o.Color.fromString.bind(o.Color);o.Color.fromString=t=>{try{return r(t)}catch(e){if(typeof t=="string"&&a.test(t)){const n=g(t)||"#000";try{return r(n)}catch{return r("#000")}}throw e}},o.Color.__artRatioPatched=!0}function f(o,r,t){if(!o||!r?.style)return;const e=r.style.getPropertyValue(t),n=r.style.getPropertyPriority(t);o.push({element:r,prop:t,value:e,priority:n})}function P(o=[]){if(!(!Array.isArray(o)||!o.length))for(let r=o.length-1;r>=0;r-=1){const{element:t,prop:e,value:n,priority:l}=o[r]||{};!t?.style||!e||(n&&n.length>0?t.style.setProperty(e,n,l||""):t.style.removeProperty(e))}}function R(o,r=window,t=[]){if(!o||!r||typeof r.getComputedStyle!="function")return;const e=o.querySelectorAll?.("*");e&&e.forEach(n=>{const l=r.getComputedStyle(n);if(!l)return;S.forEach(c=>{const s=l[c];if(s&&a.test(s)){const i=C(c);if(f(t,n,i),c==="boxShadow"||c==="textShadow")n.style.setProperty(i,"none","important");else{const y=c==="backgroundColor"?"#ffffff":l.color||"#000000",p=g(s,y);n.style.setProperty(i,p,"important")}}});const u=l.backgroundImage;if(u&&a.test(u)){const c=g(l.backgroundColor||"#ffffff","#ffffff");f(t,n,"background-image"),f(t,n,"background-color"),n.style.setProperty("background-image","none","important"),n.style.setProperty("background-color",c,"important")}})}function w(o,r=window,t=[]){if(!o||!r||typeof r.getComputedStyle!="function")return;const e=o.querySelectorAll?.("*");e&&e.forEach(n=>{const l=r.getComputedStyle(n);if(!l)return;["color","backgroundColor","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","boxShadow","textShadow","accentColor","caretColor","columnRuleColor"].forEach(c=>{const s=l[c];if(s&&a.test(s)){const i=C(c);if(f(t,n,i),c==="boxShadow"||c==="textShadow")n.style.setProperty(i,"none","important");else{const y=c==="backgroundColor"?"#ffffff":"#000000";n.style.setProperty(i,y,"important")}}});const u=l.backgroundImage;u&&a.test(u)&&(f(t,n,"background-image"),f(t,n,"background-color"),n.style.setProperty("background-image","none","important"),n.style.setProperty("background-color","#ffffff","important"))})}function A(o){if(!o)return;const r=(t="")=>{if(typeof t!="string")return t;let e=t;return a.test(e)&&(e=e.replace(b,"#000").replace(h,"#000").replace(x,"#000").replace(k,"#000")),e};o.querySelectorAll?.("style")?.forEach?.(t=>{const e=t.textContent;typeof e=="string"&&a.test(e)&&(t.textContent=r(e))}),o.querySelectorAll?.("[style]")?.forEach?.(t=>{const e=t.getAttribute("style");typeof e=="string"&&a.test(e)&&t.setAttribute("style",r(e))})}function _(o){if(!o||!o.ownerDocument)return null;const r=o.ownerDocument,t=`export-sanitize-${Date.now()}-${Math.random().toString(36).slice(2)}`;o.setAttribute("data-export-root",t);const e=r.createElement("style");return e.setAttribute("data-export-style",t),e.textContent=`
    [data-export-root="${t}"] *,
    [data-export-root="${t}"] *::before,
    [data-export-root="${t}"] *::after {
      background-image: none !important;
    }
  `,r.head.appendChild(e),{id:t,style:e}}function O(o,r){if(!(!r||!o))try{o.removeAttribute("data-export-root"),r.style?.parentNode?.removeChild?.(r.style)}catch{}}export{R as a,O as b,w as e,_ as i,E as p,P as r,A as s};
