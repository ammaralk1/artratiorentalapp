import{w as Bs,e as _e,t as y,n as U,j as J,y as $s,f as je,k as ps,o as Fs,u as Hs}from"./auth-CXJ9BVF7.js";import{F as Ee,G as Jt,H as Ks,I as at,J as os,K as hs,L as Vs,M as Us,N as ct,O as Ue,P as fs,Q as Ys,R as vs,q as gs,S as bs,T as Ws,U as Gs,s as _t,i as ys,y as De,V as Es,W as zs,X as Xs,Y as Qs,d as rt,r as Be,c as _s,g as Ss,Z as Js,_ as Zs,t as en,C as tn,$ as sn,a0 as nn,a1 as rn,a2 as an,v as on,x as cn}from"./projectsService-D4pKr09t.js";Bs({ar:{"dashboard.header.greeting":"👋 أهلاً بك في لوحة التحكم","dashboard.header.toggleLabel":"لوحة التحكم","dashboard.sidebar.title":"مركز التحكم","dashboard.sidebar.statsHeading":"ملخص اليوم","dashboard.sidebar.tabsHeading":"التبويبات","dashboard.sidebar.quickLinksHeading":"روابط سريعة","dashboard.hero.title":"مركز إدارة التأجير","dashboard.actions.addProject":"➕ إضافة مشروع","dashboard.metrics.projects.label":"المشاريع","dashboard.metrics.projects.caption":"مشاريع نشطة هذا الشهر","dashboard.metrics.reservations.label":"الحجوزات","dashboard.metrics.reservations.caption":"متابعة جدول الفعاليات","dashboard.metrics.equipment.label":"المعدات","dashboard.metrics.equipment.caption":"الأصول المتاحة حالياً","dashboard.metrics.technicians.label":"طاقم العمل","dashboard.metrics.technicians.caption":"أعضاء جاهزون للتكليف","dashboard.quickLinks.home":"الصفحة الرئيسية","dashboard.quickLinks.projects":"إدارة المشاريع","dashboard.quickLinks.reports":"تقارير المشاريع","dashboard.quickLinks.users":"إدارة المستخدمين","tabs.customers":"👤 العملاء","tabs.equipment":"🎥 المعدات","tabs.maintenance":"🛠️ الصيانة","tabs.technicians":"😎 طاقم العمل","tabs.reservations":"📅 الحجوزات","actions.close":"إغلاق","actions.cancel":"إلغاء","actions.goHome":"🏠 الرئيسية","customers.section.title":"📋 إدارة العملاء","customers.form.title":"إضافة / تعديل عميل","customers.form.hint":"حدّث بيانات العميل وسيتم مزامنتها مع الحجوزات والفواتير.","customers.form.labels.name":"👤 الاسم","customers.form.labels.phone":"📞 الجوال","customers.form.labels.email":"📧 البريد","customers.form.labels.address":"📍 العنوان","customers.form.labels.company":"🏢 الشركة","customers.form.labels.notes":"📝 الملاحظات","customers.form.placeholders.name":"اسم العميل","customers.form.placeholders.phone":"05xxxxxxxx","customers.form.placeholders.email":"example@email.com","customers.form.placeholders.address":"عنوان العميل","customers.form.placeholders.company":"اسم الشركة","customers.form.placeholders.notes":"معلومات إضافية أو تذكيرات","customers.form.actions.cancel":"إلغاء التعديل","customers.form.actions.submit":"➕ إضافة عميل","customers.form.actions.update":"💾 حفظ التعديل","customers.search.placeholder":"🔍 ابحث عن عميل بالاسم أو الجوال أو الشركة...","customers.table.headers.name":"👤 الاسم","customers.table.headers.phone":"📞 الجوال","customers.table.headers.company":"🏢 الشركة","customers.table.headers.notes":"📝 ملاحظات","customers.table.headers.actions":"⚙️ الإجراءات","customers.table.loading":"جاري التحميل...","customers.table.empty":"لا يوجد عملاء","customers.table.noResults":"لا توجد نتائج مطابقة","customers.actions.edit":"✏️ تعديل","customers.actions.delete":"🗑️ حذف","customers.toast.updateSuccess":"تم تحديث بيانات العميل بنجاح","customers.toast.createSuccess":"تمت إضافة العميل بنجاح","customers.toast.missingFields":"يرجى تعبئة الاسم ورقم الهاتف","customers.toast.deleteConfirm":"⚠️ هل أنت متأكد من حذف هذا العميل؟","customers.toast.deleteSuccess":"تم حذف العميل","equipment.section.title":"🎥 إدارة المعدات","equipment.actions.clearAll":"🗑️ مسح الكل","equipment.actions.uploadExcel":"📤 رفع من Excel","equipment.form.title":"إضافة معدة","equipment.form.hint":"أدخل بيانات المعدة ليتم حفظها ضمن قائمة المعدات.","equipment.form.labels.description":"📝 الوصف","equipment.form.placeholders.description":"وصف المعدة","equipment.form.labels.barcode":"🏷️ الباركود","equipment.form.placeholders.barcode":"الباركود","equipment.form.labels.price":"💵 السعر","equipment.form.placeholders.price":"0","equipment.form.labels.quantity":"🔢 الكمية","equipment.form.placeholders.quantity":"1","equipment.form.labels.image":"🖼️ رابط الصورة","equipment.form.placeholders.image":"https://...","equipment.form.labels.category":"📂 القسم","equipment.form.placeholders.category":"القسم","equipment.form.labels.subcategory":"📑 القسم الثانوي","equipment.form.placeholders.subcategory":"القسم الثانوي","equipment.form.labels.status":"⚙️ الحالة","equipment.form.options.available":"✅ متاح","equipment.form.options.booked":"📌 محجوز","equipment.form.options.maintenance":"🛠️ صيانة","equipment.form.options.retired":"📦 خارج الخدمة","equipment.form.actions.submit":"➕ إضافة معدة","equipment.filters.search":"🔍 ابحث عن معدة...","equipment.filters.status.all":"⚙️ كل الحالات","equipment.filters.category.all":"📂 كل الأقسام","equipment.filters.subcategory.all":"📑 كل الأقسام الثانوية","equipment.list.title":"📋 كل المعدات","equipment.list.loading":"⏳ جاري تحميل المعدات...","equipment.list.empty":"لا توجد معدات مسجلة بعد.","equipment.card.labels.description":"الوصف","equipment.card.labels.status":"الحالة","equipment.card.labels.alias":"الاسم","equipment.card.labels.quantity":"الكمية","equipment.card.labels.price":"السعر","equipment.card.labels.category":"القسم","equipment.card.labels.subcategory":"القسم الثانوي","equipment.card.labels.barcode":"الباركود","equipment.modal.title":"✏️ تعديل بيانات المعدة","equipment.modal.placeholders.image":"ضع رابط مباشر للصورة","equipment.modal.actions.cancel":"❌ إلغاء","equipment.modal.actions.save":"💾 حفظ التعديلات","equipment.toast.xlsxMissing":"⚠️ مكتبة Excel (XLSX) غير محملة. تحقق من الروابط في dashboard.html","equipment.toast.uploadSuccess":"✅ تم رفع المعدات بنجاح","equipment.toast.uploadEmpty":"⚠️ الملف لا يحتوي على بيانات يمكن استيرادها","equipment.toast.uploadFailed":"❌ حدث خطأ أثناء قراءة ملف الإكسل","equipment.toast.clearConfirm":"⚠️ هل أنت متأكد من حذف كل المعدات؟","equipment.toast.clearSuccess":"🗑️ تم مسح جميع المعدات","equipment.toast.deleteConfirm":"❌ هل أنت متأكد من حذف هذه المعدة؟","equipment.toast.deleteSuccess":"🗑️ تم حذف المعدة","equipment.toast.editSuccess":"✏️ تم تعديل بيانات المعدة","equipment.toast.addSuccess":"✅ تم إضافة المعدة","equipment.toast.updateSuccess":"✅ تم تحديث بيانات المعدة بنجاح","equipment.toast.missingFields":"⚠️ يرجى إدخال الوصف والباركود","equipment.toast.duplicateBarcode":"⚠️ هذا الباركود مستخدم مسبقًا","equipment.list.emptyFiltered":"⚠️ لا توجد معدات مطابقة.","equipment.list.countSuffix":"عنصر","equipment.item.imageAlt":"صورة","equipment.item.currency":"ريال","equipment.item.actions.edit":"✏️ تعديل","equipment.item.actions.delete":"🗑️ حذف","reservations.tabs.create":"➕ إنشاء حجز","reservations.tabs.mine":"📋 حجوزاتي","reservations.tabs.reports":"📊 تقارير","reservations.tabs.calendar":"📅 التقويم","reservations.create.title":"➕ إنشاء حجز جديد","reservations.create.labels.startDate":"📅 تاريخ البداية","reservations.create.labels.startTime":"⏰ وقت البداية","reservations.create.labels.endDate":"📅 تاريخ النهاية","reservations.create.labels.endTime":"⏰ وقت النهاية","reservations.create.labels.client":"👤 العميل","reservations.create.placeholders.client":"اكتب اسم العميل...","reservations.create.labels.project":"📁 المشروع المرتبط","reservations.create.placeholders.project":"اختر مشروعاً (اختياري)","reservations.create.labels.notes":"📝 ملاحظات","reservations.create.placeholders.notes":"اكتب أي ملاحظات إضافية...","reservations.create.equipment.title":"🎥 أضف المعدات","reservations.create.equipment.placeholders.barcode":"🔍 امسح أو أدخل الباركود ثم اضغط Enter","reservations.create.equipment.placeholders.description":"🎥 اكتب اسم المعدة ثم اضغط Enter","reservations.create.equipment.table.code":"الكود","reservations.create.equipment.table.description":"الوصف","reservations.create.equipment.table.price":"السعر","reservations.create.equipment.table.image":"الصورة","reservations.create.equipment.table.delete":"حذف","reservations.create.billing.title":"💵 الخصم والضريبة","reservations.create.billing.discount":"ادخل قيمة الخصم","reservations.create.billing.discountPercent":"٪ نسبة","reservations.create.billing.discountAmount":"💵 مبلغ","reservations.create.billing.companyShare":"🏦 نسبة الشركة","reservations.create.billing.companyShareToggle":"إضافة نسبة الشركة (10٪)","reservations.create.billing.taxLabel":"شامل الضريبة (15٪)","reservations.create.labels.paymentStatus":"💳 حالة الدفع","reservations.create.paymentStatus.paid":"مدفوع","reservations.create.paymentStatus.unpaid":"لم يتم الدفع","reservations.create.actions.submit":"💾 إنشاء الحجز","reservations.section.title":"📅 إدارة الحجوزات","reservations.crew.none":"لم يتم اختيار أي عضو من الطاقم.","reservations.crew.noneShort":"لم يتم اختيار أي عضو بعد","reservations.crew.selectedCount":"تم اختيار {count} عضو","reservations.crew.fallbackName":"عضو الطاقم {id}","reservations.crew.removeAria":"إزالة","reservations.crew.searchEmpty":"لا يوجد نتائج مطابقة.","reservations.create.equipment.noResults":"لا يوجد نتائج مطابقة.","reservations.create.equipment.noneAdded":"لا توجد معدات مضافة","reservations.create.equipment.none":"لا توجد معدات","reservations.create.summary.currency":"ريال","reservations.create.equipment.imageAlt":"صورة","reservations.summary.total":"💰 التكلفة الإجمالية: <strong>{total} {currency}</strong>","reservations.summary.totalAfterEdit":"💰 التكلفة بعد التعديل: <strong>{total} {currency}</strong>","reservations.summary.itemsCount":"📦 عدد المعدات: {count}","reservations.summary.crewCount":"😎 عدد الفريق: {count}","reservations.summary.companyShareLabel":"🏦 نسبة الشركة","reservations.summary.taxIncluded":"شامل الضريبة 15%","reservations.summary.taxExcluded":"غير شامل الضريبة","reservations.summary.paymentLabel":"💳 حالة الدفع: {status}","reservations.summary.itemsLabel":"📦 عدد المعدات","reservations.summary.durationLabel":"⏱️ عدد الأيام","reservations.summary.crewLabel":"😎 عدد الفريق","reservations.summary.taxLabelShort":"🧾 الضريبة","reservations.summary.paymentLabelShort":"💳 حالة الدفع","reservations.summary.taxIncludedValue":"شامل 15%","reservations.summary.taxExcludedValue":"غير شامل","reservations.summary.totalLabel":"💰 التكلفة الإجمالية","reservations.toast.customerNotFound":"⚠️ لم يتم العثور على العميل بالاسم المدخل","reservations.toast.invalidDateOrder":"⚠️ تاريخ البداية لا يمكن أن يكون بعد تاريخ النهاية","reservations.toast.reservationMissing":"⚠️ تعذر العثور على الحجز المطلوب","reservations.list.title":"📋 حجوزاتي","reservations.list.search.placeholder":"🔍 ابحث باسم العميل أو الكود...","reservations.list.filters.start":"📅 من تاريخ","reservations.list.filters.end":"📅 إلى تاريخ","reservations.list.filters.range.all":"⏱️ كل التواريخ","reservations.list.filters.range.today":"📅 اليوم","reservations.list.filters.range.week":"📆 هذا الأسبوع","reservations.list.filters.range.month":"🗓️ هذا الشهر","reservations.list.filters.status.all":"⚙️ كل الحالات","reservations.list.filters.status.confirmed":"✅ مؤكدة","reservations.list.filters.status.pending":"⏳ غير مؤكدة","reservations.list.filters.status.completed":"📁 منتهية","reservations.list.empty":"⚠️ لا توجد حجوزات بعد.","reservations.list.noResults":"🔍 لا توجد حجوزات مطابقة للبحث.","reservations.list.taxIncludedShort":"(شامل الضريبة)","reservations.list.unknownCustomer":"غير معروف","reservations.list.noNotes":"لا توجد ملاحظات","reservations.list.project.unlinked":"غير مرتبط بمشروع","reservations.list.itemsCountShort":"{count} عنصر","reservations.list.crew.separator":"، ","reservations.list.status.confirmed":"✅ مؤكد","reservations.list.status.pending":"⏳ غير مؤكد","reservations.list.payment.paid":"💳 مدفوع","reservations.list.payment.unpaid":"💳 غير مدفوع","reservations.list.status.completed":"📁 منتهي","reservations.list.ribbon.completed":"منتهي","reservations.list.actions.confirm":"✔️ تأكيد","reservations.list.labels.client":"👤 العميل","reservations.list.labels.project":"📁 المشروع","reservations.edit.modalTitle":"✏️ تعديل الحجز","reservations.edit.labels.id":"🆔 رقم الحجز","reservations.edit.labels.customer":"👤 العميل","reservations.edit.labels.project":"📁 المشروع المرتبط","reservations.edit.labels.startDate":"📅 تاريخ البداية","reservations.edit.labels.startTime":"⏰ وقت البداية","reservations.edit.labels.endDate":"📅 تاريخ النهاية","reservations.edit.labels.endTime":"⏰ وقت النهاية","reservations.edit.labels.discount":"💵 الخصم","reservations.edit.placeholders.discount":"ادخل قيمة الخصم","reservations.edit.discount.percent":"٪ نسبة","reservations.edit.discount.amount":"💵 مبلغ","reservations.edit.labels.tax":"شامل الضريبة (15%)","reservations.edit.labels.confirmed":"✅ تم التأكيد","reservations.edit.labels.paymentStatus":"💳 حالة الدفع","reservations.edit.payment.paid":"مدفوع","reservations.edit.payment.unpaid":"لم يتم الدفع","reservations.edit.labels.notes":"📝 الملاحظات","reservations.edit.placeholders.notes":"اكتب أي ملاحظات...","reservations.edit.labels.addEquipment":"🎥 إضافة معدة","reservations.edit.project.missing":"⚠️ المشروع غير متوفر (تم حذفه)","reservations.edit.placeholders.barcode":"🔍 امسح أو أدخل الباركود ثم اضغط Enter","reservations.edit.placeholders.description":"🎥 اكتب اسم المعدة ثم اضغط Enter","reservations.edit.table.headers.code":"الكود","reservations.edit.table.headers.description":"الوصف","reservations.edit.table.headers.price":"السعر","reservations.edit.table.headers.quantity":"الكمية","reservations.edit.table.headers.image":"الصورة","reservations.edit.table.headers.delete":"حذف","reservations.edit.table.empty":"لا توجد معدات","reservations.edit.actions.save":"💾 حفظ التعديلات","reservations.list.labels.start":"🗓️ بداية الحجز","reservations.list.labels.end":"🗓️ نهاية الحجز","reservations.list.labels.cost":"💵 التكلفة","reservations.list.labels.equipment":"📦 المعدات","reservations.list.labels.crew":"😎 الفريق","reservations.details.labels.discount":"الخصم","reservations.details.labels.companyShare":"🏦 نسبة الشركة","reservations.details.labels.subtotalAfterDiscount":"الإجمالي","reservations.details.labels.tax":"الضريبة (15%)","reservations.details.labels.crewTotal":"إجمالي الفريق","reservations.details.table.headers.code":"الكود","reservations.details.table.headers.description":"الوصف","reservations.details.table.headers.quantity":"الكمية","reservations.details.table.headers.price":"السعر","reservations.details.table.headers.image":"الصورة","reservations.details.noItems":"📦 لا توجد معدات ضمن هذا الحجز حالياً.","reservations.details.noCrew":"😎 لا يوجد فريق مرتبط بهذا الحجز.","reservations.details.project.unlinked":"غير مرتبط بأي مشروع.","reservations.details.technicians.roleUnknown":"غير محدد","reservations.details.technicians.phoneUnknown":"غير متوفر","reservations.details.technicians.wage":"{amount} {currency} / اليوم","reservations.details.labels.id":"🆔 رقم الحجز","reservations.details.section.bookingInfo":"بيانات الحجز","reservations.details.section.statusSummary":"ملخص الحالة","reservations.details.section.paymentSummary":"💳 ملخص الدفع","reservations.details.labels.finalTotal":"المجموع النهائي","reservations.details.section.crew":"😎 الفريق الفني","reservations.details.crew.count":"{count} عضو","reservations.details.section.items":"📦 المعدات المرتبطة","reservations.details.items.count":"{count} عنصر","reservations.details.actions.edit":"✏️ تعديل","reservations.details.actions.delete":"🗑️ حذف","reservations.details.actions.openProject":"📁 فتح المشروع","reservations.details.labels.customer":"العميل","reservations.details.labels.contact":"رقم التواصل","reservations.details.labels.project":"📁 المشروع المرتبط","reservations.details.labels.start":"بداية الحجز","reservations.details.labels.end":"نهاية الحجز","reservations.details.labels.notes":"ملاحظات","reservations.details.labels.itemsCount":"عدد المعدات","reservations.details.labels.itemsTotal":"إجمالي المعدات","reservations.details.labels.paymentStatus":"حالة الدفع","reservations.details.modalTitle":"📋 تفاصيل الحجز","reservations.calendar.title":"📅 التقويم","reservations.reports.title":"📊 تقارير الأداء","reservations.reports.subtitle":"نظرة شاملة على الحجوزات والإيرادات ونسب الإشغال خلال الفترة المحددة.","reservations.reports.filters.rangeLabel":"الفترة","reservations.reports.filters.range.last30":"آخر 30 يوم","reservations.reports.filters.range.thisWeek":"هذا الأسبوع","reservations.reports.filters.range.thisMonth":"هذا الشهر","reservations.reports.filters.range.thisQuarter":"هذا الربع","reservations.reports.filters.range.thisYear":"هذا العام","reservations.reports.filters.range.all":"كل الوقت","reservations.reports.filters.range.custom":"مخصص","reservations.reports.filters.startLabel":"من","reservations.reports.filters.endLabel":"إلى","reservations.reports.filters.statusLabel":"الحالة","reservations.reports.filters.status.all":"كل الحالات","reservations.reports.filters.status.confirmed":"مؤكدة","reservations.reports.filters.status.pending":"قيد التأكيد","reservations.reports.filters.status.completed":"منتهية","reservations.reports.filters.paymentLabel":"الدفع","reservations.reports.filters.payment.all":"الكل","reservations.reports.filters.payment.paid":"مدفوعة","reservations.reports.filters.payment.unpaid":"غير مدفوعة","reservations.reports.filters.searchLabel":"البحث","reservations.reports.filters.searchPlaceholder":"ابحث باسم العميل، رقم الحجز، أو المعدة...","reservations.reports.actions.refresh":"🔄 تحديث","reservations.reports.kpi.total.label":"إجمالي الحجوزات","reservations.reports.kpi.total.meta":"لم يتم تسجيل بيانات بعد","reservations.reports.kpi.revenue.label":"إجمالي الإيرادات","reservations.reports.kpi.revenue.meta":"متوسط الحجز —","reservations.reports.kpi.confirmation.label":"معدل التأكيد","reservations.reports.kpi.confirmation.meta":"الحجوزات المؤكدة —","reservations.reports.kpi.paid.label":"نسبة المدفوع","reservations.reports.kpi.paid.meta":"الحجوزات المدفوعة —","reservations.reports.kpi.total.dynamicMeta":"منها {count} منتهية","reservations.reports.kpi.revenue.average":"متوسط قيمة الحجز {value}","reservations.reports.kpi.confirmed.detail":"{count} حجوزات مؤكدة","reservations.reports.kpi.paid.detail":"{count} حجوزات مدفوعة","reservations.reports.status.confirmedLabel":"مؤكدة","reservations.reports.status.pendingLabel":"قيد التأكيد","reservations.reports.status.completedLabel":"منتهية","reservations.reports.payment.paidLabel":"مدفوعة","reservations.reports.payment.unpaidLabel":"غير مدفوعة","reservations.reports.progress.empty":"لا توجد بيانات لعرضها.","reservations.reports.progress.meta":"{count} حجز","reservations.reports.chart.volume.title":"📈 تطور الحجوزات","reservations.reports.chart.volume.hint":"آخر 6 أشهر","reservations.reports.chart.status.title":"📊 توزيع الحالات والدفع","reservations.reports.chart.status.hint":"نسب مئوية","reservations.reports.chart.status.statusLabel":"الحالات","reservations.reports.chart.status.paymentLabel":"الدفع","reservations.reports.topCustomers.title":"👥 أفضل العملاء","reservations.reports.topCustomers.hint":"حسب إجمالي الإيراد","reservations.reports.topCustomers.headers.customer":"العميل","reservations.reports.topCustomers.headers.count":"عدد الحجوزات","reservations.reports.topCustomers.headers.revenue":"الإيراد الكلي","reservations.reports.topCustomers.unknown":"عميل غير معروف","reservations.reports.table.empty":"لا توجد بيانات","reservations.reports.table.emptyPeriod":"لا توجد بيانات في هذه الفترة.","reservations.reports.results.title":"📄 تفاصيل الحجوزات","reservations.reports.results.hint":"أحدث الحجوزات المطابقة لعوامل التصفية","reservations.reports.results.headers.id":"الحجز","reservations.reports.results.headers.customer":"العميل","reservations.reports.results.headers.date":"التاريخ","reservations.reports.results.headers.status":"الحالة","reservations.reports.results.headers.payment":"الدفع","reservations.reports.results.headers.total":"الإجمالي","reservations.reports.topEquipment.title":"🎥 المعدات الأكثر استخدامًا","reservations.reports.topEquipment.hint":"عدد مرات الحجز","reservations.reports.topEquipment.headers.item":"المعدة","reservations.reports.topEquipment.headers.usage":"عدد مرات الاستخدام","reservations.reports.topEquipment.headers.revenue":"الإيراد المرتبط","reservations.reports.topEquipment.unknown":"معدة بدون اسم","reservations.reports.empty.title":"لا توجد بيانات ضمن المعايير الحالية","reservations.reports.empty.subtitle":"جرّب تغيير الفترة الزمنية أو إزالة عوامل التصفية لعرض نتائج أخرى.","calendar.buttons.today":"اليوم","calendar.buttons.month":"شهر","calendar.buttons.week":"أسبوع","calendar.buttons.day":"يوم","calendar.badges.confirmed":"مؤكد","calendar.badges.pending":"غير مؤكد","calendar.badges.paid":"مدفوع","calendar.badges.unpaid":"غير مدفوع","calendar.badges.completed":"منتهي","calendar.labels.unknownCustomer":"غير معروف","calendar.labels.unknownEquipment":"معدة بدون اسم","calendar.labels.currencySuffix":"ريال","calendar.labels.noEquipment":"لا توجد معدات","calendar.labels.noNotes":"لا توجد ملاحظات","calendar.labels.reservationId":"رقم الحجز","calendar.labels.customer":"العميل","calendar.labels.start":"بداية الحجز","calendar.labels.end":"نهاية الحجز","calendar.labels.notes":"الملاحظات","calendar.sections.crew":"😎 الفريق الفني","calendar.sections.equipment":"📦 المعدات","calendar.emptyStates.noCrew":"😎 لا يوجد فريق مرتبط بهذا الحجز.","calendar.table.headers.barcode":"الباركود","calendar.table.headers.description":"الوصف","calendar.table.headers.quantity":"الكمية","calendar.table.headers.price":"السعر","calendar.table.headers.image":"الصورة","calendar.summary.baseCost":"💵 إجمالي المعدات: <strong>{value} ريال</strong>","calendar.summary.discount":"💸 الخصم: <strong>{value}</strong>","calendar.summary.tax":"🧾 الضريبة (15%): <strong>{value} ريال</strong>","calendar.summary.total":"💰 المجموع النهائي: <strong>{value} ريال</strong>","calendar.alerts.cannotShowDetails":"لا يمكن عرض تفاصيل الحجز","calendar.alerts.cannotOpenModal":"لا يمكن فتح نافذة التفاصيل","calendar.modal.title":"📅 تفاصيل الحجز","reservations.toast.equipmentNameNotFound":"❌ لم يتم العثور على معدة بالاسم المدخل","reservations.toast.equipmentMaintenance":"⚠️ هذه المعدة قيد الصيانة ولا يمكن إضافتها حالياً","reservations.toast.equipmentMissingBarcode":"⚠️ هذه المعدة لا تحتوي على باركود معرف","reservations.toast.requireDatesBeforeAdd":"⚠️ يرجى تحديد تاريخ ووقت البداية والنهاية قبل إضافة المعدات","reservations.toast.equipmentDuplicate":"⚠️ هذه المعدة موجودة بالفعل في الحجز","reservations.toast.equipmentTimeConflict":"⚠️ لا يمكن إضافة المعدة لأنها محجوزة في نفس الفترة الزمنية","reservations.toast.equipmentMaintenanceStrict":"⚠️ لا يمكن إضافة معدة قيد الصيانة إلى الحجز","reservations.toast.requireOverallDates":"⚠️ يرجى تحديد تواريخ الحجز قبل إضافة المعدات","reservations.toast.equipmentTimeConflictSimple":"⚠️ هذه المعدة محجوزة في نفس الفترة الزمنية","reservations.toast.barcodeNotFound":"❌ الباركود غير موجود","reservations.toast.equipmentAdded":"✅ تم إضافة المعدة بنجاح","reservations.toast.barcodeNotInCatalog":"❌ الباركود غير موجود ضمن المعدات","reservations.toast.requireDates":"⚠️ يرجى تحديد تاريخ البداية والنهاية","reservations.toast.invalidDateRange":"⚠️ تأكد من أن تاريخ ووقت البداية يسبق تاريخ ووقت النهاية","reservations.toast.missingFields":"⚠️ تأكد من تعبئة جميع الحقول","reservations.toast.noItems":"⚠️ يجب إضافة معدة أو عضو واحد من الطاقم الفني على الأقل","reservations.toast.cannotCreateEquipmentMaintenance":"⚠️ لا يمكن إتمام الحجز لأن إحدى المعدات قيد الصيانة","reservations.toast.cannotCreateEquipmentConflict":"⚠️ لا يمكن إتمام الحجز، إحدى المعدات محجوزة في نفس الفترة الزمنية","reservations.toast.cannotCreateCrewConflict":"⚠️ لا يمكن إتمام الحجز، أحد أعضاء الطاقم مرتبط بحجز آخر في نفس الفترة","reservations.toast.projectNotFound":"⚠️ لم يتم العثور على المشروع المحدد. يرجى تحديث الصفحة أو اختيار مشروع آخر.","reservations.toast.technicianSelectionConflict":"⚠️ لا يمكن اختيار {names} لأنهم مرتبطون بحجز آخر في نفس الفترة الزمنية","reservations.toast.created":"✅ تم إنشاء الحجز","reservations.toast.notFound":"⚠️ تعذر العثور على بيانات الحجز","reservations.toast.updateNoItems":"⚠️ يجب إضافة معدة أو عضو واحد من الطاقم الفني على الأقل للحجز","reservations.toast.updateEquipmentMaintenance":"⚠️ لا يمكن حفظ التعديلات لأن إحدى المعدات قيد الصيانة","reservations.toast.updateEquipmentConflict":"⚠️ لا يمكن حفظ التعديلات بسبب تعارض في أحد المعدات","reservations.toast.updateCrewConflict":"⚠️ لا يمكن حفظ التعديلات بسبب تعارض في جدول أحد أعضاء الطاقم","reservations.toast.updated":"✅ تم حفظ التعديلات على الحجز","reservations.toast.confirmed":"✅ تم تأكيد الحجز","reservations.toast.confirmBlockedByProject":"⚠️ حالة هذا الحجز تتحكم بها حالة المشروع المرتبط ولا يمكن تأكيده من هنا","reservations.toast.deleteConfirm":"⚠️ هل أنت متأكد من حذف هذا الحجز؟","maintenance.section.title":"🛠️ إدارة الصيانة","maintenance.form.title":"➕ إنشاء تذكرة صيانة","maintenance.form.hint":"حدد المعدة المتضررة وسجّل المشكلة لإيقافها عن الاستخدام لحين الإصلاح.","maintenance.form.labels.barcode":"🏷️ الباركود","maintenance.form.placeholders.barcode":"🖨️ امسح أو أدخل الباركود ثم اضغط Enter","maintenance.form.labels.search":"🎥 البحث باسم المعدة","maintenance.form.placeholders.search":"اكتب اسم المعدة...","maintenance.form.labels.priority":"⚠️ الأولوية","maintenance.form.options.priority.high":"مرتفعة","maintenance.form.options.priority.medium":"متوسطة","maintenance.form.options.priority.low":"منخفضة","maintenance.form.selectedInfo":"لم يتم اختيار معدة بعد.","maintenance.form.labels.issue":"📝 وصف المشكلة","maintenance.form.placeholders.issue":"اشرح المشكلة أو الأعراض الظاهرة للمعدة","maintenance.form.actions.submit":"🛠️ إنشاء التذكرة","maintenance.form.blockedSuffix":"(صيانة)","maintenance.list.title":"📋 تذاكر الصيانة","maintenance.list.hint":"تابع حالة الأعطال وقم بإغلاق التذاكر بعد إتمام الإصلاح.","maintenance.filters.status.label":"الحالة","maintenance.filters.status.all":"كل الحالات","maintenance.filters.status.open":"قيد الصيانة","maintenance.filters.status.closed":"مغلقة","maintenance.table.headers.equipment":"المعدة","maintenance.table.headers.issue":"وصف المشكلة","maintenance.table.headers.priority":"الأولوية","maintenance.table.headers.created":"تاريخ الإنشاء","maintenance.table.headers.status":"الحالة","maintenance.table.headers.actions":"الإجراءات","maintenance.table.empty":"لا توجد تذاكر بعد.","maintenance.table.emptyFiltered":"لا توجد تذاكر ضمن هذا الفلتر.","maintenance.table.noName":"بدون اسم","maintenance.empty.title":"لا توجد تذاكر صيانة","maintenance.empty.subtitle":"عند إنشاء تذكرة جديدة ستظهر في هذه القائمة.","maintenance.table.noBarcode":"بدون باركود","maintenance.stats.open":"{count} قيد الصيانة","maintenance.stats.closed":"{count} مغلقة","maintenance.stats.total":"{count} إجمالي التذاكر","maintenance.status.open":"قيد الصيانة","maintenance.status.closed":"مغلقة","maintenance.status.inProgress":"قيد التنفيذ","maintenance.status.completed":"مكتملة","maintenance.status.cancelled":"ملغاة","maintenance.priority.high":"مرتفعة","maintenance.priority.medium":"متوسطة","maintenance.priority.low":"منخفضة","maintenance.actions.close":"🔧 إغلاق بعد الإصلاح","maintenance.actions.view":"👁️ عرض التقرير","maintenance.actions.delete":"🗑️ حذف التذكرة","maintenance.closeModal.title":"🔧 إغلاق تذكرة الصيانة","maintenance.closeModal.subtitle":"يرجى كتابة تقرير الإصلاح قبل إغلاق هذه التذكرة.","maintenance.closeModal.reportLabel":"📝 تقرير الإصلاح","maintenance.closeModal.reportPlaceholder":"اكتب تفاصيل الإصلاح والإجراءات المتخذة...","maintenance.closeModal.confirm":"✅ إغلاق التذكرة","maintenance.closeModal.cancel":"إلغاء","maintenance.closeModal.saving":"⏳ جاري الإغلاق...","maintenance.toast.equipmentBlocked":"⚠️ هذه المعدة قيد الصيانة ولا يمكن اختيارها حالياً","maintenance.toast.equipmentNotFoundBarcode":"❌ لم يتم العثور على معدة بهذا الباركود","maintenance.toast.equipmentNotFoundName":"❌ لم يتم العثور على معدة بالاسم المدخل","maintenance.toast.equipmentBecameBlocked":"⚠️ هذه المعدة أصبحت قيد الصيانة ولا يمكن اختيارها","maintenance.toast.selectEquipment":"⚠️ يرجى اختيار المعدة","maintenance.toast.selectedNotFound":"❌ لم يتم العثور على المعدة المختارة","maintenance.toast.equipmentAlreadyMaintenance":"⚠️ هذه المعدة بالفعل في حالة صيانة","maintenance.toast.ticketExists":"⚠️ توجد تذكرة صيانة مفتوحة لهذه المعدة","maintenance.toast.ticketCreated":"🛠️ تم إنشاء تذكرة الصيانة وإيقاف المعدة","maintenance.toast.storageError":"⚠️ تعذر حفظ بيانات الصيانة. يرجى المحاولة مجدداً.","maintenance.toast.submitError":"⚠️ تعذر إنشاء تذكرة الصيانة. يرجى المحاولة مجدداً.","maintenance.toast.loading":"⏳ يتم تحديث بيانات الصيانة، يرجى الانتظار لحظة...","maintenance.toast.ticketAlreadyClosed":"✅ تم تحديث التذاكر، ويبدو أن هذه التذكرة مغلقة مسبقاً","maintenance.toast.ticketClosed":"✅ تم إغلاق تذكرة الصيانة وإعادة المعدة إلى الحالة المتاحة","maintenance.toast.ticketDeleted":"🗑️ تم حذف تذكرة الصيانة","maintenance.toast.ticketDeleteConfirm":"⚠️ هل أنت متأكد من حذف تذكرة الصيانة؟","maintenance.toast.reportRequired":"⚠️ يرجى كتابة تقرير الإصلاح قبل الإغلاق","maintenance.prompt.closeReport":"أدخل تقرير الإصلاح / الإجراءات المتخذة:","maintenance.report.equipment":"المعدة","maintenance.report.barcode":"الباركود","maintenance.report.issue":"الوصف","maintenance.report.createdAt":"تاريخ الإنشاء","maintenance.report.closedAt":"تاريخ الإغلاق","maintenance.report.summary":"التقرير","maintenance.report.notAvailable":"غير متوفر","maintenance.report.none":"—","maintenance.info.barcodeLabel":"باركود","technicians.section.title":"😎 إدارة طاقم العمل","technicians.form.title":"إضافة / تعديل عضو طاقم","technicians.form.hint":"أدخل بيانات عضو الطاقم ليتم حفظها وتحديثها في سجلات الحجز.","technicians.form.labels.name":"😎 اسم العضو","technicians.form.labels.phone":"📞 الجوال","technicians.form.labels.role":"👔 الوظيفة","technicians.form.labels.department":"🧩 القسم","technicians.form.labels.wage":"💰 الأجر اليومي","technicians.form.labels.status":"⚙️ الحالة الأساسية","technicians.form.labels.notes":"📝 ملاحظات","technicians.form.placeholders.name":"اسم عضو الطاقم","technicians.form.placeholders.phone":"05xxxxxxxx","technicians.form.placeholders.role":"مثال: مصور","technicians.form.placeholders.department":"مثال: قسم الصوت","technicians.form.placeholders.wage":"0","technicians.form.placeholders.notes":"معلومات إضافية","technicians.form.actions.cancel":"إلغاء التعديل","technicians.form.actions.submit":"➕ إضافة عضو طاقم","technicians.form.actions.update":"💾 حفظ التعديل","technicians.picker.selectedLabel":"😎 طاقم العمل المشارك","technicians.picker.openButton":"➕ اختيار الطاقم","technicians.picker.editButton":"🔁 تعديل الطاقم","technicians.picker.modalTitle":"😎 اختيار طاقم العمل","technicians.picker.actions.apply":"تم","technicians.form.options.available":"✅ متاح","technicians.form.options.busy":"⛔ مشغول","technicians.search.placeholder":"🔍 ابحث عن عضو الطاقم بالاسم أو الجوال أو الوظيفة...","technicians.search.filters.allRoles":"👔 كل الوظائف","technicians.table.empty":"لا يوجد أعضاء في الطاقم بعد.","technicians.table.loading":"جاري التحميل...","technicians.table.headers.name":"😎 اسم العضو","technicians.table.headers.phone":"📞 الجوال","technicians.table.headers.role":"👔 الوظيفة","technicians.table.headers.department":"🧩 القسم","technicians.table.headers.wage":"💰 الأجر اليومي","technicians.table.headers.status":"⚙️ الحالة","technicians.table.headers.notes":"📝 ملاحظات","technicians.table.headers.actions":"⚙️ الإجراءات","technicians.status.available":"✅ متاح","technicians.status.busy":"⛔ مشغول","technicians.table.wageSuffix":"ريال","technicians.actions.edit":"✏️ تعديل","technicians.actions.delete":"🗑️ حذف","technicians.toast.missingName":"⚠️ يرجى إدخال اسم عضو الطاقم","technicians.toast.missingPhone":"⚠️ يرجى إدخال رقم التواصل","technicians.toast.missingRole":"⚠️ يرجى إدخال الوظيفة","technicians.toast.invalidWage":"⚠️ أدخل قيمة صحيحة للأجر اليومي","technicians.toast.addSuccess":"✅ تم إضافة عضو الطاقم","technicians.toast.updateSuccess":"💾 تم حفظ بيانات عضو الطاقم","technicians.toast.notFound":"⚠️ تعذر العثور على عضو الطاقم المطلوب","technicians.toast.unidentified":"⚠️ تعذر تحديد عضو الطاقم المطلوب","technicians.toast.dataNotFound":"⚠️ تعذر العثور على بيانات عضو الطاقم","technicians.toast.editReady":"✏️ يمكنك تعديل بيانات عضو الطاقم الآن ثم الضغط على حفظ التعديل","technicians.toast.deleteConfirm":"⚠️ هل أنت متأكد من حذف هذا العضو؟","technicians.toast.deleteSuccess":"🗑️ تم حذف عضو الطاقم"},en:{"dashboard.header.greeting":"👋 Welcome to the Dashboard","dashboard.header.toggleLabel":"Dashboard","dashboard.sidebar.title":"Control Center","dashboard.sidebar.statsHeading":"Today at a Glance","dashboard.sidebar.tabsHeading":"Dashboard Tabs","dashboard.sidebar.quickLinksHeading":"Quick Links","dashboard.hero.title":"Art Ratio","dashboard.actions.addProject":"➕ Add Project","dashboard.metrics.projects.label":"Projects","dashboard.metrics.projects.caption":"Active projects this month","dashboard.metrics.reservations.label":"Reservations","dashboard.metrics.reservations.caption":"Keep track of upcoming events","dashboard.metrics.equipment.label":"Equipment","dashboard.metrics.equipment.caption":"Assets available right now","dashboard.metrics.technicians.label":"Crew Members","dashboard.metrics.technicians.caption":"Team ready for assignments","dashboard.quickLinks.home":"Home","dashboard.quickLinks.projects":"Projects workspace","dashboard.quickLinks.reports":"Project reports","dashboard.quickLinks.users":"User management","tabs.customers":"👤 Clients","tabs.equipment":"🎥 Equipment","tabs.maintenance":"🛠️ Maintenance","tabs.technicians":"😎 Crew","tabs.reservations":"📅 Reservations","actions.close":"Close","actions.cancel":"Cancel","actions.goHome":"🏠 Home","customers.section.title":"📋 Client Management","customers.form.title":"Add / Edit Client","customers.form.hint":"Update client details and they will sync with bookings and invoices.","customers.form.labels.name":"👤 Client","customers.form.labels.phone":"📞 Phone","customers.form.labels.email":"📧 Email","customers.form.labels.address":"📍 Address","customers.form.labels.company":"🏢 Company","customers.form.labels.notes":"📝 Notes","customers.form.placeholders.name":"Client name","customers.form.placeholders.phone":"05xxxxxxxx","customers.form.placeholders.email":"name@email.com","customers.form.placeholders.address":"Client address","customers.form.placeholders.company":"Company name","customers.form.placeholders.notes":"Additional info or reminders","customers.form.actions.cancel":"Cancel edit","customers.form.actions.submit":"➕ Add Client","customers.form.actions.update":"💾 Update Client","customers.search.placeholder":"🔍 Search by name, phone, or company...","customers.table.headers.name":"👤 Client","customers.table.headers.phone":"📞 Phone","customers.table.headers.company":"🏢 Company","customers.table.headers.notes":"📝 Notes","customers.table.headers.actions":"⚙️ Actions","customers.table.loading":"Loading...","customers.table.empty":"No clients found","customers.table.noResults":"No matching results","customers.actions.edit":"✏️ Edit","customers.actions.delete":"🗑️ Delete","customers.toast.updateSuccess":"Client updated successfully","customers.toast.createSuccess":"Client added successfully","customers.toast.missingFields":"Please fill in the name and phone number","customers.toast.deleteConfirm":"⚠️ Are you sure you want to delete this client?","customers.toast.deleteSuccess":"Client removed","equipment.section.title":"🎥 Equipment Management","equipment.actions.clearAll":"🗑️ Clear All","equipment.actions.uploadExcel":"📤 Import from Excel","equipment.form.title":"Add Equipment","equipment.form.hint":"Enter equipment details to store them in the catalog.","equipment.form.labels.description":"📝 Description","equipment.form.placeholders.description":"Equipment description","equipment.form.labels.barcode":"🏷️ Barcode","equipment.form.placeholders.barcode":"Barcode","equipment.form.labels.price":"💵 Price","equipment.form.placeholders.price":"0","equipment.form.labels.quantity":"🔢 Quantity","equipment.form.placeholders.quantity":"1","equipment.form.labels.image":"🖼️ Image URL","equipment.form.placeholders.image":"https://...","equipment.form.labels.category":"📂 Category","equipment.form.placeholders.category":"Category","equipment.form.labels.subcategory":"📑 Subcategory","equipment.form.placeholders.subcategory":"Subcategory","equipment.form.labels.status":"⚙️ Status","equipment.form.options.available":"✅ Available","equipment.form.options.booked":"📌 Booked","equipment.form.options.maintenance":"🛠️ Maintenance","equipment.form.options.retired":"📦 Retired","equipment.form.actions.submit":"➕ Add Equipment","equipment.filters.search":"🔍 Search equipment...","equipment.filters.status.all":"⚙️ All statuses","equipment.filters.category.all":"📂 All categories","equipment.filters.subcategory.all":"📑 All subcategories","equipment.list.title":"📋 All Equipment","equipment.list.loading":"⏳ Loading equipment...","equipment.list.empty":"No equipment has been added yet.","equipment.card.labels.description":"Description","equipment.card.labels.status":"Status","equipment.card.labels.alias":"Name","equipment.card.labels.quantity":"Quantity","equipment.card.labels.price":"Price","equipment.card.labels.category":"Category","equipment.card.labels.subcategory":"Subcategory","equipment.card.labels.barcode":"Barcode","equipment.modal.title":"✏️ Edit Equipment","equipment.modal.placeholders.image":"Paste a direct image link","equipment.modal.actions.cancel":"❌ Cancel","equipment.modal.actions.save":"💾 Save Changes","equipment.toast.xlsxMissing":"⚠️ Excel library (XLSX) is not loaded. Check dashboard.html links","equipment.toast.uploadSuccess":"✅ Equipment imported successfully","equipment.toast.uploadEmpty":"⚠️ The file did not contain any rows to import","equipment.toast.uploadFailed":"❌ Something went wrong while reading the Excel file","equipment.toast.clearConfirm":"⚠️ Are you sure you want to delete all equipment?","equipment.toast.clearSuccess":"🗑️ All equipment cleared","equipment.toast.deleteConfirm":"❌ Are you sure you want to delete this equipment item?","equipment.toast.deleteSuccess":"🗑️ Equipment item deleted","equipment.toast.editSuccess":"✏️ Equipment updated","equipment.toast.addSuccess":"✅ Equipment added","equipment.toast.updateSuccess":"✅ Equipment updated successfully","equipment.toast.missingFields":"⚠️ Please enter the description and barcode","equipment.toast.duplicateBarcode":"⚠️ This barcode is already in use","equipment.list.emptyFiltered":"⚠️ No matching equipment.","equipment.list.countSuffix":"item(s)","equipment.item.imageAlt":"Image","equipment.item.currency":"SAR","equipment.item.actions.edit":"✏️ Edit","equipment.item.actions.delete":"🗑️ Delete","reservations.tabs.create":"➕ Create Reservation","reservations.tabs.mine":"📋 My Reservations","reservations.tabs.reports":"📊 Reports","reservations.tabs.calendar":"📅 Calendar","reservations.create.title":"➕ Create New Reservation","reservations.create.labels.startDate":"📅 Start date","reservations.create.labels.startTime":"⏰ Start time","reservations.create.labels.endDate":"📅 End date","reservations.create.labels.endTime":"⏰ End time","reservations.create.labels.client":"👤 Client","reservations.create.placeholders.client":"Type client name...","reservations.create.labels.project":"📁 Linked project","reservations.create.placeholders.project":"Select a project (optional)","reservations.create.labels.notes":"📝 Notes","reservations.create.placeholders.notes":"Add any additional notes...","reservations.create.equipment.title":"🎥 Add Equipment","reservations.create.equipment.placeholders.barcode":"🔍 Scan or enter a barcode then press Enter","reservations.create.equipment.placeholders.description":"🎥 Type the equipment name then press Enter","reservations.create.equipment.table.code":"Code","reservations.create.equipment.table.description":"Description","reservations.create.equipment.table.price":"Price","reservations.create.equipment.table.image":"Image","reservations.create.equipment.table.delete":"Delete","reservations.create.billing.title":"💵 Discount & Tax","reservations.create.billing.discount":"Enter discount value","reservations.create.billing.discountPercent":"% Percent","reservations.create.billing.discountAmount":"💵 Amount","reservations.create.billing.companyShare":"🏦 Company share","reservations.create.billing.companyShareToggle":"Include company share (10%)","reservations.create.billing.taxLabel":"Include VAT (15%)","reservations.create.labels.paymentStatus":"💳 Payment status","reservations.create.paymentStatus.paid":"Paid","reservations.create.paymentStatus.unpaid":"Unpaid","reservations.create.actions.submit":"💾 Create reservation","reservations.section.title":"📅 Reservation Management","reservations.crew.none":"No crew members selected yet.","reservations.crew.noneShort":"No crew members selected","reservations.crew.selectedCount":"{count} crew member(s) selected","reservations.crew.fallbackName":"Crew member {id}","reservations.crew.removeAria":"Remove","reservations.crew.searchEmpty":"No matching results.","reservations.create.equipment.noResults":"No matching equipment.","reservations.create.equipment.noneAdded":"No equipment added","reservations.create.equipment.none":"No equipment","reservations.create.summary.currency":"SAR","reservations.create.equipment.imageAlt":"Image","reservations.summary.total":"💰 Total cost: <strong>{total} {currency}</strong>","reservations.summary.totalAfterEdit":"💰 Updated total: <strong>{total} {currency}</strong>","reservations.summary.itemsCount":"📦 Items: {count}","reservations.summary.crewCount":"😎 Crew members: {count}","reservations.summary.companyShareLabel":"🏦 Company share","reservations.summary.taxIncluded":"Includes 15% VAT","reservations.summary.taxExcluded":"VAT not included","reservations.summary.paymentLabel":"💳 Payment status: {status}","reservations.summary.itemsLabel":"📦 Items","reservations.summary.durationLabel":"⏱️ Days","reservations.summary.crewLabel":"😎 Crew","reservations.summary.taxLabelShort":"🧾 VAT","reservations.summary.paymentLabelShort":"💳 Payment status","reservations.summary.taxIncludedValue":"Includes 15%","reservations.summary.taxExcludedValue":"Not included","reservations.summary.totalLabel":"💰 Total cost","reservations.toast.customerNotFound":"⚠️ Customer not found for the entered name","reservations.toast.invalidDateOrder":"⚠️ Start date cannot be after the end date","reservations.toast.reservationMissing":"⚠️ Unable to locate the selected reservation","reservations.list.title":"📋 My Reservations","reservations.list.search.placeholder":"🔍 Search by client name or code...","reservations.list.filters.start":"📅 From date","reservations.list.filters.end":"📅 To date","reservations.list.filters.range.all":"⏱️ All dates","reservations.list.filters.range.today":"📅 Today","reservations.list.filters.range.week":"📆 This week","reservations.list.filters.range.month":"🗓️ This month","reservations.list.filters.status.all":"⚙️ All statuses","reservations.list.filters.status.confirmed":"✅ Confirmed","reservations.list.filters.status.pending":"⏳ Pending","reservations.list.filters.status.completed":"📁 Completed","reservations.list.empty":"⚠️ No reservations yet.","reservations.list.noResults":"🔍 No reservations match the search.","reservations.list.taxIncludedShort":"(Tax included)","reservations.list.unknownCustomer":"Unknown","reservations.list.noNotes":"No notes","reservations.list.project.unlinked":"Not linked to a project","reservations.list.itemsCountShort":"{count} item(s)","reservations.list.crew.separator":", ","reservations.list.status.confirmed":"✅ Confirmed","reservations.list.status.pending":"⏳ Pending","reservations.list.payment.paid":"💳 Paid","reservations.list.payment.unpaid":"💳 Unpaid","reservations.list.status.completed":"📁 Completed","reservations.list.ribbon.completed":"Completed","reservations.list.actions.confirm":"✔️ Confirm","reservations.list.labels.client":"👤 Client","reservations.list.labels.project":"📁 Project","reservations.edit.modalTitle":"✏️ Edit Reservation","reservations.edit.labels.id":"🆔 Reservation ID","reservations.edit.labels.customer":"👤 Customer","reservations.edit.labels.project":"📁 Linked project","reservations.edit.labels.startDate":"📅 Start date","reservations.edit.labels.startTime":"⏰ Start time","reservations.edit.labels.endDate":"📅 End date","reservations.edit.labels.endTime":"⏰ End time","reservations.edit.labels.discount":"💵 Discount","reservations.edit.placeholders.discount":"Enter discount value","reservations.edit.discount.percent":"% Percent","reservations.edit.discount.amount":"💵 Amount","reservations.edit.labels.tax":"Include VAT (15%)","reservations.edit.labels.confirmed":"✅ Confirmed","reservations.edit.labels.paymentStatus":"💳 Payment status","reservations.edit.payment.paid":"Paid","reservations.edit.payment.unpaid":"Unpaid","reservations.edit.labels.notes":"📝 Notes","reservations.edit.placeholders.notes":"Add any notes...","reservations.edit.labels.addEquipment":"🎥 Add equipment","reservations.edit.project.missing":"⚠️ Project unavailable (deleted)","reservations.edit.placeholders.barcode":"🔍 Scan or enter a barcode then press Enter","reservations.edit.placeholders.description":"🎥 Type the equipment name then press Enter","reservations.edit.table.headers.code":"Code","reservations.edit.table.headers.description":"Description","reservations.edit.table.headers.price":"Price","reservations.edit.table.headers.quantity":"Qty","reservations.edit.table.headers.image":"Image","reservations.edit.table.headers.delete":"Delete","reservations.edit.table.empty":"No equipment","reservations.edit.actions.save":"💾 Save changes","reservations.list.labels.start":"🗓️ Start","reservations.list.labels.end":"🗓️ End","reservations.list.labels.cost":"💵 Cost","reservations.list.labels.equipment":"📦 Equipment","reservations.list.labels.crew":"😎 Crew","reservations.details.labels.discount":"Discount","reservations.details.labels.companyShare":"🏦 Company share","reservations.details.labels.subtotalAfterDiscount":"Subtotal","reservations.details.labels.tax":"Tax (15%)","reservations.details.labels.crewTotal":"Crew total","reservations.details.table.headers.code":"Code","reservations.details.table.headers.description":"Description","reservations.details.table.headers.quantity":"Qty","reservations.details.table.headers.price":"Price","reservations.details.table.headers.image":"Image","reservations.details.noItems":"📦 No equipment is linked to this reservation yet.","reservations.details.noCrew":"😎 No crew assigned to this reservation.","reservations.details.project.unlinked":"Not linked to any project.","reservations.details.technicians.roleUnknown":"Not specified","reservations.details.technicians.phoneUnknown":"Not available","reservations.details.technicians.wage":"{amount} {currency} / day","reservations.details.labels.id":"🆔 Reservation ID","reservations.details.section.bookingInfo":"Booking details","reservations.details.section.statusSummary":"Status summary","reservations.details.section.paymentSummary":"💳 Payment summary","reservations.details.labels.finalTotal":"Final total","reservations.details.section.crew":"😎 Crew members","reservations.details.crew.count":"{count} member(s)","reservations.details.section.items":"📦 Linked equipment","reservations.details.items.count":"{count} item(s)","reservations.details.actions.edit":"✏️ Edit","reservations.details.actions.delete":"🗑️ Delete","reservations.details.actions.openProject":"📁 Open project","reservations.details.labels.customer":"Customer","reservations.details.labels.contact":"Contact","reservations.details.labels.start":"Start","reservations.details.labels.end":"End","reservations.details.labels.notes":"Notes","reservations.details.labels.itemsCount":"Equipment count","reservations.details.labels.itemsTotal":"Equipment total","reservations.details.labels.paymentStatus":"Payment status","reservations.details.modalTitle":"📋 Reservation Details","reservations.calendar.title":"📅 Calendar","reservations.reports.title":"📊 Performance Reports","reservations.reports.subtitle":"A holistic view of reservations, revenue, and utilization for the selected period.","reservations.reports.filters.rangeLabel":"Period","reservations.reports.filters.range.last30":"Last 30 days","reservations.reports.filters.range.thisWeek":"This week","reservations.reports.filters.range.thisMonth":"This month","reservations.reports.filters.range.thisQuarter":"This quarter","reservations.reports.filters.range.thisYear":"This year","reservations.reports.filters.range.all":"All time","reservations.reports.filters.range.custom":"Custom","reservations.reports.filters.startLabel":"From","reservations.reports.filters.endLabel":"To","reservations.reports.filters.statusLabel":"Status","reservations.reports.filters.status.all":"All statuses","reservations.reports.filters.status.confirmed":"Confirmed","reservations.reports.filters.status.pending":"Pending confirmation","reservations.reports.filters.status.completed":"Completed","reservations.reports.filters.paymentLabel":"Payment","reservations.reports.filters.payment.all":"All","reservations.reports.filters.payment.paid":"Paid","reservations.reports.filters.payment.unpaid":"Unpaid","reservations.reports.filters.searchLabel":"Search","reservations.reports.filters.searchPlaceholder":"Search by customer, reservation number, or equipment...","reservations.reports.actions.refresh":"🔄 Refresh","reservations.reports.kpi.total.label":"Total reservations","reservations.reports.kpi.total.meta":"No data recorded yet","reservations.reports.kpi.revenue.label":"Total revenue","reservations.reports.kpi.revenue.meta":"Average reservation —","reservations.reports.kpi.confirmation.label":"Confirmation rate","reservations.reports.kpi.confirmation.meta":"Confirmed reservations —","reservations.reports.kpi.paid.label":"Paid ratio","reservations.reports.kpi.paid.meta":"Paid reservations —","reservations.reports.kpi.total.dynamicMeta":"Includes {count} completed","reservations.reports.kpi.revenue.average":"Average reservation value {value}","reservations.reports.kpi.confirmed.detail":"{count} confirmed reservations","reservations.reports.kpi.paid.detail":"{count} paid reservations","reservations.reports.status.confirmedLabel":"Confirmed","reservations.reports.status.pendingLabel":"Pending confirmation","reservations.reports.status.completedLabel":"Completed","reservations.reports.payment.paidLabel":"Paid","reservations.reports.payment.unpaidLabel":"Unpaid","reservations.reports.progress.empty":"No data to display.","reservations.reports.progress.meta":"{count} reservations","reservations.reports.chart.volume.title":"📈 Reservation trend","reservations.reports.chart.volume.hint":"Last 6 months","reservations.reports.chart.status.title":"📊 Status & payment breakdown","reservations.reports.chart.status.hint":"Percentages","reservations.reports.chart.status.statusLabel":"Status","reservations.reports.chart.status.paymentLabel":"Payment","reservations.reports.topCustomers.title":"👥 Top customers","reservations.reports.topCustomers.hint":"By total revenue","reservations.reports.topCustomers.headers.customer":"Customer","reservations.reports.topCustomers.headers.count":"Reservations","reservations.reports.topCustomers.headers.revenue":"Total revenue","reservations.reports.topCustomers.unknown":"Unknown customer","reservations.reports.table.empty":"No data available","reservations.reports.table.emptyPeriod":"No data for this period.","reservations.reports.results.title":"📄 Reservation Details","reservations.reports.results.hint":"Latest reservations matching the current filters","reservations.reports.results.headers.id":"Reservation","reservations.reports.results.headers.customer":"Customer","reservations.reports.results.headers.date":"Date","reservations.reports.results.headers.status":"Status","reservations.reports.results.headers.payment":"Payment","reservations.reports.results.headers.total":"Total","reservations.reports.topEquipment.title":"🎥 Most used equipment","reservations.reports.topEquipment.hint":"Total bookings","reservations.reports.topEquipment.headers.item":"Equipment","reservations.reports.topEquipment.headers.usage":"Usage count","reservations.reports.topEquipment.headers.revenue":"Linked revenue","reservations.reports.topEquipment.unknown":"Unnamed equipment","reservations.reports.empty.title":"No data matches the current filters","reservations.reports.empty.subtitle":"Try adjusting the date range or removing filters to see more results.","calendar.buttons.today":"Today","calendar.buttons.month":"Month","calendar.buttons.week":"Week","calendar.buttons.day":"Day","calendar.badges.confirmed":"Confirmed","calendar.badges.pending":"Pending","calendar.badges.paid":"Paid","calendar.badges.unpaid":"Unpaid","calendar.badges.completed":"Completed","calendar.labels.unknownCustomer":"Unknown","calendar.labels.unknownEquipment":"Unnamed equipment","calendar.labels.currencySuffix":"SAR","calendar.labels.noEquipment":"No equipment","calendar.labels.noNotes":"No notes","calendar.labels.reservationId":"Reservation ID","calendar.labels.customer":"Customer","calendar.labels.start":"Start","calendar.labels.end":"End","calendar.labels.notes":"Notes","calendar.sections.crew":"😎 Crew members","calendar.sections.equipment":"📦 Equipment","calendar.emptyStates.noCrew":"😎 No crew assigned to this reservation.","calendar.table.headers.barcode":"Barcode","calendar.table.headers.description":"Description","calendar.table.headers.quantity":"Qty","calendar.table.headers.price":"Price","calendar.table.headers.image":"Image","calendar.summary.baseCost":"💵 Equipment subtotal: <strong>{value} SAR</strong>","calendar.summary.discount":"💸 Discount: <strong>{value}</strong>","calendar.summary.tax":"🧾 Tax (15%): <strong>{value} SAR</strong>","calendar.summary.total":"💰 Grand total: <strong>{value} SAR</strong>","calendar.alerts.cannotShowDetails":"Unable to show reservation details","calendar.alerts.cannotOpenModal":"Unable to open details modal","calendar.modal.title":"📅 Reservation Details","reservations.toast.equipmentNameNotFound":"❌ No equipment found with that name","reservations.toast.equipmentMaintenance":"⚠️ This equipment is under maintenance and cannot be added","reservations.toast.equipmentMissingBarcode":"⚠️ This equipment has no barcode assigned","reservations.toast.requireDatesBeforeAdd":"⚠️ Set start and end date/time before adding equipment","reservations.toast.equipmentDuplicate":"⚠️ This equipment is already in the reservation","reservations.toast.equipmentTimeConflict":"⚠️ Cannot add equipment because it is booked in the same period","reservations.toast.equipmentMaintenanceStrict":"⚠️ Cannot add equipment while it is marked for maintenance","reservations.toast.requireOverallDates":"⚠️ Set the reservation dates before adding equipment","reservations.toast.equipmentTimeConflictSimple":"⚠️ This equipment is booked in the same period","reservations.toast.barcodeNotFound":"❌ Barcode not found","reservations.toast.equipmentAdded":"✅ Equipment added successfully","reservations.toast.barcodeNotInCatalog":"❌ Barcode not found in catalog","reservations.toast.requireDates":"⚠️ Please set start and end date","reservations.toast.invalidDateRange":"⚠️ Make sure start time is before end time","reservations.toast.missingFields":"⚠️ Please fill in all required fields","reservations.toast.noItems":"⚠️ Add at least one equipment item or crew member to the reservation","reservations.toast.cannotCreateEquipmentMaintenance":"⚠️ Cannot create reservation because an item is under maintenance","reservations.toast.cannotCreateEquipmentConflict":"⚠️ Cannot create reservation because an item is already booked","reservations.toast.cannotCreateCrewConflict":"⚠️ Cannot create reservation because a crew member has another booking in that period","reservations.toast.projectNotFound":"⚠️ Selected project was not found. Please refresh the page or choose another project.","reservations.toast.technicianSelectionConflict":"⚠️ Cannot select {names}; they are already booked for the selected time range","reservations.toast.created":"✅ Reservation created","reservations.toast.notFound":"⚠️ Unable to locate reservation data","reservations.toast.updateNoItems":"⚠️ Add at least one equipment item or crew member before saving","reservations.toast.updateEquipmentMaintenance":"⚠️ Cannot save changes because an item is under maintenance","reservations.toast.updateEquipmentConflict":"⚠️ Cannot save changes because an item conflicts with another booking","reservations.toast.updateCrewConflict":"⚠️ Cannot save changes because a crew member conflicts with another booking","reservations.toast.updated":"✅ Reservation updated","reservations.toast.confirmed":"✅ Reservation confirmed","reservations.toast.confirmBlockedByProject":"⚠️ This reservation is controlled by its linked project and cannot be confirmed here","reservations.toast.deleteConfirm":"⚠️ Are you sure you want to delete this reservation?","maintenance.section.title":"🛠️ Maintenance Management","maintenance.form.title":"➕ Create Maintenance Ticket","maintenance.form.hint":"Select the affected equipment and describe the issue to take it out of service.","maintenance.form.labels.barcode":"🏷️ Barcode","maintenance.form.placeholders.barcode":"🖨️ Scan or enter the barcode, then press Enter","maintenance.form.labels.search":"🎥 Search by equipment name","maintenance.form.placeholders.search":"Type the equipment name...","maintenance.form.labels.priority":"⚠️ Priority","maintenance.form.options.priority.high":"High","maintenance.form.options.priority.medium":"Medium","maintenance.form.options.priority.low":"Low","maintenance.form.selectedInfo":"No equipment selected yet.","maintenance.form.labels.issue":"📝 Issue description","maintenance.form.placeholders.issue":"Describe the issue or symptoms for the equipment","maintenance.form.actions.submit":"🛠️ Create Ticket","maintenance.form.blockedSuffix":"(In maintenance)","maintenance.list.title":"📋 Maintenance Tickets","maintenance.list.hint":"Track issues and close tickets once repairs are completed.","maintenance.filters.status.label":"Status","maintenance.filters.status.all":"All statuses","maintenance.filters.status.open":"In maintenance","maintenance.filters.status.closed":"Closed","maintenance.table.headers.equipment":"Equipment","maintenance.table.headers.issue":"Issue","maintenance.table.headers.priority":"Priority","maintenance.table.headers.created":"Created At","maintenance.table.headers.status":"Status","maintenance.table.headers.actions":"Actions","maintenance.table.empty":"No tickets yet.","maintenance.table.emptyFiltered":"No tickets match this filter.","maintenance.table.noName":"No name","maintenance.empty.title":"No maintenance tickets","maintenance.empty.subtitle":"Once you create a new ticket it will appear here.","maintenance.table.noBarcode":"No barcode","maintenance.stats.open":"{count} in maintenance","maintenance.stats.closed":"{count} closed","maintenance.stats.total":"{count} total tickets","maintenance.status.open":"In maintenance","maintenance.status.closed":"Closed","maintenance.status.inProgress":"In progress","maintenance.status.completed":"Completed","maintenance.status.cancelled":"Cancelled","maintenance.priority.high":"High","maintenance.priority.medium":"Medium","maintenance.priority.low":"Low","maintenance.actions.close":"🔧 Close after repair","maintenance.actions.view":"👁️ View report","maintenance.actions.delete":"🗑️ Delete ticket","maintenance.closeModal.title":"🔧 Close maintenance ticket","maintenance.closeModal.subtitle":"Please add a repair report before closing this ticket.","maintenance.closeModal.reportLabel":"📝 Repair report","maintenance.closeModal.reportPlaceholder":"Describe the repair work and actions taken...","maintenance.closeModal.confirm":"✅ Close ticket","maintenance.closeModal.cancel":"Cancel","maintenance.closeModal.saving":"⏳ Closing...","maintenance.toast.equipmentBlocked":"⚠️ This equipment is already under maintenance and can’t be selected","maintenance.toast.equipmentNotFoundBarcode":"❌ No equipment found with this barcode","maintenance.toast.equipmentNotFoundName":"❌ No equipment found with that name","maintenance.toast.equipmentBecameBlocked":"⚠️ This equipment is now under maintenance and can’t be selected","maintenance.toast.selectEquipment":"⚠️ Please select equipment","maintenance.toast.selectedNotFound":"❌ Selected equipment was not found","maintenance.toast.equipmentAlreadyMaintenance":"⚠️ This equipment is already marked as in maintenance","maintenance.toast.ticketExists":"⚠️ There is already an open maintenance ticket for this equipment","maintenance.toast.ticketCreated":"🛠️ Maintenance ticket created and equipment removed from service","maintenance.toast.storageError":"⚠️ Could not save maintenance data. Please try again.","maintenance.toast.submitError":"⚠️ Could not create the maintenance ticket. Please try again.","maintenance.toast.loading":"⏳ Maintenance data is refreshing, please wait a moment...","maintenance.toast.ticketAlreadyClosed":"✅ Tickets refreshed; this maintenance item appears to be already closed.","maintenance.toast.reportRequired":"⚠️ Please write the repair report before closing the ticket","maintenance.toast.ticketClosed":"✅ Maintenance ticket closed and equipment set to available","maintenance.toast.ticketDeleted":"🗑️ Maintenance ticket deleted","maintenance.toast.ticketDeleteConfirm":"⚠️ Are you sure you want to delete this maintenance ticket?","maintenance.prompt.closeReport":"Enter repair report / actions taken:","maintenance.report.equipment":"Equipment","maintenance.report.barcode":"Barcode","maintenance.report.issue":"Issue","maintenance.report.createdAt":"Created at","maintenance.report.closedAt":"Closed at","maintenance.report.summary":"Report","maintenance.report.notAvailable":"Not available","maintenance.report.none":"—","maintenance.info.barcodeLabel":"Barcode","technicians.section.title":"😎 Crew Management","technicians.form.title":"Add / Edit Crew Member","technicians.form.hint":"Enter crew member details to save and keep bookings updated.","technicians.form.labels.name":"😎 Crew Member","technicians.form.labels.phone":"📞 Phone","technicians.form.labels.role":"👔 Role","technicians.form.labels.department":"🧩 Department","technicians.form.labels.wage":"💰 Daily Rate","technicians.form.labels.status":"⚙️ Base Status","technicians.form.labels.notes":"📝 Notes","technicians.form.placeholders.name":"Crew member name","technicians.form.placeholders.phone":"05xxxxxxxx","technicians.form.placeholders.role":"e.g. Camera operator","technicians.form.placeholders.department":"e.g. Audio team","technicians.form.placeholders.wage":"0","technicians.form.placeholders.notes":"Additional information","technicians.form.actions.cancel":"Cancel edit","technicians.form.actions.submit":"➕ Add Crew Member","technicians.form.actions.update":"💾 Update Crew Member","technicians.picker.selectedLabel":"😎 Assigned crew","technicians.picker.openButton":"➕ Choose crew","technicians.picker.editButton":"🔁 Edit crew","technicians.picker.modalTitle":"😎 Select crew","technicians.picker.actions.apply":"Done","technicians.form.options.available":"✅ Available","technicians.form.options.busy":"⛔ Busy","technicians.search.placeholder":"🔍 Search crew member by name, phone, or role...","technicians.search.filters.allRoles":"👔 All roles","technicians.table.empty":"No crew members yet.","technicians.table.loading":"Loading...","technicians.table.headers.name":"😎 Crew Member","technicians.table.headers.phone":"📞 Phone","technicians.table.headers.role":"👔 Role","technicians.table.headers.department":"🧩 Department","technicians.table.headers.wage":"💰 Daily Rate","technicians.table.headers.status":"⚙️ Status","technicians.table.headers.notes":"📝 Notes","technicians.table.headers.actions":"⚙️ Actions","technicians.status.available":"✅ Available","technicians.status.busy":"⛔ Busy","technicians.table.wageSuffix":"SAR","technicians.actions.edit":"✏️ Edit","technicians.actions.delete":"🗑️ Delete","technicians.toast.missingName":"⚠️ Please enter the crew member name","technicians.toast.missingPhone":"⚠️ Please enter a contact number","technicians.toast.missingRole":"⚠️ Please enter the role","technicians.toast.invalidWage":"⚠️ Enter a valid daily wage","technicians.toast.addSuccess":"✅ Crew member added","technicians.toast.updateSuccess":"💾 Crew member updated","technicians.toast.notFound":"⚠️ Crew member not found","technicians.toast.unidentified":"⚠️ Unable to identify crew member","technicians.toast.dataNotFound":"⚠️ Crew member details not found","technicians.toast.editReady":"✏️ You can edit the crew member details now then press Save","technicians.toast.deleteConfirm":"⚠️ Are you sure you want to remove this crew member?","technicians.toast.deleteSuccess":"🗑️ Crew member removed"}});function lt(e={}){return e.image||e.imageUrl||e.img||""}function ln(e){if(!e)return null;const i=Ee(e),{equipment:o=[]}=_e();return(o||[]).find(f=>Ee(f?.barcode)===i)||null}function Zt(e){const i=Ee(e);if(!i)return null;const{equipment:o=[]}=_e();return(o||[]).find(f=>Ee(f?.barcode)===i)||null}function Ye(e){return Zt(e)?.status==="صيانة"}function dn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ut={exports:{}};/*! choices.js v10.2.0 | © 2022 Josh Johnson | https://github.com/jshjohnson/Choices#readme */var cs;function un(){return cs||(cs=1,(function(e,i){(function(f,_){e.exports=_()})(window,function(){return(function(){var o={282:(function(b,n,u){Object.defineProperty(n,"__esModule",{value:!0}),n.clearChoices=n.activateChoices=n.filterChoices=n.addChoice=void 0;var v=u(883),l=function(p){var d=p.value,A=p.label,E=p.id,I=p.groupId,x=p.disabled,B=p.elementId,W=p.customProperties,Q=p.placeholder,X=p.keyCode;return{type:v.ACTION_TYPES.ADD_CHOICE,value:d,label:A,id:E,groupId:I,disabled:x,elementId:B,customProperties:W,placeholder:Q,keyCode:X}};n.addChoice=l;var h=function(p){return{type:v.ACTION_TYPES.FILTER_CHOICES,results:p}};n.filterChoices=h;var c=function(p){return p===void 0&&(p=!0),{type:v.ACTION_TYPES.ACTIVATE_CHOICES,active:p}};n.activateChoices=c;var a=function(){return{type:v.ACTION_TYPES.CLEAR_CHOICES}};n.clearChoices=a}),783:(function(b,n,u){Object.defineProperty(n,"__esModule",{value:!0}),n.addGroup=void 0;var v=u(883),l=function(h){var c=h.value,a=h.id,p=h.active,d=h.disabled;return{type:v.ACTION_TYPES.ADD_GROUP,value:c,id:a,active:p,disabled:d}};n.addGroup=l}),464:(function(b,n,u){Object.defineProperty(n,"__esModule",{value:!0}),n.highlightItem=n.removeItem=n.addItem=void 0;var v=u(883),l=function(a){var p=a.value,d=a.label,A=a.id,E=a.choiceId,I=a.groupId,x=a.customProperties,B=a.placeholder,W=a.keyCode;return{type:v.ACTION_TYPES.ADD_ITEM,value:p,label:d,id:A,choiceId:E,groupId:I,customProperties:x,placeholder:B,keyCode:W}};n.addItem=l;var h=function(a,p){return{type:v.ACTION_TYPES.REMOVE_ITEM,id:a,choiceId:p}};n.removeItem=h;var c=function(a,p){return{type:v.ACTION_TYPES.HIGHLIGHT_ITEM,id:a,highlighted:p}};n.highlightItem=c}),137:(function(b,n,u){Object.defineProperty(n,"__esModule",{value:!0}),n.setIsLoading=n.resetTo=n.clearAll=void 0;var v=u(883),l=function(){return{type:v.ACTION_TYPES.CLEAR_ALL}};n.clearAll=l;var h=function(a){return{type:v.ACTION_TYPES.RESET_TO,state:a}};n.resetTo=h;var c=function(a){return{type:v.ACTION_TYPES.SET_IS_LOADING,isLoading:a}};n.setIsLoading=c}),373:(function(b,n,u){var v=this&&this.__spreadArray||function(w,t,s){if(s||arguments.length===2)for(var r=0,m=t.length,C;r<m;r++)(C||!(r in t))&&(C||(C=Array.prototype.slice.call(t,0,r)),C[r]=t[r]);return w.concat(C||Array.prototype.slice.call(t))},l=this&&this.__importDefault||function(w){return w&&w.__esModule?w:{default:w}};Object.defineProperty(n,"__esModule",{value:!0});var h=l(u(996)),c=l(u(221)),a=u(282),p=u(783),d=u(464),A=u(137),E=u(520),I=u(883),x=u(789),B=u(799),W=u(655),Q=l(u(744)),X=l(u(686)),L="-ms-scroll-limit"in document.documentElement.style&&"-ms-ime-align"in document.documentElement.style,q={},M=(function(){function w(t,s){t===void 0&&(t="[data-choice]"),s===void 0&&(s={});var r=this;s.allowHTML===void 0&&console.warn("Deprecation warning: allowHTML will default to false in a future release. To render HTML in Choices, you will need to set it to true. Setting allowHTML will suppress this message."),this.config=h.default.all([x.DEFAULT_CONFIG,w.defaults.options,s],{arrayMerge:function(F,G){return v([],G,!0)}});var m=(0,B.diff)(this.config,x.DEFAULT_CONFIG);m.length&&console.warn("Unknown config option(s) passed",m.join(", "));var C=typeof t=="string"?document.querySelector(t):t;if(!(C instanceof HTMLInputElement||C instanceof HTMLSelectElement))throw TypeError("Expected one of the following types text|select-one|select-multiple");if(this._isTextElement=C.type===I.TEXT_TYPE,this._isSelectOneElement=C.type===I.SELECT_ONE_TYPE,this._isSelectMultipleElement=C.type===I.SELECT_MULTIPLE_TYPE,this._isSelectElement=this._isSelectOneElement||this._isSelectMultipleElement,this.config.searchEnabled=this._isSelectMultipleElement||this.config.searchEnabled,["auto","always"].includes("".concat(this.config.renderSelectedChoices))||(this.config.renderSelectedChoices="auto"),s.addItemFilter&&typeof s.addItemFilter!="function"){var j=s.addItemFilter instanceof RegExp?s.addItemFilter:new RegExp(s.addItemFilter);this.config.addItemFilter=j.test.bind(j)}if(this._isTextElement?this.passedElement=new E.WrappedInput({element:C,classNames:this.config.classNames,delimiter:this.config.delimiter}):this.passedElement=new E.WrappedSelect({element:C,classNames:this.config.classNames,template:function(F){return r._templates.option(F)}}),this.initialised=!1,this._store=new Q.default,this._initialState=W.defaultState,this._currentState=W.defaultState,this._prevState=W.defaultState,this._currentValue="",this._canSearch=!!this.config.searchEnabled,this._isScrollingOnIe=!1,this._highlightPosition=0,this._wasTap=!0,this._placeholderValue=this._generatePlaceholderValue(),this._baseId=(0,B.generateId)(this.passedElement.element,"choices-"),this._direction=this.passedElement.dir,!this._direction){var R=window.getComputedStyle(this.passedElement.element).direction,O=window.getComputedStyle(document.documentElement).direction;R!==O&&(this._direction=R)}if(this._idNames={itemChoice:"item-choice"},this._isSelectElement&&(this._presetGroups=this.passedElement.optionGroups,this._presetOptions=this.passedElement.options),this._presetChoices=this.config.choices,this._presetItems=this.config.items,this.passedElement.value&&this._isTextElement){var H=this.passedElement.value.split(this.config.delimiter);this._presetItems=this._presetItems.concat(H)}if(this.passedElement.options&&this.passedElement.options.forEach(function(F){r._presetChoices.push({value:F.value,label:F.innerHTML,selected:!!F.selected,disabled:F.disabled||F.parentNode.disabled,placeholder:F.value===""||F.hasAttribute("placeholder"),customProperties:(0,B.parseCustomProperties)(F.dataset.customProperties)})}),this._render=this._render.bind(this),this._onFocus=this._onFocus.bind(this),this._onBlur=this._onBlur.bind(this),this._onKeyUp=this._onKeyUp.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onClick=this._onClick.bind(this),this._onTouchMove=this._onTouchMove.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onMouseDown=this._onMouseDown.bind(this),this._onMouseOver=this._onMouseOver.bind(this),this._onFormReset=this._onFormReset.bind(this),this._onSelectKey=this._onSelectKey.bind(this),this._onEnterKey=this._onEnterKey.bind(this),this._onEscapeKey=this._onEscapeKey.bind(this),this._onDirectionKey=this._onDirectionKey.bind(this),this._onDeleteKey=this._onDeleteKey.bind(this),this.passedElement.isActive){this.config.silent||console.warn("Trying to initialise Choices on element already initialised",{element:t}),this.initialised=!0;return}this.init()}return Object.defineProperty(w,"defaults",{get:function(){return Object.preventExtensions({get options(){return q},get templates(){return X.default}})},enumerable:!1,configurable:!0}),w.prototype.init=function(){if(!this.initialised){this._createTemplates(),this._createElements(),this._createStructure(),this._store.subscribe(this._render),this._render(),this._addEventListeners();var t=!this.config.addItems||this.passedElement.element.hasAttribute("disabled");t&&this.disable(),this.initialised=!0;var s=this.config.callbackOnInit;s&&typeof s=="function"&&s.call(this)}},w.prototype.destroy=function(){this.initialised&&(this._removeEventListeners(),this.passedElement.reveal(),this.containerOuter.unwrap(this.passedElement.element),this.clearStore(),this._isSelectElement&&(this.passedElement.options=this._presetOptions),this._templates=X.default,this.initialised=!1)},w.prototype.enable=function(){return this.passedElement.isDisabled&&this.passedElement.enable(),this.containerOuter.isDisabled&&(this._addEventListeners(),this.input.enable(),this.containerOuter.enable()),this},w.prototype.disable=function(){return this.passedElement.isDisabled||this.passedElement.disable(),this.containerOuter.isDisabled||(this._removeEventListeners(),this.input.disable(),this.containerOuter.disable()),this},w.prototype.highlightItem=function(t,s){if(s===void 0&&(s=!0),!t||!t.id)return this;var r=t.id,m=t.groupId,C=m===void 0?-1:m,j=t.value,R=j===void 0?"":j,O=t.label,H=O===void 0?"":O,F=C>=0?this._store.getGroupById(C):null;return this._store.dispatch((0,d.highlightItem)(r,!0)),s&&this.passedElement.triggerEvent(I.EVENTS.highlightItem,{id:r,value:R,label:H,groupValue:F&&F.value?F.value:null}),this},w.prototype.unhighlightItem=function(t){if(!t||!t.id)return this;var s=t.id,r=t.groupId,m=r===void 0?-1:r,C=t.value,j=C===void 0?"":C,R=t.label,O=R===void 0?"":R,H=m>=0?this._store.getGroupById(m):null;return this._store.dispatch((0,d.highlightItem)(s,!1)),this.passedElement.triggerEvent(I.EVENTS.highlightItem,{id:s,value:j,label:O,groupValue:H&&H.value?H.value:null}),this},w.prototype.highlightAll=function(){var t=this;return this._store.items.forEach(function(s){return t.highlightItem(s)}),this},w.prototype.unhighlightAll=function(){var t=this;return this._store.items.forEach(function(s){return t.unhighlightItem(s)}),this},w.prototype.removeActiveItemsByValue=function(t){var s=this;return this._store.activeItems.filter(function(r){return r.value===t}).forEach(function(r){return s._removeItem(r)}),this},w.prototype.removeActiveItems=function(t){var s=this;return this._store.activeItems.filter(function(r){var m=r.id;return m!==t}).forEach(function(r){return s._removeItem(r)}),this},w.prototype.removeHighlightedItems=function(t){var s=this;return t===void 0&&(t=!1),this._store.highlightedActiveItems.forEach(function(r){s._removeItem(r),t&&s._triggerChange(r.value)}),this},w.prototype.showDropdown=function(t){var s=this;return this.dropdown.isActive?this:(requestAnimationFrame(function(){s.dropdown.show(),s.containerOuter.open(s.dropdown.distanceFromTopWindow),!t&&s._canSearch&&s.input.focus(),s.passedElement.triggerEvent(I.EVENTS.showDropdown,{})}),this)},w.prototype.hideDropdown=function(t){var s=this;return this.dropdown.isActive?(requestAnimationFrame(function(){s.dropdown.hide(),s.containerOuter.close(),!t&&s._canSearch&&(s.input.removeActiveDescendant(),s.input.blur()),s.passedElement.triggerEvent(I.EVENTS.hideDropdown,{})}),this):this},w.prototype.getValue=function(t){t===void 0&&(t=!1);var s=this._store.activeItems.reduce(function(r,m){var C=t?m.value:m;return r.push(C),r},[]);return this._isSelectOneElement?s[0]:s},w.prototype.setValue=function(t){var s=this;return this.initialised?(t.forEach(function(r){return s._setChoiceOrItem(r)}),this):this},w.prototype.setChoiceByValue=function(t){var s=this;if(!this.initialised||this._isTextElement)return this;var r=Array.isArray(t)?t:[t];return r.forEach(function(m){return s._findAndSelectChoiceByValue(m)}),this},w.prototype.setChoices=function(t,s,r,m){var C=this;if(t===void 0&&(t=[]),s===void 0&&(s="value"),r===void 0&&(r="label"),m===void 0&&(m=!1),!this.initialised)throw new ReferenceError("setChoices was called on a non-initialized instance of Choices");if(!this._isSelectElement)throw new TypeError("setChoices can't be used with INPUT based Choices");if(typeof s!="string"||!s)throw new TypeError("value parameter must be a name of 'value' field in passed objects");if(m&&this.clearChoices(),typeof t=="function"){var j=t(this);if(typeof Promise=="function"&&j instanceof Promise)return new Promise(function(R){return requestAnimationFrame(R)}).then(function(){return C._handleLoadingState(!0)}).then(function(){return j}).then(function(R){return C.setChoices(R,s,r,m)}).catch(function(R){C.config.silent||console.error(R)}).then(function(){return C._handleLoadingState(!1)}).then(function(){return C});if(!Array.isArray(j))throw new TypeError(".setChoices first argument function must return either array of choices or Promise, got: ".concat(typeof j));return this.setChoices(j,s,r,!1)}if(!Array.isArray(t))throw new TypeError(".setChoices must be called either with array of choices with a function resulting into Promise of array of choices");return this.containerOuter.removeLoadingState(),this._startLoading(),t.forEach(function(R){if(R.choices)C._addGroup({id:R.id?parseInt("".concat(R.id),10):null,group:R,valueKey:s,labelKey:r});else{var O=R;C._addChoice({value:O[s],label:O[r],isSelected:!!O.selected,isDisabled:!!O.disabled,placeholder:!!O.placeholder,customProperties:O.customProperties})}}),this._stopLoading(),this},w.prototype.clearChoices=function(){return this._store.dispatch((0,a.clearChoices)()),this},w.prototype.clearStore=function(){return this._store.dispatch((0,A.clearAll)()),this},w.prototype.clearInput=function(){var t=!this._isSelectOneElement;return this.input.clear(t),!this._isTextElement&&this._canSearch&&(this._isSearching=!1,this._store.dispatch((0,a.activateChoices)(!0))),this},w.prototype._render=function(){if(!this._store.isLoading()){this._currentState=this._store.state;var t=this._currentState.choices!==this._prevState.choices||this._currentState.groups!==this._prevState.groups||this._currentState.items!==this._prevState.items,s=this._isSelectElement,r=this._currentState.items!==this._prevState.items;t&&(s&&this._renderChoices(),r&&this._renderItems(),this._prevState=this._currentState)}},w.prototype._renderChoices=function(){var t=this,s=this._store,r=s.activeGroups,m=s.activeChoices,C=document.createDocumentFragment();if(this.choiceList.clear(),this.config.resetScrollPosition&&requestAnimationFrame(function(){return t.choiceList.scrollToTop()}),r.length>=1&&!this._isSearching){var j=m.filter(function(G){return G.placeholder===!0&&G.groupId===-1});j.length>=1&&(C=this._createChoicesFragment(j,C)),C=this._createGroupsFragment(r,m,C)}else m.length>=1&&(C=this._createChoicesFragment(m,C));if(C.childNodes&&C.childNodes.length>0){var R=this._store.activeItems,O=this._canAddItem(R,this.input.value);if(O.response)this.choiceList.append(C),this._highlightChoice();else{var H=this._getTemplate("notice",O.notice);this.choiceList.append(H)}}else{var F=void 0,H=void 0;this._isSearching?(H=typeof this.config.noResultsText=="function"?this.config.noResultsText():this.config.noResultsText,F=this._getTemplate("notice",H,"no-results")):(H=typeof this.config.noChoicesText=="function"?this.config.noChoicesText():this.config.noChoicesText,F=this._getTemplate("notice",H,"no-choices")),this.choiceList.append(F)}},w.prototype._renderItems=function(){var t=this._store.activeItems||[];this.itemList.clear();var s=this._createItemsFragment(t);s.childNodes&&this.itemList.append(s)},w.prototype._createGroupsFragment=function(t,s,r){var m=this;r===void 0&&(r=document.createDocumentFragment());var C=function(j){return s.filter(function(R){return m._isSelectOneElement?R.groupId===j.id:R.groupId===j.id&&(m.config.renderSelectedChoices==="always"||!R.selected)})};return this.config.shouldSort&&t.sort(this.config.sorter),t.forEach(function(j){var R=C(j);if(R.length>=1){var O=m._getTemplate("choiceGroup",j);r.appendChild(O),m._createChoicesFragment(R,r,!0)}}),r},w.prototype._createChoicesFragment=function(t,s,r){var m=this;s===void 0&&(s=document.createDocumentFragment()),r===void 0&&(r=!1);var C=this.config,j=C.renderSelectedChoices,R=C.searchResultLimit,O=C.renderChoiceLimit,H=this._isSearching?B.sortByScore:this.config.sorter,F=function(pe){var le=j==="auto"?m._isSelectOneElement||!pe.selected:!0;if(le){var ce=m._getTemplate("choice",pe,m.config.itemSelectText);s.appendChild(ce)}},G=t;j==="auto"&&!this._isSelectOneElement&&(G=t.filter(function(pe){return!pe.selected}));var ae=G.reduce(function(pe,le){return le.placeholder?pe.placeholderChoices.push(le):pe.normalChoices.push(le),pe},{placeholderChoices:[],normalChoices:[]}),se=ae.placeholderChoices,re=ae.normalChoices;(this.config.shouldSort||this._isSearching)&&re.sort(H);var de=G.length,Z=this._isSelectOneElement?v(v([],se,!0),re,!0):re;this._isSearching?de=R:O&&O>0&&!r&&(de=O);for(var oe=0;oe<de;oe+=1)Z[oe]&&F(Z[oe]);return s},w.prototype._createItemsFragment=function(t,s){var r=this;s===void 0&&(s=document.createDocumentFragment());var m=this.config,C=m.shouldSortItems,j=m.sorter,R=m.removeItemButton;C&&!this._isSelectOneElement&&t.sort(j),this._isTextElement?this.passedElement.value=t.map(function(H){var F=H.value;return F}).join(this.config.delimiter):this.passedElement.options=t;var O=function(H){var F=r._getTemplate("item",H,R);s.appendChild(F)};return t.forEach(O),s},w.prototype._triggerChange=function(t){t!=null&&this.passedElement.triggerEvent(I.EVENTS.change,{value:t})},w.prototype._selectPlaceholderChoice=function(t){this._addItem({value:t.value,label:t.label,choiceId:t.id,groupId:t.groupId,placeholder:t.placeholder}),this._triggerChange(t.value)},w.prototype._handleButtonAction=function(t,s){if(!(!t||!s||!this.config.removeItems||!this.config.removeItemButton)){var r=s.parentNode&&s.parentNode.dataset.id,m=r&&t.find(function(C){return C.id===parseInt(r,10)});m&&(this._removeItem(m),this._triggerChange(m.value),this._isSelectOneElement&&this._store.placeholderChoice&&this._selectPlaceholderChoice(this._store.placeholderChoice))}},w.prototype._handleItemAction=function(t,s,r){var m=this;if(r===void 0&&(r=!1),!(!t||!s||!this.config.removeItems||this._isSelectOneElement)){var C=s.dataset.id;t.forEach(function(j){j.id===parseInt("".concat(C),10)&&!j.highlighted?m.highlightItem(j):!r&&j.highlighted&&m.unhighlightItem(j)}),this.input.focus()}},w.prototype._handleChoiceAction=function(t,s){if(!(!t||!s)){var r=s.dataset.id,m=r&&this._store.getChoiceById(r);if(m){var C=t[0]&&t[0].keyCode?t[0].keyCode:void 0,j=this.dropdown.isActive;if(m.keyCode=C,this.passedElement.triggerEvent(I.EVENTS.choice,{choice:m}),!m.selected&&!m.disabled){var R=this._canAddItem(t,m.value);R.response&&(this._addItem({value:m.value,label:m.label,choiceId:m.id,groupId:m.groupId,customProperties:m.customProperties,placeholder:m.placeholder,keyCode:m.keyCode}),this._triggerChange(m.value))}this.clearInput(),j&&this._isSelectOneElement&&(this.hideDropdown(!0),this.containerOuter.focus())}}},w.prototype._handleBackspace=function(t){if(!(!this.config.removeItems||!t)){var s=t[t.length-1],r=t.some(function(m){return m.highlighted});this.config.editItems&&!r&&s?(this.input.value=s.value,this.input.setWidth(),this._removeItem(s),this._triggerChange(s.value)):(r||this.highlightItem(s,!1),this.removeHighlightedItems(!0))}},w.prototype._startLoading=function(){this._store.dispatch((0,A.setIsLoading)(!0))},w.prototype._stopLoading=function(){this._store.dispatch((0,A.setIsLoading)(!1))},w.prototype._handleLoadingState=function(t){t===void 0&&(t=!0);var s=this.itemList.getChild(".".concat(this.config.classNames.placeholder));t?(this.disable(),this.containerOuter.addLoadingState(),this._isSelectOneElement?s?s.innerHTML=this.config.loadingText:(s=this._getTemplate("placeholder",this.config.loadingText),s&&this.itemList.append(s)):this.input.placeholder=this.config.loadingText):(this.enable(),this.containerOuter.removeLoadingState(),this._isSelectOneElement?s&&(s.innerHTML=this._placeholderValue||""):this.input.placeholder=this._placeholderValue||"")},w.prototype._handleSearch=function(t){if(this.input.isFocussed){var s=this._store.choices,r=this.config,m=r.searchFloor,C=r.searchChoices,j=s.some(function(O){return!O.active});if(t!==null&&typeof t<"u"&&t.length>=m){var R=C?this._searchChoices(t):0;this.passedElement.triggerEvent(I.EVENTS.search,{value:t,resultCount:R})}else j&&(this._isSearching=!1,this._store.dispatch((0,a.activateChoices)(!0)))}},w.prototype._canAddItem=function(t,s){var r=!0,m=typeof this.config.addItemText=="function"?this.config.addItemText(s):this.config.addItemText;if(!this._isSelectOneElement){var C=(0,B.existsInArray)(t,s);this.config.maxItemCount>0&&this.config.maxItemCount<=t.length&&(r=!1,m=typeof this.config.maxItemText=="function"?this.config.maxItemText(this.config.maxItemCount):this.config.maxItemText),!this.config.duplicateItemsAllowed&&C&&r&&(r=!1,m=typeof this.config.uniqueItemText=="function"?this.config.uniqueItemText(s):this.config.uniqueItemText),this._isTextElement&&this.config.addItems&&r&&typeof this.config.addItemFilter=="function"&&!this.config.addItemFilter(s)&&(r=!1,m=typeof this.config.customAddItemText=="function"?this.config.customAddItemText(s):this.config.customAddItemText)}return{response:r,notice:m}},w.prototype._searchChoices=function(t){var s=typeof t=="string"?t.trim():t,r=typeof this._currentValue=="string"?this._currentValue.trim():this._currentValue;if(s.length<1&&s==="".concat(r," "))return 0;var m=this._store.searchableChoices,C=s,j=Object.assign(this.config.fuseOptions,{keys:v([],this.config.searchFields,!0),includeMatches:!0}),R=new c.default(m,j),O=R.search(C);return this._currentValue=s,this._highlightPosition=0,this._isSearching=!0,this._store.dispatch((0,a.filterChoices)(O)),O.length},w.prototype._addEventListeners=function(){var t=document.documentElement;t.addEventListener("touchend",this._onTouchEnd,!0),this.containerOuter.element.addEventListener("keydown",this._onKeyDown,!0),this.containerOuter.element.addEventListener("mousedown",this._onMouseDown,!0),t.addEventListener("click",this._onClick,{passive:!0}),t.addEventListener("touchmove",this._onTouchMove,{passive:!0}),this.dropdown.element.addEventListener("mouseover",this._onMouseOver,{passive:!0}),this._isSelectOneElement&&(this.containerOuter.element.addEventListener("focus",this._onFocus,{passive:!0}),this.containerOuter.element.addEventListener("blur",this._onBlur,{passive:!0})),this.input.element.addEventListener("keyup",this._onKeyUp,{passive:!0}),this.input.element.addEventListener("focus",this._onFocus,{passive:!0}),this.input.element.addEventListener("blur",this._onBlur,{passive:!0}),this.input.element.form&&this.input.element.form.addEventListener("reset",this._onFormReset,{passive:!0}),this.input.addEventListeners()},w.prototype._removeEventListeners=function(){var t=document.documentElement;t.removeEventListener("touchend",this._onTouchEnd,!0),this.containerOuter.element.removeEventListener("keydown",this._onKeyDown,!0),this.containerOuter.element.removeEventListener("mousedown",this._onMouseDown,!0),t.removeEventListener("click",this._onClick),t.removeEventListener("touchmove",this._onTouchMove),this.dropdown.element.removeEventListener("mouseover",this._onMouseOver),this._isSelectOneElement&&(this.containerOuter.element.removeEventListener("focus",this._onFocus),this.containerOuter.element.removeEventListener("blur",this._onBlur)),this.input.element.removeEventListener("keyup",this._onKeyUp),this.input.element.removeEventListener("focus",this._onFocus),this.input.element.removeEventListener("blur",this._onBlur),this.input.element.form&&this.input.element.form.removeEventListener("reset",this._onFormReset),this.input.removeEventListeners()},w.prototype._onKeyDown=function(t){var s=t.keyCode,r=this._store.activeItems,m=this.input.isFocussed,C=this.dropdown.isActive,j=this.itemList.hasChildren(),R=String.fromCharCode(s),O=/[^\x00-\x1F]/.test(R),H=I.KEY_CODES.BACK_KEY,F=I.KEY_CODES.DELETE_KEY,G=I.KEY_CODES.ENTER_KEY,ae=I.KEY_CODES.A_KEY,se=I.KEY_CODES.ESC_KEY,re=I.KEY_CODES.UP_KEY,de=I.KEY_CODES.DOWN_KEY,Z=I.KEY_CODES.PAGE_UP_KEY,oe=I.KEY_CODES.PAGE_DOWN_KEY;switch(!this._isTextElement&&!C&&O&&(this.showDropdown(),this.input.isFocussed||(this.input.value+=t.key.toLowerCase())),s){case ae:return this._onSelectKey(t,j);case G:return this._onEnterKey(t,r,C);case se:return this._onEscapeKey(C);case re:case Z:case de:case oe:return this._onDirectionKey(t,C);case F:case H:return this._onDeleteKey(t,r,m)}},w.prototype._onKeyUp=function(t){var s=t.target,r=t.keyCode,m=this.input.value,C=this._store.activeItems,j=this._canAddItem(C,m),R=I.KEY_CODES.BACK_KEY,O=I.KEY_CODES.DELETE_KEY;if(this._isTextElement){var H=j.notice&&m;if(H){var F=this._getTemplate("notice",j.notice);this.dropdown.element.innerHTML=F.outerHTML,this.showDropdown(!0)}else this.hideDropdown(!0)}else{var G=r===R||r===O,ae=G&&s&&!s.value,se=!this._isTextElement&&this._isSearching,re=this._canSearch&&j.response;ae&&se?(this._isSearching=!1,this._store.dispatch((0,a.activateChoices)(!0))):re&&this._handleSearch(this.input.rawValue)}this._canSearch=this.config.searchEnabled},w.prototype._onSelectKey=function(t,s){var r=t.ctrlKey,m=t.metaKey,C=r||m;if(C&&s){this._canSearch=!1;var j=this.config.removeItems&&!this.input.value&&this.input.element===document.activeElement;j&&this.highlightAll()}},w.prototype._onEnterKey=function(t,s,r){var m=t.target,C=I.KEY_CODES.ENTER_KEY,j=m&&m.hasAttribute("data-button");if(this._isTextElement&&m&&m.value){var R=this.input.value,O=this._canAddItem(s,R);O.response&&(this.hideDropdown(!0),this._addItem({value:R}),this._triggerChange(R),this.clearInput())}if(j&&(this._handleButtonAction(s,m),t.preventDefault()),r){var H=this.dropdown.getChild(".".concat(this.config.classNames.highlightedState));H&&(s[0]&&(s[0].keyCode=C),this._handleChoiceAction(s,H)),t.preventDefault()}else this._isSelectOneElement&&(this.showDropdown(),t.preventDefault())},w.prototype._onEscapeKey=function(t){t&&(this.hideDropdown(!0),this.containerOuter.focus())},w.prototype._onDirectionKey=function(t,s){var r=t.keyCode,m=t.metaKey,C=I.KEY_CODES.DOWN_KEY,j=I.KEY_CODES.PAGE_UP_KEY,R=I.KEY_CODES.PAGE_DOWN_KEY;if(s||this._isSelectOneElement){this.showDropdown(),this._canSearch=!1;var O=r===C||r===R?1:-1,H=m||r===R||r===j,F="[data-choice-selectable]",G=void 0;if(H)O>0?G=this.dropdown.element.querySelector("".concat(F,":last-of-type")):G=this.dropdown.element.querySelector(F);else{var ae=this.dropdown.element.querySelector(".".concat(this.config.classNames.highlightedState));ae?G=(0,B.getAdjacentEl)(ae,F,O):G=this.dropdown.element.querySelector(F)}G&&((0,B.isScrolledIntoView)(G,this.choiceList.element,O)||this.choiceList.scrollToChildElement(G,O),this._highlightChoice(G)),t.preventDefault()}},w.prototype._onDeleteKey=function(t,s,r){var m=t.target;!this._isSelectOneElement&&!m.value&&r&&(this._handleBackspace(s),t.preventDefault())},w.prototype._onTouchMove=function(){this._wasTap&&(this._wasTap=!1)},w.prototype._onTouchEnd=function(t){var s=(t||t.touches[0]).target,r=this._wasTap&&this.containerOuter.element.contains(s);if(r){var m=s===this.containerOuter.element||s===this.containerInner.element;m&&(this._isTextElement?this.input.focus():this._isSelectMultipleElement&&this.showDropdown()),t.stopPropagation()}this._wasTap=!0},w.prototype._onMouseDown=function(t){var s=t.target;if(s instanceof HTMLElement){if(L&&this.choiceList.element.contains(s)){var r=this.choiceList.element.firstElementChild,m=this._direction==="ltr"?t.offsetX>=r.offsetWidth:t.offsetX<r.offsetLeft;this._isScrollingOnIe=m}if(s!==this.input.element){var C=s.closest("[data-button],[data-item],[data-choice]");if(C instanceof HTMLElement){var j=t.shiftKey,R=this._store.activeItems,O=C.dataset;"button"in O?this._handleButtonAction(R,C):"item"in O?this._handleItemAction(R,C,j):"choice"in O&&this._handleChoiceAction(R,C)}t.preventDefault()}}},w.prototype._onMouseOver=function(t){var s=t.target;s instanceof HTMLElement&&"choice"in s.dataset&&this._highlightChoice(s)},w.prototype._onClick=function(t){var s=t.target,r=this.containerOuter.element.contains(s);if(r)!this.dropdown.isActive&&!this.containerOuter.isDisabled?this._isTextElement?document.activeElement!==this.input.element&&this.input.focus():(this.showDropdown(),this.containerOuter.focus()):this._isSelectOneElement&&s!==this.input.element&&!this.dropdown.element.contains(s)&&this.hideDropdown();else{var m=this._store.highlightedActiveItems.length>0;m&&this.unhighlightAll(),this.containerOuter.removeFocusState(),this.hideDropdown(!0)}},w.prototype._onFocus=function(t){var s,r=this,m=t.target,C=m&&this.containerOuter.element.contains(m);if(C){var j=(s={},s[I.TEXT_TYPE]=function(){m===r.input.element&&r.containerOuter.addFocusState()},s[I.SELECT_ONE_TYPE]=function(){r.containerOuter.addFocusState(),m===r.input.element&&r.showDropdown(!0)},s[I.SELECT_MULTIPLE_TYPE]=function(){m===r.input.element&&(r.showDropdown(!0),r.containerOuter.addFocusState())},s);j[this.passedElement.element.type]()}},w.prototype._onBlur=function(t){var s,r=this,m=t.target,C=m&&this.containerOuter.element.contains(m);if(C&&!this._isScrollingOnIe){var j=this._store.activeItems,R=j.some(function(H){return H.highlighted}),O=(s={},s[I.TEXT_TYPE]=function(){m===r.input.element&&(r.containerOuter.removeFocusState(),R&&r.unhighlightAll(),r.hideDropdown(!0))},s[I.SELECT_ONE_TYPE]=function(){r.containerOuter.removeFocusState(),(m===r.input.element||m===r.containerOuter.element&&!r._canSearch)&&r.hideDropdown(!0)},s[I.SELECT_MULTIPLE_TYPE]=function(){m===r.input.element&&(r.containerOuter.removeFocusState(),r.hideDropdown(!0),R&&r.unhighlightAll())},s);O[this.passedElement.element.type]()}else this._isScrollingOnIe=!1,this.input.element.focus()},w.prototype._onFormReset=function(){this._store.dispatch((0,A.resetTo)(this._initialState))},w.prototype._highlightChoice=function(t){var s=this;t===void 0&&(t=null);var r=Array.from(this.dropdown.element.querySelectorAll("[data-choice-selectable]"));if(r.length){var m=t,C=Array.from(this.dropdown.element.querySelectorAll(".".concat(this.config.classNames.highlightedState)));C.forEach(function(j){j.classList.remove(s.config.classNames.highlightedState),j.setAttribute("aria-selected","false")}),m?this._highlightPosition=r.indexOf(m):(r.length>this._highlightPosition?m=r[this._highlightPosition]:m=r[r.length-1],m||(m=r[0])),m.classList.add(this.config.classNames.highlightedState),m.setAttribute("aria-selected","true"),this.passedElement.triggerEvent(I.EVENTS.highlightChoice,{el:m}),this.dropdown.isActive&&(this.input.setActiveDescendant(m.id),this.containerOuter.setActiveDescendant(m.id))}},w.prototype._addItem=function(t){var s=t.value,r=t.label,m=r===void 0?null:r,C=t.choiceId,j=C===void 0?-1:C,R=t.groupId,O=R===void 0?-1:R,H=t.customProperties,F=H===void 0?{}:H,G=t.placeholder,ae=G===void 0?!1:G,se=t.keyCode,re=se===void 0?-1:se,de=typeof s=="string"?s.trim():s,Z=this._store.items,oe=m||de,pe=j||-1,le=O>=0?this._store.getGroupById(O):null,ce=Z?Z.length+1:1;this.config.prependValue&&(de=this.config.prependValue+de.toString()),this.config.appendValue&&(de+=this.config.appendValue.toString()),this._store.dispatch((0,d.addItem)({value:de,label:oe,id:ce,choiceId:pe,groupId:O,customProperties:F,placeholder:ae,keyCode:re})),this._isSelectOneElement&&this.removeActiveItems(ce),this.passedElement.triggerEvent(I.EVENTS.addItem,{id:ce,value:de,label:oe,customProperties:F,groupValue:le&&le.value?le.value:null,keyCode:re})},w.prototype._removeItem=function(t){var s=t.id,r=t.value,m=t.label,C=t.customProperties,j=t.choiceId,R=t.groupId,O=R&&R>=0?this._store.getGroupById(R):null;!s||!j||(this._store.dispatch((0,d.removeItem)(s,j)),this.passedElement.triggerEvent(I.EVENTS.removeItem,{id:s,value:r,label:m,customProperties:C,groupValue:O&&O.value?O.value:null}))},w.prototype._addChoice=function(t){var s=t.value,r=t.label,m=r===void 0?null:r,C=t.isSelected,j=C===void 0?!1:C,R=t.isDisabled,O=R===void 0?!1:R,H=t.groupId,F=H===void 0?-1:H,G=t.customProperties,ae=G===void 0?{}:G,se=t.placeholder,re=se===void 0?!1:se,de=t.keyCode,Z=de===void 0?-1:de;if(!(typeof s>"u"||s===null)){var oe=this._store.choices,pe=m||s,le=oe?oe.length+1:1,ce="".concat(this._baseId,"-").concat(this._idNames.itemChoice,"-").concat(le);this._store.dispatch((0,a.addChoice)({id:le,groupId:F,elementId:ce,value:s,label:pe,disabled:O,customProperties:ae,placeholder:re,keyCode:Z})),j&&this._addItem({value:s,label:pe,choiceId:le,customProperties:ae,placeholder:re,keyCode:Z})}},w.prototype._addGroup=function(t){var s=this,r=t.group,m=t.id,C=t.valueKey,j=C===void 0?"value":C,R=t.labelKey,O=R===void 0?"label":R,H=(0,B.isType)("Object",r)?r.choices:Array.from(r.getElementsByTagName("OPTION")),F=m||Math.floor(new Date().valueOf()*Math.random()),G=r.disabled?r.disabled:!1;if(H){this._store.dispatch((0,p.addGroup)({value:r.label,id:F,active:!0,disabled:G}));var ae=function(se){var re=se.disabled||se.parentNode&&se.parentNode.disabled;s._addChoice({value:se[j],label:(0,B.isType)("Object",se)?se[O]:se.innerHTML,isSelected:se.selected,isDisabled:re,groupId:F,customProperties:se.customProperties,placeholder:se.placeholder})};H.forEach(ae)}else this._store.dispatch((0,p.addGroup)({value:r.label,id:r.id,active:!1,disabled:r.disabled}))},w.prototype._getTemplate=function(t){for(var s,r=[],m=1;m<arguments.length;m++)r[m-1]=arguments[m];return(s=this._templates[t]).call.apply(s,v([this,this.config],r,!1))},w.prototype._createTemplates=function(){var t=this.config.callbackOnCreateTemplates,s={};t&&typeof t=="function"&&(s=t.call(this,B.strToEl)),this._templates=(0,h.default)(X.default,s)},w.prototype._createElements=function(){this.containerOuter=new E.Container({element:this._getTemplate("containerOuter",this._direction,this._isSelectElement,this._isSelectOneElement,this.config.searchEnabled,this.passedElement.element.type,this.config.labelId),classNames:this.config.classNames,type:this.passedElement.element.type,position:this.config.position}),this.containerInner=new E.Container({element:this._getTemplate("containerInner"),classNames:this.config.classNames,type:this.passedElement.element.type,position:this.config.position}),this.input=new E.Input({element:this._getTemplate("input",this._placeholderValue),classNames:this.config.classNames,type:this.passedElement.element.type,preventPaste:!this.config.paste}),this.choiceList=new E.List({element:this._getTemplate("choiceList",this._isSelectOneElement)}),this.itemList=new E.List({element:this._getTemplate("itemList",this._isSelectOneElement)}),this.dropdown=new E.Dropdown({element:this._getTemplate("dropdown"),classNames:this.config.classNames,type:this.passedElement.element.type})},w.prototype._createStructure=function(){this.passedElement.conceal(),this.containerInner.wrap(this.passedElement.element),this.containerOuter.wrap(this.containerInner.element),this._isSelectOneElement?this.input.placeholder=this.config.searchPlaceholderValue||"":this._placeholderValue&&(this.input.placeholder=this._placeholderValue,this.input.setWidth()),this.containerOuter.element.appendChild(this.containerInner.element),this.containerOuter.element.appendChild(this.dropdown.element),this.containerInner.element.appendChild(this.itemList.element),this._isTextElement||this.dropdown.element.appendChild(this.choiceList.element),this._isSelectOneElement?this.config.searchEnabled&&this.dropdown.element.insertBefore(this.input.element,this.dropdown.element.firstChild):this.containerInner.element.appendChild(this.input.element),this._isSelectElement&&(this._highlightPosition=0,this._isSearching=!1,this._startLoading(),this._presetGroups.length?this._addPredefinedGroups(this._presetGroups):this._addPredefinedChoices(this._presetChoices),this._stopLoading()),this._isTextElement&&this._addPredefinedItems(this._presetItems)},w.prototype._addPredefinedGroups=function(t){var s=this,r=this.passedElement.placeholderOption;r&&r.parentNode&&r.parentNode.tagName==="SELECT"&&this._addChoice({value:r.value,label:r.innerHTML,isSelected:r.selected,isDisabled:r.disabled,placeholder:!0}),t.forEach(function(m){return s._addGroup({group:m,id:m.id||null})})},w.prototype._addPredefinedChoices=function(t){var s=this;this.config.shouldSort&&t.sort(this.config.sorter);var r=t.some(function(C){return C.selected}),m=t.findIndex(function(C){return C.disabled===void 0||!C.disabled});t.forEach(function(C,j){var R=C.value,O=R===void 0?"":R,H=C.label,F=C.customProperties,G=C.placeholder;if(s._isSelectElement)if(C.choices)s._addGroup({group:C,id:C.id||null});else{var ae=s._isSelectOneElement&&!r&&j===m,se=ae?!0:C.selected,re=C.disabled;s._addChoice({value:O,label:H,isSelected:!!se,isDisabled:!!re,placeholder:!!G,customProperties:F})}else s._addChoice({value:O,label:H,isSelected:!!C.selected,isDisabled:!!C.disabled,placeholder:!!C.placeholder,customProperties:F})})},w.prototype._addPredefinedItems=function(t){var s=this;t.forEach(function(r){typeof r=="object"&&r.value&&s._addItem({value:r.value,label:r.label,choiceId:r.id,customProperties:r.customProperties,placeholder:r.placeholder}),typeof r=="string"&&s._addItem({value:r})})},w.prototype._setChoiceOrItem=function(t){var s=this,r=(0,B.getType)(t).toLowerCase(),m={object:function(){t.value&&(s._isTextElement?s._addItem({value:t.value,label:t.label,choiceId:t.id,customProperties:t.customProperties,placeholder:t.placeholder}):s._addChoice({value:t.value,label:t.label,isSelected:!0,isDisabled:!1,customProperties:t.customProperties,placeholder:t.placeholder}))},string:function(){s._isTextElement?s._addItem({value:t}):s._addChoice({value:t,label:t,isSelected:!0,isDisabled:!1})}};m[r]()},w.prototype._findAndSelectChoiceByValue=function(t){var s=this,r=this._store.choices,m=r.find(function(C){return s.config.valueComparer(C.value,t)});m&&!m.selected&&this._addItem({value:m.value,label:m.label,choiceId:m.id,groupId:m.groupId,customProperties:m.customProperties,placeholder:m.placeholder,keyCode:m.keyCode})},w.prototype._generatePlaceholderValue=function(){if(this._isSelectElement&&this.passedElement.placeholderOption){var t=this.passedElement.placeholderOption;return t?t.text:null}var s=this.config,r=s.placeholder,m=s.placeholderValue,C=this.passedElement.element.dataset;if(r){if(m)return m;if(C.placeholder)return C.placeholder}return null},w})();n.default=M}),613:(function(b,n,u){Object.defineProperty(n,"__esModule",{value:!0});var v=u(799),l=u(883),h=(function(){function c(a){var p=a.element,d=a.type,A=a.classNames,E=a.position;this.element=p,this.classNames=A,this.type=d,this.position=E,this.isOpen=!1,this.isFlipped=!1,this.isFocussed=!1,this.isDisabled=!1,this.isLoading=!1,this._onFocus=this._onFocus.bind(this),this._onBlur=this._onBlur.bind(this)}return c.prototype.addEventListeners=function(){this.element.addEventListener("focus",this._onFocus),this.element.addEventListener("blur",this._onBlur)},c.prototype.removeEventListeners=function(){this.element.removeEventListener("focus",this._onFocus),this.element.removeEventListener("blur",this._onBlur)},c.prototype.shouldFlip=function(a){if(typeof a!="number")return!1;var p=!1;return this.position==="auto"?p=!window.matchMedia("(min-height: ".concat(a+1,"px)")).matches:this.position==="top"&&(p=!0),p},c.prototype.setActiveDescendant=function(a){this.element.setAttribute("aria-activedescendant",a)},c.prototype.removeActiveDescendant=function(){this.element.removeAttribute("aria-activedescendant")},c.prototype.open=function(a){this.element.classList.add(this.classNames.openState),this.element.setAttribute("aria-expanded","true"),this.isOpen=!0,this.shouldFlip(a)&&(this.element.classList.add(this.classNames.flippedState),this.isFlipped=!0)},c.prototype.close=function(){this.element.classList.remove(this.classNames.openState),this.element.setAttribute("aria-expanded","false"),this.removeActiveDescendant(),this.isOpen=!1,this.isFlipped&&(this.element.classList.remove(this.classNames.flippedState),this.isFlipped=!1)},c.prototype.focus=function(){this.isFocussed||this.element.focus()},c.prototype.addFocusState=function(){this.element.classList.add(this.classNames.focusState)},c.prototype.removeFocusState=function(){this.element.classList.remove(this.classNames.focusState)},c.prototype.enable=function(){this.element.classList.remove(this.classNames.disabledState),this.element.removeAttribute("aria-disabled"),this.type===l.SELECT_ONE_TYPE&&this.element.setAttribute("tabindex","0"),this.isDisabled=!1},c.prototype.disable=function(){this.element.classList.add(this.classNames.disabledState),this.element.setAttribute("aria-disabled","true"),this.type===l.SELECT_ONE_TYPE&&this.element.setAttribute("tabindex","-1"),this.isDisabled=!0},c.prototype.wrap=function(a){(0,v.wrap)(a,this.element)},c.prototype.unwrap=function(a){this.element.parentNode&&(this.element.parentNode.insertBefore(a,this.element),this.element.parentNode.removeChild(this.element))},c.prototype.addLoadingState=function(){this.element.classList.add(this.classNames.loadingState),this.element.setAttribute("aria-busy","true"),this.isLoading=!0},c.prototype.removeLoadingState=function(){this.element.classList.remove(this.classNames.loadingState),this.element.removeAttribute("aria-busy"),this.isLoading=!1},c.prototype._onFocus=function(){this.isFocussed=!0},c.prototype._onBlur=function(){this.isFocussed=!1},c})();n.default=h}),217:(function(b,n){Object.defineProperty(n,"__esModule",{value:!0});var u=(function(){function v(l){var h=l.element,c=l.type,a=l.classNames;this.element=h,this.classNames=a,this.type=c,this.isActive=!1}return Object.defineProperty(v.prototype,"distanceFromTopWindow",{get:function(){return this.element.getBoundingClientRect().bottom},enumerable:!1,configurable:!0}),v.prototype.getChild=function(l){return this.element.querySelector(l)},v.prototype.show=function(){return this.element.classList.add(this.classNames.activeState),this.element.setAttribute("aria-expanded","true"),this.isActive=!0,this},v.prototype.hide=function(){return this.element.classList.remove(this.classNames.activeState),this.element.setAttribute("aria-expanded","false"),this.isActive=!1,this},v})();n.default=u}),520:(function(b,n,u){var v=this&&this.__importDefault||function(A){return A&&A.__esModule?A:{default:A}};Object.defineProperty(n,"__esModule",{value:!0}),n.WrappedSelect=n.WrappedInput=n.List=n.Input=n.Container=n.Dropdown=void 0;var l=v(u(217));n.Dropdown=l.default;var h=v(u(613));n.Container=h.default;var c=v(u(11));n.Input=c.default;var a=v(u(624));n.List=a.default;var p=v(u(541));n.WrappedInput=p.default;var d=v(u(982));n.WrappedSelect=d.default}),11:(function(b,n,u){Object.defineProperty(n,"__esModule",{value:!0});var v=u(799),l=u(883),h=(function(){function c(a){var p=a.element,d=a.type,A=a.classNames,E=a.preventPaste;this.element=p,this.type=d,this.classNames=A,this.preventPaste=E,this.isFocussed=this.element.isEqualNode(document.activeElement),this.isDisabled=p.disabled,this._onPaste=this._onPaste.bind(this),this._onInput=this._onInput.bind(this),this._onFocus=this._onFocus.bind(this),this._onBlur=this._onBlur.bind(this)}return Object.defineProperty(c.prototype,"placeholder",{set:function(a){this.element.placeholder=a},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"value",{get:function(){return(0,v.sanitise)(this.element.value)},set:function(a){this.element.value=a},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"rawValue",{get:function(){return this.element.value},enumerable:!1,configurable:!0}),c.prototype.addEventListeners=function(){this.element.addEventListener("paste",this._onPaste),this.element.addEventListener("input",this._onInput,{passive:!0}),this.element.addEventListener("focus",this._onFocus,{passive:!0}),this.element.addEventListener("blur",this._onBlur,{passive:!0})},c.prototype.removeEventListeners=function(){this.element.removeEventListener("input",this._onInput),this.element.removeEventListener("paste",this._onPaste),this.element.removeEventListener("focus",this._onFocus),this.element.removeEventListener("blur",this._onBlur)},c.prototype.enable=function(){this.element.removeAttribute("disabled"),this.isDisabled=!1},c.prototype.disable=function(){this.element.setAttribute("disabled",""),this.isDisabled=!0},c.prototype.focus=function(){this.isFocussed||this.element.focus()},c.prototype.blur=function(){this.isFocussed&&this.element.blur()},c.prototype.clear=function(a){return a===void 0&&(a=!0),this.element.value&&(this.element.value=""),a&&this.setWidth(),this},c.prototype.setWidth=function(){var a=this.element,p=a.style,d=a.value,A=a.placeholder;p.minWidth="".concat(A.length+1,"ch"),p.width="".concat(d.length+1,"ch")},c.prototype.setActiveDescendant=function(a){this.element.setAttribute("aria-activedescendant",a)},c.prototype.removeActiveDescendant=function(){this.element.removeAttribute("aria-activedescendant")},c.prototype._onInput=function(){this.type!==l.SELECT_ONE_TYPE&&this.setWidth()},c.prototype._onPaste=function(a){this.preventPaste&&a.preventDefault()},c.prototype._onFocus=function(){this.isFocussed=!0},c.prototype._onBlur=function(){this.isFocussed=!1},c})();n.default=h}),624:(function(b,n,u){Object.defineProperty(n,"__esModule",{value:!0});var v=u(883),l=(function(){function h(c){var a=c.element;this.element=a,this.scrollPos=this.element.scrollTop,this.height=this.element.offsetHeight}return h.prototype.clear=function(){this.element.innerHTML=""},h.prototype.append=function(c){this.element.appendChild(c)},h.prototype.getChild=function(c){return this.element.querySelector(c)},h.prototype.hasChildren=function(){return this.element.hasChildNodes()},h.prototype.scrollToTop=function(){this.element.scrollTop=0},h.prototype.scrollToChildElement=function(c,a){var p=this;if(c){var d=this.element.offsetHeight,A=this.element.scrollTop+d,E=c.offsetHeight,I=c.offsetTop+E,x=a>0?this.element.scrollTop+I-A:c.offsetTop;requestAnimationFrame(function(){p._animateScroll(x,a)})}},h.prototype._scrollDown=function(c,a,p){var d=(p-c)/a,A=d>1?d:1;this.element.scrollTop=c+A},h.prototype._scrollUp=function(c,a,p){var d=(c-p)/a,A=d>1?d:1;this.element.scrollTop=c-A},h.prototype._animateScroll=function(c,a){var p=this,d=v.SCROLLING_SPEED,A=this.element.scrollTop,E=!1;a>0?(this._scrollDown(A,d,c),A<c&&(E=!0)):(this._scrollUp(A,d,c),A>c&&(E=!0)),E&&requestAnimationFrame(function(){p._animateScroll(c,a)})},h})();n.default=l}),730:(function(b,n,u){Object.defineProperty(n,"__esModule",{value:!0});var v=u(799),l=(function(){function h(c){var a=c.element,p=c.classNames;if(this.element=a,this.classNames=p,!(a instanceof HTMLInputElement)&&!(a instanceof HTMLSelectElement))throw new TypeError("Invalid element passed");this.isDisabled=!1}return Object.defineProperty(h.prototype,"isActive",{get:function(){return this.element.dataset.choice==="active"},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"dir",{get:function(){return this.element.dir},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"value",{get:function(){return this.element.value},set:function(c){this.element.value=c},enumerable:!1,configurable:!0}),h.prototype.conceal=function(){this.element.classList.add(this.classNames.input),this.element.hidden=!0,this.element.tabIndex=-1;var c=this.element.getAttribute("style");c&&this.element.setAttribute("data-choice-orig-style",c),this.element.setAttribute("data-choice","active")},h.prototype.reveal=function(){this.element.classList.remove(this.classNames.input),this.element.hidden=!1,this.element.removeAttribute("tabindex");var c=this.element.getAttribute("data-choice-orig-style");c?(this.element.removeAttribute("data-choice-orig-style"),this.element.setAttribute("style",c)):this.element.removeAttribute("style"),this.element.removeAttribute("data-choice"),this.element.value=this.element.value},h.prototype.enable=function(){this.element.removeAttribute("disabled"),this.element.disabled=!1,this.isDisabled=!1},h.prototype.disable=function(){this.element.setAttribute("disabled",""),this.element.disabled=!0,this.isDisabled=!0},h.prototype.triggerEvent=function(c,a){(0,v.dispatchEvent)(this.element,c,a)},h})();n.default=l}),541:(function(b,n,u){var v=this&&this.__extends||(function(){var a=function(p,d){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(A,E){A.__proto__=E}||function(A,E){for(var I in E)Object.prototype.hasOwnProperty.call(E,I)&&(A[I]=E[I])},a(p,d)};return function(p,d){if(typeof d!="function"&&d!==null)throw new TypeError("Class extends value "+String(d)+" is not a constructor or null");a(p,d);function A(){this.constructor=p}p.prototype=d===null?Object.create(d):(A.prototype=d.prototype,new A)}})(),l=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(n,"__esModule",{value:!0});var h=l(u(730)),c=(function(a){v(p,a);function p(d){var A=d.element,E=d.classNames,I=d.delimiter,x=a.call(this,{element:A,classNames:E})||this;return x.delimiter=I,x}return Object.defineProperty(p.prototype,"value",{get:function(){return this.element.value},set:function(d){this.element.setAttribute("value",d),this.element.value=d},enumerable:!1,configurable:!0}),p})(h.default);n.default=c}),982:(function(b,n,u){var v=this&&this.__extends||(function(){var a=function(p,d){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(A,E){A.__proto__=E}||function(A,E){for(var I in E)Object.prototype.hasOwnProperty.call(E,I)&&(A[I]=E[I])},a(p,d)};return function(p,d){if(typeof d!="function"&&d!==null)throw new TypeError("Class extends value "+String(d)+" is not a constructor or null");a(p,d);function A(){this.constructor=p}p.prototype=d===null?Object.create(d):(A.prototype=d.prototype,new A)}})(),l=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(n,"__esModule",{value:!0});var h=l(u(730)),c=(function(a){v(p,a);function p(d){var A=d.element,E=d.classNames,I=d.template,x=a.call(this,{element:A,classNames:E})||this;return x.template=I,x}return Object.defineProperty(p.prototype,"placeholderOption",{get:function(){return this.element.querySelector('option[value=""]')||this.element.querySelector("option[placeholder]")},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"optionGroups",{get:function(){return Array.from(this.element.getElementsByTagName("OPTGROUP"))},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"options",{get:function(){return Array.from(this.element.options)},set:function(d){var A=this,E=document.createDocumentFragment(),I=function(x){var B=A.template(x);E.appendChild(B)};d.forEach(function(x){return I(x)}),this.appendDocFragment(E)},enumerable:!1,configurable:!0}),p.prototype.appendDocFragment=function(d){this.element.innerHTML="",this.element.appendChild(d)},p})(h.default);n.default=c}),883:(function(b,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SCROLLING_SPEED=n.SELECT_MULTIPLE_TYPE=n.SELECT_ONE_TYPE=n.TEXT_TYPE=n.KEY_CODES=n.ACTION_TYPES=n.EVENTS=void 0,n.EVENTS={showDropdown:"showDropdown",hideDropdown:"hideDropdown",change:"change",choice:"choice",search:"search",addItem:"addItem",removeItem:"removeItem",highlightItem:"highlightItem",highlightChoice:"highlightChoice",unhighlightItem:"unhighlightItem"},n.ACTION_TYPES={ADD_CHOICE:"ADD_CHOICE",FILTER_CHOICES:"FILTER_CHOICES",ACTIVATE_CHOICES:"ACTIVATE_CHOICES",CLEAR_CHOICES:"CLEAR_CHOICES",ADD_GROUP:"ADD_GROUP",ADD_ITEM:"ADD_ITEM",REMOVE_ITEM:"REMOVE_ITEM",HIGHLIGHT_ITEM:"HIGHLIGHT_ITEM",CLEAR_ALL:"CLEAR_ALL",RESET_TO:"RESET_TO",SET_IS_LOADING:"SET_IS_LOADING"},n.KEY_CODES={BACK_KEY:46,DELETE_KEY:8,ENTER_KEY:13,A_KEY:65,ESC_KEY:27,UP_KEY:38,DOWN_KEY:40,PAGE_UP_KEY:33,PAGE_DOWN_KEY:34},n.TEXT_TYPE="text",n.SELECT_ONE_TYPE="select-one",n.SELECT_MULTIPLE_TYPE="select-multiple",n.SCROLLING_SPEED=4}),789:(function(b,n,u){Object.defineProperty(n,"__esModule",{value:!0}),n.DEFAULT_CONFIG=n.DEFAULT_CLASSNAMES=void 0;var v=u(799);n.DEFAULT_CLASSNAMES={containerOuter:"choices",containerInner:"choices__inner",input:"choices__input",inputCloned:"choices__input--cloned",list:"choices__list",listItems:"choices__list--multiple",listSingle:"choices__list--single",listDropdown:"choices__list--dropdown",item:"choices__item",itemSelectable:"choices__item--selectable",itemDisabled:"choices__item--disabled",itemChoice:"choices__item--choice",placeholder:"choices__placeholder",group:"choices__group",groupHeading:"choices__heading",button:"choices__button",activeState:"is-active",focusState:"is-focused",openState:"is-open",disabledState:"is-disabled",highlightedState:"is-highlighted",selectedState:"is-selected",flippedState:"is-flipped",loadingState:"is-loading",noResults:"has-no-results",noChoices:"has-no-choices"},n.DEFAULT_CONFIG={items:[],choices:[],silent:!1,renderChoiceLimit:-1,maxItemCount:-1,addItems:!0,addItemFilter:null,removeItems:!0,removeItemButton:!1,editItems:!1,allowHTML:!0,duplicateItemsAllowed:!0,delimiter:",",paste:!0,searchEnabled:!0,searchChoices:!0,searchFloor:1,searchResultLimit:4,searchFields:["label","value"],position:"auto",resetScrollPosition:!0,shouldSort:!0,shouldSortItems:!1,sorter:v.sortByAlpha,placeholder:!0,placeholderValue:null,searchPlaceholderValue:null,prependValue:null,appendValue:null,renderSelectedChoices:"auto",loadingText:"Loading...",noResultsText:"No results found",noChoicesText:"No choices to choose from",itemSelectText:"Press to select",uniqueItemText:"Only unique values can be added",customAddItemText:"Only values matching specific conditions can be added",addItemText:function(l){return'Press Enter to add <b>"'.concat((0,v.sanitise)(l),'"</b>')},maxItemText:function(l){return"Only ".concat(l," values can be added")},valueComparer:function(l,h){return l===h},fuseOptions:{includeScore:!0},labelId:"",callbackOnInit:null,callbackOnCreateTemplates:null,classNames:n.DEFAULT_CLASSNAMES}}),18:(function(b,n){Object.defineProperty(n,"__esModule",{value:!0})}),978:(function(b,n){Object.defineProperty(n,"__esModule",{value:!0})}),948:(function(b,n){Object.defineProperty(n,"__esModule",{value:!0})}),359:(function(b,n){Object.defineProperty(n,"__esModule",{value:!0})}),285:(function(b,n){Object.defineProperty(n,"__esModule",{value:!0})}),533:(function(b,n){Object.defineProperty(n,"__esModule",{value:!0})}),187:(function(b,n,u){var v=this&&this.__createBinding||(Object.create?function(h,c,a,p){p===void 0&&(p=a);var d=Object.getOwnPropertyDescriptor(c,a);(!d||("get"in d?!c.__esModule:d.writable||d.configurable))&&(d={enumerable:!0,get:function(){return c[a]}}),Object.defineProperty(h,p,d)}:function(h,c,a,p){p===void 0&&(p=a),h[p]=c[a]}),l=this&&this.__exportStar||function(h,c){for(var a in h)a!=="default"&&!Object.prototype.hasOwnProperty.call(c,a)&&v(c,h,a)};Object.defineProperty(n,"__esModule",{value:!0}),l(u(18),n),l(u(978),n),l(u(948),n),l(u(359),n),l(u(285),n),l(u(533),n),l(u(287),n),l(u(132),n),l(u(837),n),l(u(598),n),l(u(369),n),l(u(37),n),l(u(47),n),l(u(923),n),l(u(876),n)}),287:(function(b,n){Object.defineProperty(n,"__esModule",{value:!0})}),132:(function(b,n){Object.defineProperty(n,"__esModule",{value:!0})}),837:(function(b,n){Object.defineProperty(n,"__esModule",{value:!0})}),598:(function(b,n){Object.defineProperty(n,"__esModule",{value:!0})}),37:(function(b,n){Object.defineProperty(n,"__esModule",{value:!0})}),369:(function(b,n){Object.defineProperty(n,"__esModule",{value:!0})}),47:(function(b,n){Object.defineProperty(n,"__esModule",{value:!0})}),923:(function(b,n){Object.defineProperty(n,"__esModule",{value:!0})}),876:(function(b,n){Object.defineProperty(n,"__esModule",{value:!0})}),799:(function(b,n){Object.defineProperty(n,"__esModule",{value:!0}),n.parseCustomProperties=n.diff=n.cloneObject=n.existsInArray=n.dispatchEvent=n.sortByScore=n.sortByAlpha=n.strToEl=n.sanitise=n.isScrolledIntoView=n.getAdjacentEl=n.wrap=n.isType=n.getType=n.generateId=n.generateChars=n.getRandomNumber=void 0;var u=function(L,q){return Math.floor(Math.random()*(q-L)+L)};n.getRandomNumber=u;var v=function(L){return Array.from({length:L},function(){return(0,n.getRandomNumber)(0,36).toString(36)}).join("")};n.generateChars=v;var l=function(L,q){var M=L.id||L.name&&"".concat(L.name,"-").concat((0,n.generateChars)(2))||(0,n.generateChars)(4);return M=M.replace(/(:|\.|\[|\]|,)/g,""),M="".concat(q,"-").concat(M),M};n.generateId=l;var h=function(L){return Object.prototype.toString.call(L).slice(8,-1)};n.getType=h;var c=function(L,q){return q!=null&&(0,n.getType)(q)===L};n.isType=c;var a=function(L,q){return q===void 0&&(q=document.createElement("div")),L.parentNode&&(L.nextSibling?L.parentNode.insertBefore(q,L.nextSibling):L.parentNode.appendChild(q)),q.appendChild(L)};n.wrap=a;var p=function(L,q,M){M===void 0&&(M=1);for(var w="".concat(M>0?"next":"previous","ElementSibling"),t=L[w];t;){if(t.matches(q))return t;t=t[w]}return t};n.getAdjacentEl=p;var d=function(L,q,M){if(M===void 0&&(M=1),!L)return!1;var w;return M>0?w=q.scrollTop+q.offsetHeight>=L.offsetTop+L.offsetHeight:w=L.offsetTop>=q.scrollTop,w};n.isScrolledIntoView=d;var A=function(L){return typeof L!="string"?L:L.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;")};n.sanitise=A,n.strToEl=(function(){var L=document.createElement("div");return function(q){var M=q.trim();L.innerHTML=M;for(var w=L.children[0];L.firstChild;)L.removeChild(L.firstChild);return w}})();var E=function(L,q){var M=L.value,w=L.label,t=w===void 0?M:w,s=q.value,r=q.label,m=r===void 0?s:r;return t.localeCompare(m,[],{sensitivity:"base",ignorePunctuation:!0,numeric:!0})};n.sortByAlpha=E;var I=function(L,q){var M=L.score,w=M===void 0?0:M,t=q.score,s=t===void 0?0:t;return w-s};n.sortByScore=I;var x=function(L,q,M){M===void 0&&(M=null);var w=new CustomEvent(q,{detail:M,bubbles:!0,cancelable:!0});return L.dispatchEvent(w)};n.dispatchEvent=x;var B=function(L,q,M){return M===void 0&&(M="value"),L.some(function(w){return typeof q=="string"?w[M]===q.trim():w[M]===q})};n.existsInArray=B;var W=function(L){return JSON.parse(JSON.stringify(L))};n.cloneObject=W;var Q=function(L,q){var M=Object.keys(L).sort(),w=Object.keys(q).sort();return M.filter(function(t){return w.indexOf(t)<0})};n.diff=Q;var X=function(L){if(typeof L<"u")try{return JSON.parse(L)}catch{return L}return{}};n.parseCustomProperties=X}),273:(function(b,n){var u=this&&this.__spreadArray||function(l,h,c){if(c||arguments.length===2)for(var a=0,p=h.length,d;a<p;a++)(d||!(a in h))&&(d||(d=Array.prototype.slice.call(h,0,a)),d[a]=h[a]);return l.concat(d||Array.prototype.slice.call(h))};Object.defineProperty(n,"__esModule",{value:!0}),n.defaultState=void 0,n.defaultState=[];function v(l,h){switch(l===void 0&&(l=n.defaultState),h===void 0&&(h={}),h.type){case"ADD_CHOICE":{var c=h,a={id:c.id,elementId:c.elementId,groupId:c.groupId,value:c.value,label:c.label||c.value,disabled:c.disabled||!1,selected:!1,active:!0,score:9999,customProperties:c.customProperties,placeholder:c.placeholder||!1};return u(u([],l,!0),[a],!1)}case"ADD_ITEM":{var p=h;return p.choiceId>-1?l.map(function(I){var x=I;return x.id===parseInt("".concat(p.choiceId),10)&&(x.selected=!0),x}):l}case"REMOVE_ITEM":{var d=h;return d.choiceId&&d.choiceId>-1?l.map(function(I){var x=I;return x.id===parseInt("".concat(d.choiceId),10)&&(x.selected=!1),x}):l}case"FILTER_CHOICES":{var A=h;return l.map(function(I){var x=I;return x.active=A.results.some(function(B){var W=B.item,Q=B.score;return W.id===x.id?(x.score=Q,!0):!1}),x})}case"ACTIVATE_CHOICES":{var E=h;return l.map(function(I){var x=I;return x.active=E.active,x})}case"CLEAR_CHOICES":return n.defaultState;default:return l}}n.default=v}),871:(function(b,n){var u=this&&this.__spreadArray||function(l,h,c){if(c||arguments.length===2)for(var a=0,p=h.length,d;a<p;a++)(d||!(a in h))&&(d||(d=Array.prototype.slice.call(h,0,a)),d[a]=h[a]);return l.concat(d||Array.prototype.slice.call(h))};Object.defineProperty(n,"__esModule",{value:!0}),n.defaultState=void 0,n.defaultState=[];function v(l,h){switch(l===void 0&&(l=n.defaultState),h===void 0&&(h={}),h.type){case"ADD_GROUP":{var c=h;return u(u([],l,!0),[{id:c.id,value:c.value,active:c.active,disabled:c.disabled}],!1)}case"CLEAR_CHOICES":return[];default:return l}}n.default=v}),655:(function(b,n,u){var v=this&&this.__importDefault||function(I){return I&&I.__esModule?I:{default:I}};Object.defineProperty(n,"__esModule",{value:!0}),n.defaultState=void 0;var l=u(791),h=v(u(52)),c=v(u(871)),a=v(u(273)),p=v(u(502)),d=u(799);n.defaultState={groups:[],items:[],choices:[],loading:!1};var A=(0,l.combineReducers)({items:h.default,groups:c.default,choices:a.default,loading:p.default}),E=function(I,x){var B=I;if(x.type==="CLEAR_ALL")B=n.defaultState;else if(x.type==="RESET_TO")return(0,d.cloneObject)(x.state);return A(B,x)};n.default=E}),52:(function(b,n){var u=this&&this.__spreadArray||function(l,h,c){if(c||arguments.length===2)for(var a=0,p=h.length,d;a<p;a++)(d||!(a in h))&&(d||(d=Array.prototype.slice.call(h,0,a)),d[a]=h[a]);return l.concat(d||Array.prototype.slice.call(h))};Object.defineProperty(n,"__esModule",{value:!0}),n.defaultState=void 0,n.defaultState=[];function v(l,h){switch(l===void 0&&(l=n.defaultState),h===void 0&&(h={}),h.type){case"ADD_ITEM":{var c=h,a=u(u([],l,!0),[{id:c.id,choiceId:c.choiceId,groupId:c.groupId,value:c.value,label:c.label,active:!0,highlighted:!1,customProperties:c.customProperties,placeholder:c.placeholder||!1,keyCode:null}],!1);return a.map(function(d){var A=d;return A.highlighted=!1,A})}case"REMOVE_ITEM":return l.map(function(d){var A=d;return A.id===h.id&&(A.active=!1),A});case"HIGHLIGHT_ITEM":{var p=h;return l.map(function(d){var A=d;return A.id===p.id&&(A.highlighted=p.highlighted),A})}default:return l}}n.default=v}),502:(function(b,n){Object.defineProperty(n,"__esModule",{value:!0}),n.defaultState=void 0,n.defaultState=!1;var u=function(v,l){switch(v===void 0&&(v=n.defaultState),l===void 0&&(l={}),l.type){case"SET_IS_LOADING":return l.isLoading;default:return v}};n.default=u}),744:(function(b,n,u){var v=this&&this.__spreadArray||function(p,d,A){if(A||arguments.length===2)for(var E=0,I=d.length,x;E<I;E++)(x||!(E in d))&&(x||(x=Array.prototype.slice.call(d,0,E)),x[E]=d[E]);return p.concat(x||Array.prototype.slice.call(d))},l=this&&this.__importDefault||function(p){return p&&p.__esModule?p:{default:p}};Object.defineProperty(n,"__esModule",{value:!0});var h=u(791),c=l(u(655)),a=(function(){function p(){this._store=(0,h.createStore)(c.default,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__())}return p.prototype.subscribe=function(d){this._store.subscribe(d)},p.prototype.dispatch=function(d){this._store.dispatch(d)},Object.defineProperty(p.prototype,"state",{get:function(){return this._store.getState()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"items",{get:function(){return this.state.items},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"activeItems",{get:function(){return this.items.filter(function(d){return d.active===!0})},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"highlightedActiveItems",{get:function(){return this.items.filter(function(d){return d.active&&d.highlighted})},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"choices",{get:function(){return this.state.choices},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"activeChoices",{get:function(){return this.choices.filter(function(d){return d.active===!0})},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"selectableChoices",{get:function(){return this.choices.filter(function(d){return d.disabled!==!0})},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"searchableChoices",{get:function(){return this.selectableChoices.filter(function(d){return d.placeholder!==!0})},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"placeholderChoice",{get:function(){return v([],this.choices,!0).reverse().find(function(d){return d.placeholder===!0})},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"groups",{get:function(){return this.state.groups},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"activeGroups",{get:function(){var d=this,A=d.groups,E=d.choices;return A.filter(function(I){var x=I.active===!0&&I.disabled===!1,B=E.some(function(W){return W.active===!0&&W.disabled===!1});return x&&B},[])},enumerable:!1,configurable:!0}),p.prototype.isLoading=function(){return this.state.loading},p.prototype.getChoiceById=function(d){return this.activeChoices.find(function(A){return A.id===parseInt(d,10)})},p.prototype.getGroupById=function(d){return this.groups.find(function(A){return A.id===d})},p})();n.default=a}),686:(function(b,n){Object.defineProperty(n,"__esModule",{value:!0});var u={containerOuter:function(v,l,h,c,a,p,d){var A=v.classNames.containerOuter,E=Object.assign(document.createElement("div"),{className:A});return E.dataset.type=p,l&&(E.dir=l),c&&(E.tabIndex=0),h&&(E.setAttribute("role",a?"combobox":"listbox"),a&&E.setAttribute("aria-autocomplete","list")),E.setAttribute("aria-haspopup","true"),E.setAttribute("aria-expanded","false"),d&&E.setAttribute("aria-labelledby",d),E},containerInner:function(v){var l=v.classNames.containerInner;return Object.assign(document.createElement("div"),{className:l})},itemList:function(v,l){var h=v.classNames,c=h.list,a=h.listSingle,p=h.listItems;return Object.assign(document.createElement("div"),{className:"".concat(c," ").concat(l?a:p)})},placeholder:function(v,l){var h,c=v.allowHTML,a=v.classNames.placeholder;return Object.assign(document.createElement("div"),(h={className:a},h[c?"innerHTML":"innerText"]=l,h))},item:function(v,l,h){var c,a,p=v.allowHTML,d=v.classNames,A=d.item,E=d.button,I=d.highlightedState,x=d.itemSelectable,B=d.placeholder,W=l.id,Q=l.value,X=l.label,L=l.customProperties,q=l.active,M=l.disabled,w=l.highlighted,t=l.placeholder,s=Object.assign(document.createElement("div"),(c={className:A},c[p?"innerHTML":"innerText"]=X,c));if(Object.assign(s.dataset,{item:"",id:W,value:Q,customProperties:L}),q&&s.setAttribute("aria-selected","true"),M&&s.setAttribute("aria-disabled","true"),t&&s.classList.add(B),s.classList.add(w?I:x),h){M&&s.classList.remove(x),s.dataset.deletable="";var r="Remove item",m=Object.assign(document.createElement("button"),(a={type:"button",className:E},a[p?"innerHTML":"innerText"]=r,a));m.setAttribute("aria-label","".concat(r,": '").concat(Q,"'")),m.dataset.button="",s.appendChild(m)}return s},choiceList:function(v,l){var h=v.classNames.list,c=Object.assign(document.createElement("div"),{className:h});return l||c.setAttribute("aria-multiselectable","true"),c.setAttribute("role","listbox"),c},choiceGroup:function(v,l){var h,c=v.allowHTML,a=v.classNames,p=a.group,d=a.groupHeading,A=a.itemDisabled,E=l.id,I=l.value,x=l.disabled,B=Object.assign(document.createElement("div"),{className:"".concat(p," ").concat(x?A:"")});return B.setAttribute("role","group"),Object.assign(B.dataset,{group:"",id:E,value:I}),x&&B.setAttribute("aria-disabled","true"),B.appendChild(Object.assign(document.createElement("div"),(h={className:d},h[c?"innerHTML":"innerText"]=I,h))),B},choice:function(v,l,h){var c,a=v.allowHTML,p=v.classNames,d=p.item,A=p.itemChoice,E=p.itemSelectable,I=p.selectedState,x=p.itemDisabled,B=p.placeholder,W=l.id,Q=l.value,X=l.label,L=l.groupId,q=l.elementId,M=l.disabled,w=l.selected,t=l.placeholder,s=Object.assign(document.createElement("div"),(c={id:q},c[a?"innerHTML":"innerText"]=X,c.className="".concat(d," ").concat(A),c));return w&&s.classList.add(I),t&&s.classList.add(B),s.setAttribute("role",L&&L>0?"treeitem":"option"),Object.assign(s.dataset,{choice:"",id:W,value:Q,selectText:h}),M?(s.classList.add(x),s.dataset.choiceDisabled="",s.setAttribute("aria-disabled","true")):(s.classList.add(E),s.dataset.choiceSelectable=""),s},input:function(v,l){var h=v.classNames,c=h.input,a=h.inputCloned,p=Object.assign(document.createElement("input"),{type:"search",name:"search_terms",className:"".concat(c," ").concat(a),autocomplete:"off",autocapitalize:"off",spellcheck:!1});return p.setAttribute("role","textbox"),p.setAttribute("aria-autocomplete","list"),p.setAttribute("aria-label",l),p},dropdown:function(v){var l=v.classNames,h=l.list,c=l.listDropdown,a=document.createElement("div");return a.classList.add(h,c),a.setAttribute("aria-expanded","false"),a},notice:function(v,l,h){var c,a=v.allowHTML,p=v.classNames,d=p.item,A=p.itemChoice,E=p.noResults,I=p.noChoices;h===void 0&&(h="");var x=[d,A];return h==="no-choices"?x.push(I):h==="no-results"&&x.push(E),Object.assign(document.createElement("div"),(c={},c[a?"innerHTML":"innerText"]=l,c.className=x.join(" "),c))},option:function(v){var l=v.label,h=v.value,c=v.customProperties,a=v.active,p=v.disabled,d=new Option(l,h,!1,a);return c&&(d.dataset.customProperties="".concat(c)),d.disabled=!!p,d}};n.default=u}),996:(function(b){var n=function(q){return u(q)&&!v(q)};function u(L){return!!L&&typeof L=="object"}function v(L){var q=Object.prototype.toString.call(L);return q==="[object RegExp]"||q==="[object Date]"||c(L)}var l=typeof Symbol=="function"&&Symbol.for,h=l?Symbol.for("react.element"):60103;function c(L){return L.$$typeof===h}function a(L){return Array.isArray(L)?[]:{}}function p(L,q){return q.clone!==!1&&q.isMergeableObject(L)?Q(a(L),L,q):L}function d(L,q,M){return L.concat(q).map(function(w){return p(w,M)})}function A(L,q){if(!q.customMerge)return Q;var M=q.customMerge(L);return typeof M=="function"?M:Q}function E(L){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(L).filter(function(q){return L.propertyIsEnumerable(q)}):[]}function I(L){return Object.keys(L).concat(E(L))}function x(L,q){try{return q in L}catch{return!1}}function B(L,q){return x(L,q)&&!(Object.hasOwnProperty.call(L,q)&&Object.propertyIsEnumerable.call(L,q))}function W(L,q,M){var w={};return M.isMergeableObject(L)&&I(L).forEach(function(t){w[t]=p(L[t],M)}),I(q).forEach(function(t){B(L,t)||(x(L,t)&&M.isMergeableObject(q[t])?w[t]=A(t,M)(L[t],q[t],M):w[t]=p(q[t],M))}),w}function Q(L,q,M){M=M||{},M.arrayMerge=M.arrayMerge||d,M.isMergeableObject=M.isMergeableObject||n,M.cloneUnlessOtherwiseSpecified=p;var w=Array.isArray(q),t=Array.isArray(L),s=w===t;return s?w?M.arrayMerge(L,q,M):W(L,q,M):p(q,M)}Q.all=function(q,M){if(!Array.isArray(q))throw new Error("first argument should be an array");return q.reduce(function(w,t){return Q(w,t,M)},{})};var X=Q;b.exports=X}),221:(function(b,n,u){u.r(n),u.d(n,{default:function(){return Me}});function v(T){return Array.isArray?Array.isArray(T):x(T)==="[object Array]"}function l(T){if(typeof T=="string")return T;let g=T+"";return g=="0"&&1/T==-1/0?"-0":g}function h(T){return T==null?"":l(T)}function c(T){return typeof T=="string"}function a(T){return typeof T=="number"}function p(T){return T===!0||T===!1||A(T)&&x(T)=="[object Boolean]"}function d(T){return typeof T=="object"}function A(T){return d(T)&&T!==null}function E(T){return T!=null}function I(T){return!T.trim().length}function x(T){return T==null?T===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(T)}const B="Incorrect 'index' type",W=T=>`Invalid value for key ${T}`,Q=T=>`Pattern length exceeds max of ${T}.`,X=T=>`Missing ${T} property in key`,L=T=>`Property 'weight' in key '${T}' must be a positive integer`,q=Object.prototype.hasOwnProperty;class M{constructor(g){this._keys=[],this._keyMap={};let D=0;g.forEach(P=>{let N=w(P);D+=N.weight,this._keys.push(N),this._keyMap[N.id]=N,D+=N.weight}),this._keys.forEach(P=>{P.weight/=D})}get(g){return this._keyMap[g]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function w(T){let g=null,D=null,P=null,N=1,k=null;if(c(T)||v(T))P=T,g=t(T),D=s(T);else{if(!q.call(T,"name"))throw new Error(X("name"));const $=T.name;if(P=$,q.call(T,"weight")&&(N=T.weight,N<=0))throw new Error(L($));g=t($),D=s($),k=T.getFn}return{path:g,id:D,weight:N,src:P,getFn:k}}function t(T){return v(T)?T:T.split(".")}function s(T){return v(T)?T.join("."):T}function r(T,g){let D=[],P=!1;const N=(k,$,K)=>{if(E(k))if(!$[K])D.push(k);else{let V=$[K];const Y=k[V];if(!E(Y))return;if(K===$.length-1&&(c(Y)||a(Y)||p(Y)))D.push(h(Y));else if(v(Y)){P=!0;for(let z=0,te=Y.length;z<te;z+=1)N(Y[z],$,K+1)}else $.length&&N(Y,$,K+1)}};return N(T,c(g)?g.split("."):g,0),P?D:D[0]}var O={...{isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(T,g)=>T.score===g.score?T.idx<g.idx?-1:1:T.score<g.score?-1:1},...{includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},...{location:0,threshold:.6,distance:100},...{useExtendedSearch:!1,getFn:r,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1}};const H=/[^ ]+/g;function F(T=1,g=3){const D=new Map,P=Math.pow(10,g);return{get(N){const k=N.match(H).length;if(D.has(k))return D.get(k);const $=1/Math.pow(k,.5*T),K=parseFloat(Math.round($*P)/P);return D.set(k,K),K},clear(){D.clear()}}}class G{constructor({getFn:g=O.getFn,fieldNormWeight:D=O.fieldNormWeight}={}){this.norm=F(D,3),this.getFn=g,this.isCreated=!1,this.setIndexRecords()}setSources(g=[]){this.docs=g}setIndexRecords(g=[]){this.records=g}setKeys(g=[]){this.keys=g,this._keysMap={},g.forEach((D,P)=>{this._keysMap[D.id]=P})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,c(this.docs[0])?this.docs.forEach((g,D)=>{this._addString(g,D)}):this.docs.forEach((g,D)=>{this._addObject(g,D)}),this.norm.clear())}add(g){const D=this.size();c(g)?this._addString(g,D):this._addObject(g,D)}removeAt(g){this.records.splice(g,1);for(let D=g,P=this.size();D<P;D+=1)this.records[D].i-=1}getValueForItemAtKeyId(g,D){return g[this._keysMap[D]]}size(){return this.records.length}_addString(g,D){if(!E(g)||I(g))return;let P={v:g,i:D,n:this.norm.get(g)};this.records.push(P)}_addObject(g,D){let P={i:D,$:{}};this.keys.forEach((N,k)=>{let $=N.getFn?N.getFn(g):this.getFn(g,N.path);if(E($)){if(v($)){let K=[];const V=[{nestedArrIndex:-1,value:$}];for(;V.length;){const{nestedArrIndex:Y,value:z}=V.pop();if(E(z))if(c(z)&&!I(z)){let te={v:z,i:Y,n:this.norm.get(z)};K.push(te)}else v(z)&&z.forEach((te,ie)=>{V.push({nestedArrIndex:ie,value:te})})}P.$[k]=K}else if(c($)&&!I($)){let K={v:$,n:this.norm.get($)};P.$[k]=K}}}),this.records.push(P)}toJSON(){return{keys:this.keys,records:this.records}}}function ae(T,g,{getFn:D=O.getFn,fieldNormWeight:P=O.fieldNormWeight}={}){const N=new G({getFn:D,fieldNormWeight:P});return N.setKeys(T.map(w)),N.setSources(g),N.create(),N}function se(T,{getFn:g=O.getFn,fieldNormWeight:D=O.fieldNormWeight}={}){const{keys:P,records:N}=T,k=new G({getFn:g,fieldNormWeight:D});return k.setKeys(P),k.setIndexRecords(N),k}function re(T,{errors:g=0,currentLocation:D=0,expectedLocation:P=0,distance:N=O.distance,ignoreLocation:k=O.ignoreLocation}={}){const $=g/T.length;if(k)return $;const K=Math.abs(P-D);return N?$+K/N:K?1:$}function de(T=[],g=O.minMatchCharLength){let D=[],P=-1,N=-1,k=0;for(let $=T.length;k<$;k+=1){let K=T[k];K&&P===-1?P=k:!K&&P!==-1&&(N=k-1,N-P+1>=g&&D.push([P,N]),P=-1)}return T[k-1]&&k-P>=g&&D.push([P,k-1]),D}const Z=32;function oe(T,g,D,{location:P=O.location,distance:N=O.distance,threshold:k=O.threshold,findAllMatches:$=O.findAllMatches,minMatchCharLength:K=O.minMatchCharLength,includeMatches:V=O.includeMatches,ignoreLocation:Y=O.ignoreLocation}={}){if(g.length>Z)throw new Error(Q(Z));const z=g.length,te=T.length,ie=Math.max(0,Math.min(P,te));let ue=k,he=ie;const Ie=K>1||V,Oe=Ie?Array(te):[];let Le;for(;(Le=T.indexOf(g,he))>-1;){let ve=re(g,{currentLocation:Le,expectedLocation:ie,distance:N,ignoreLocation:Y});if(ue=Math.min(ve,ue),he=Le+z,Ie){let Te=0;for(;Te<z;)Oe[Le+Te]=1,Te+=1}}he=-1;let Ne=[],Se=1,He=z+te;const ft=1<<z-1;for(let ve=0;ve<z;ve+=1){let Te=0,ye=He;for(;Te<ye;)re(g,{errors:ve,currentLocation:ie+ye,expectedLocation:ie,distance:N,ignoreLocation:Y})<=ue?Te=ye:He=ye,ye=Math.floor((He-Te)/2+Te);He=ye;let vt=Math.max(1,ie-ye+1),nt=$?te:Math.min(ie+ye,te)+z,xe=Array(nt+2);xe[nt+1]=(1<<ve)-1;for(let Ce=nt;Ce>=vt;Ce-=1){let ee=Ce-1,me=D[T.charAt(ee)];if(Ie&&(Oe[ee]=+!!me),xe[Ce]=(xe[Ce+1]<<1|1)&me,ve&&(xe[Ce]|=(Ne[Ce+1]|Ne[Ce])<<1|1|Ne[Ce+1]),xe[Ce]&ft&&(Se=re(g,{errors:ve,currentLocation:ee,expectedLocation:ie,distance:N,ignoreLocation:Y}),Se<=ue)){if(ue=Se,he=ee,he<=ie)break;vt=Math.max(1,2*ie-he)}}if(re(g,{errors:ve+1,currentLocation:ie,expectedLocation:ie,distance:N,ignoreLocation:Y})>ue)break;Ne=xe}const st={isMatch:he>=0,score:Math.max(.001,Se)};if(Ie){const ve=de(Oe,K);ve.length?V&&(st.indices=ve):st.isMatch=!1}return st}function pe(T){let g={};for(let D=0,P=T.length;D<P;D+=1){const N=T.charAt(D);g[N]=(g[N]||0)|1<<P-D-1}return g}class le{constructor(g,{location:D=O.location,threshold:P=O.threshold,distance:N=O.distance,includeMatches:k=O.includeMatches,findAllMatches:$=O.findAllMatches,minMatchCharLength:K=O.minMatchCharLength,isCaseSensitive:V=O.isCaseSensitive,ignoreLocation:Y=O.ignoreLocation}={}){if(this.options={location:D,threshold:P,distance:N,includeMatches:k,findAllMatches:$,minMatchCharLength:K,isCaseSensitive:V,ignoreLocation:Y},this.pattern=V?g:g.toLowerCase(),this.chunks=[],!this.pattern.length)return;const z=(ie,ue)=>{this.chunks.push({pattern:ie,alphabet:pe(ie),startIndex:ue})},te=this.pattern.length;if(te>Z){let ie=0;const ue=te%Z,he=te-ue;for(;ie<he;)z(this.pattern.substr(ie,Z),ie),ie+=Z;if(ue){const Ie=te-Z;z(this.pattern.substr(Ie),Ie)}}else z(this.pattern,0)}searchIn(g){const{isCaseSensitive:D,includeMatches:P}=this.options;if(D||(g=g.toLowerCase()),this.pattern===g){let he={isMatch:!0,score:0};return P&&(he.indices=[[0,g.length-1]]),he}const{location:N,distance:k,threshold:$,findAllMatches:K,minMatchCharLength:V,ignoreLocation:Y}=this.options;let z=[],te=0,ie=!1;this.chunks.forEach(({pattern:he,alphabet:Ie,startIndex:Oe})=>{const{isMatch:Le,score:Ne,indices:Se}=oe(g,he,Ie,{location:N+Oe,distance:k,threshold:$,findAllMatches:K,minMatchCharLength:V,includeMatches:P,ignoreLocation:Y});Le&&(ie=!0),te+=Ne,Le&&Se&&(z=[...z,...Se])});let ue={isMatch:ie,score:ie?te/this.chunks.length:1};return ie&&P&&(ue.indices=z),ue}}class ce{constructor(g){this.pattern=g}static isMultiMatch(g){return $e(g,this.multiRegex)}static isSingleMatch(g){return $e(g,this.singleRegex)}search(){}}function $e(T,g){const D=T.match(g);return D?D[1]:null}class At extends ce{constructor(g){super(g)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(g){const D=g===this.pattern;return{isMatch:D,score:D?0:1,indices:[0,this.pattern.length-1]}}}class Lt extends ce{constructor(g){super(g)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(g){const P=g.indexOf(this.pattern)===-1;return{isMatch:P,score:P?0:1,indices:[0,g.length-1]}}}class Dt extends ce{constructor(g){super(g)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(g){const D=g.startsWith(this.pattern);return{isMatch:D,score:D?0:1,indices:[0,this.pattern.length-1]}}}class Ot extends ce{constructor(g){super(g)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(g){const D=!g.startsWith(this.pattern);return{isMatch:D,score:D?0:1,indices:[0,g.length-1]}}}class Pt extends ce{constructor(g){super(g)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(g){const D=g.endsWith(this.pattern);return{isMatch:D,score:D?0:1,indices:[g.length-this.pattern.length,g.length-1]}}}class qe extends ce{constructor(g){super(g)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(g){const D=!g.endsWith(this.pattern);return{isMatch:D,score:D?0:1,indices:[0,g.length-1]}}}class dt extends ce{constructor(g,{location:D=O.location,threshold:P=O.threshold,distance:N=O.distance,includeMatches:k=O.includeMatches,findAllMatches:$=O.findAllMatches,minMatchCharLength:K=O.minMatchCharLength,isCaseSensitive:V=O.isCaseSensitive,ignoreLocation:Y=O.ignoreLocation}={}){super(g),this._bitapSearch=new le(g,{location:D,threshold:P,distance:N,includeMatches:k,findAllMatches:$,minMatchCharLength:K,isCaseSensitive:V,ignoreLocation:Y})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(g){return this._bitapSearch.searchIn(g)}}class ut extends ce{constructor(g){super(g)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(g){let D=0,P;const N=[],k=this.pattern.length;for(;(P=g.indexOf(this.pattern,D))>-1;)D=P+k,N.push([P,D-1]);const $=!!N.length;return{isMatch:$,score:$?0:1,indices:N}}}const Qe=[At,ut,Dt,Ot,qe,Pt,Lt,dt],mt=Qe.length,qt=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,Mt="|";function Nt(T,g={}){return T.split(Mt).map(D=>{let P=D.trim().split(qt).filter(k=>k&&!!k.trim()),N=[];for(let k=0,$=P.length;k<$;k+=1){const K=P[k];let V=!1,Y=-1;for(;!V&&++Y<mt;){const z=Qe[Y];let te=z.isMultiMatch(K);te&&(N.push(new z(te,g)),V=!0)}if(!V)for(Y=-1;++Y<mt;){const z=Qe[Y];let te=z.isSingleMatch(K);if(te){N.push(new z(te,g));break}}}return N})}const xt=new Set([dt.type,ut.type]);class kt{constructor(g,{isCaseSensitive:D=O.isCaseSensitive,includeMatches:P=O.includeMatches,minMatchCharLength:N=O.minMatchCharLength,ignoreLocation:k=O.ignoreLocation,findAllMatches:$=O.findAllMatches,location:K=O.location,threshold:V=O.threshold,distance:Y=O.distance}={}){this.query=null,this.options={isCaseSensitive:D,includeMatches:P,minMatchCharLength:N,findAllMatches:$,ignoreLocation:k,location:K,threshold:V,distance:Y},this.pattern=D?g:g.toLowerCase(),this.query=Nt(this.pattern,this.options)}static condition(g,D){return D.useExtendedSearch}searchIn(g){const D=this.query;if(!D)return{isMatch:!1,score:1};const{includeMatches:P,isCaseSensitive:N}=this.options;g=N?g:g.toLowerCase();let k=0,$=[],K=0;for(let V=0,Y=D.length;V<Y;V+=1){const z=D[V];$.length=0,k=0;for(let te=0,ie=z.length;te<ie;te+=1){const ue=z[te],{isMatch:he,indices:Ie,score:Oe}=ue.search(g);if(he){if(k+=1,K+=Oe,P){const Le=ue.constructor.type;xt.has(Le)?$=[...$,...Ie]:$.push(Ie)}}else{K=0,k=0,$.length=0;break}}if(k){let te={isMatch:!0,score:K/k};return P&&(te.indices=$),te}}return{isMatch:!1,score:1}}}const Je=[];function jt(...T){Je.push(...T)}function Ze(T,g){for(let D=0,P=Je.length;D<P;D+=1){let N=Je[D];if(N.condition(T,g))return new N(T,g)}return new le(T,g)}const Fe={AND:"$and",OR:"$or"},et={PATH:"$path",PATTERN:"$val"},tt=T=>!!(T[Fe.AND]||T[Fe.OR]),Rt=T=>!!T[et.PATH],Bt=T=>!v(T)&&d(T)&&!tt(T),pt=T=>({[Fe.AND]:Object.keys(T).map(g=>({[g]:T[g]}))});function ht(T,g,{auto:D=!0}={}){const P=N=>{let k=Object.keys(N);const $=Rt(N);if(!$&&k.length>1&&!tt(N))return P(pt(N));if(Bt(N)){const V=$?N[et.PATH]:k[0],Y=$?N[et.PATTERN]:N[V];if(!c(Y))throw new Error(W(V));const z={keyId:s(V),pattern:Y};return D&&(z.searcher=Ze(Y,g)),z}let K={children:[],operator:k[0]};return k.forEach(V=>{const Y=N[V];v(Y)&&Y.forEach(z=>{K.children.push(P(z))})}),K};return tt(T)||(T=pt(T)),P(T)}function $t(T,{ignoreFieldNorm:g=O.ignoreFieldNorm}){T.forEach(D=>{let P=1;D.matches.forEach(({key:N,norm:k,score:$})=>{const K=N?N.weight:null;P*=Math.pow($===0&&K?Number.EPSILON:$,(K||1)*(g?1:k))}),D.score=P})}function Ft(T,g){const D=T.matches;g.matches=[],E(D)&&D.forEach(P=>{if(!E(P.indices)||!P.indices.length)return;const{indices:N,value:k}=P;let $={indices:N,value:k};P.key&&($.key=P.key.src),P.idx>-1&&($.refIndex=P.idx),g.matches.push($)})}function Ht(T,g){g.score=T.score}function Kt(T,g,{includeMatches:D=O.includeMatches,includeScore:P=O.includeScore}={}){const N=[];return D&&N.push(Ft),P&&N.push(Ht),T.map(k=>{const{idx:$}=k,K={item:g[$],refIndex:$};return N.length&&N.forEach(V=>{V(k,K)}),K})}class Me{constructor(g,D={},P){this.options={...O,...D},this.options.useExtendedSearch,this._keyStore=new M(this.options.keys),this.setCollection(g,P)}setCollection(g,D){if(this._docs=g,D&&!(D instanceof G))throw new Error(B);this._myIndex=D||ae(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(g){E(g)&&(this._docs.push(g),this._myIndex.add(g))}remove(g=()=>!1){const D=[];for(let P=0,N=this._docs.length;P<N;P+=1){const k=this._docs[P];g(k,P)&&(this.removeAt(P),P-=1,N-=1,D.push(k))}return D}removeAt(g){this._docs.splice(g,1),this._myIndex.removeAt(g)}getIndex(){return this._myIndex}search(g,{limit:D=-1}={}){const{includeMatches:P,includeScore:N,shouldSort:k,sortFn:$,ignoreFieldNorm:K}=this.options;let V=c(g)?c(this._docs[0])?this._searchStringList(g):this._searchObjectList(g):this._searchLogical(g);return $t(V,{ignoreFieldNorm:K}),k&&V.sort($),a(D)&&D>-1&&(V=V.slice(0,D)),Kt(V,this._docs,{includeMatches:P,includeScore:N})}_searchStringList(g){const D=Ze(g,this.options),{records:P}=this._myIndex,N=[];return P.forEach(({v:k,i:$,n:K})=>{if(!E(k))return;const{isMatch:V,score:Y,indices:z}=D.searchIn(k);V&&N.push({item:k,idx:$,matches:[{score:Y,value:k,norm:K,indices:z}]})}),N}_searchLogical(g){const D=ht(g,this.options),P=(K,V,Y)=>{if(!K.children){const{keyId:te,searcher:ie}=K,ue=this._findMatches({key:this._keyStore.get(te),value:this._myIndex.getValueForItemAtKeyId(V,te),searcher:ie});return ue&&ue.length?[{idx:Y,item:V,matches:ue}]:[]}const z=[];for(let te=0,ie=K.children.length;te<ie;te+=1){const ue=K.children[te],he=P(ue,V,Y);if(he.length)z.push(...he);else if(K.operator===Fe.AND)return[]}return z},N=this._myIndex.records,k={},$=[];return N.forEach(({$:K,i:V})=>{if(E(K)){let Y=P(D,K,V);Y.length&&(k[V]||(k[V]={idx:V,item:K,matches:[]},$.push(k[V])),Y.forEach(({matches:z})=>{k[V].matches.push(...z)}))}}),$}_searchObjectList(g){const D=Ze(g,this.options),{keys:P,records:N}=this._myIndex,k=[];return N.forEach(({$,i:K})=>{if(!E($))return;let V=[];P.forEach((Y,z)=>{V.push(...this._findMatches({key:Y,value:$[z],searcher:D}))}),V.length&&k.push({idx:K,item:$,matches:V})}),k}_findMatches({key:g,value:D,searcher:P}){if(!E(D))return[];let N=[];if(v(D))D.forEach(({v:k,i:$,n:K})=>{if(!E(k))return;const{isMatch:V,score:Y,indices:z}=P.searchIn(k);V&&N.push({score:Y,key:g,value:k,idx:$,norm:K,indices:z})});else{const{v:k,n:$}=D,{isMatch:K,score:V,indices:Y}=P.searchIn(k);K&&N.push({score:V,key:g,value:k,norm:$,indices:Y})}return N}}Me.version="6.6.2",Me.createIndex=ae,Me.parseIndex=se,Me.config=O,Me.parseQuery=ht,jt(kt)}),791:(function(b,n,u){u.r(n),u.d(n,{__DO_NOT_USE__ActionTypes:function(){return I},applyMiddleware:function(){return w},bindActionCreators:function(){return q},combineReducers:function(){return X},compose:function(){return M},createStore:function(){return B},legacy_createStore:function(){return W}});function v(t){"@babel/helpers - typeof";return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},v(t)}function l(t,s){if(v(t)!=="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var m=r.call(t,s);if(v(m)!=="object")return m;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(t)}function h(t){var s=l(t,"string");return v(s)==="symbol"?s:String(s)}function c(t,s,r){return s=h(s),s in t?Object.defineProperty(t,s,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[s]=r,t}function a(t,s){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(t);s&&(m=m.filter(function(C){return Object.getOwnPropertyDescriptor(t,C).enumerable})),r.push.apply(r,m)}return r}function p(t){for(var s=1;s<arguments.length;s++){var r=arguments[s]!=null?arguments[s]:{};s%2?a(Object(r),!0).forEach(function(m){c(t,m,r[m])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach(function(m){Object.defineProperty(t,m,Object.getOwnPropertyDescriptor(r,m))})}return t}function d(t){return"Minified Redux error #"+t+"; visit https://redux.js.org/Errors?code="+t+" for the full message or use the non-minified dev environment for full errors. "}var A=(function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"})(),E=function(){return Math.random().toString(36).substring(7).split("").join(".")},I={INIT:"@@redux/INIT"+E(),REPLACE:"@@redux/REPLACE"+E(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+E()}};function x(t){if(typeof t!="object"||t===null)return!1;for(var s=t;Object.getPrototypeOf(s)!==null;)s=Object.getPrototypeOf(s);return Object.getPrototypeOf(t)===s}function B(t,s,r){var m;if(typeof s=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(d(0));if(typeof s=="function"&&typeof r>"u"&&(r=s,s=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(d(1));return r(B)(t,s)}if(typeof t!="function")throw new Error(d(2));var C=t,j=s,R=[],O=R,H=!1;function F(){O===R&&(O=R.slice())}function G(){if(H)throw new Error(d(3));return j}function ae(Z){if(typeof Z!="function")throw new Error(d(4));if(H)throw new Error(d(5));var oe=!0;return F(),O.push(Z),function(){if(oe){if(H)throw new Error(d(6));oe=!1,F();var le=O.indexOf(Z);O.splice(le,1),R=null}}}function se(Z){if(!x(Z))throw new Error(d(7));if(typeof Z.type>"u")throw new Error(d(8));if(H)throw new Error(d(9));try{H=!0,j=C(j,Z)}finally{H=!1}for(var oe=R=O,pe=0;pe<oe.length;pe++){var le=oe[pe];le()}return Z}function re(Z){if(typeof Z!="function")throw new Error(d(10));C=Z,se({type:I.REPLACE})}function de(){var Z,oe=ae;return Z={subscribe:function(le){if(typeof le!="object"||le===null)throw new Error(d(11));function ce(){le.next&&le.next(G())}ce();var $e=oe(ce);return{unsubscribe:$e}}},Z[A]=function(){return this},Z}return se({type:I.INIT}),m={dispatch:se,subscribe:ae,getState:G,replaceReducer:re},m[A]=de,m}var W=B;function Q(t){Object.keys(t).forEach(function(s){var r=t[s],m=r(void 0,{type:I.INIT});if(typeof m>"u")throw new Error(d(12));if(typeof r(void 0,{type:I.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(d(13))})}function X(t){for(var s=Object.keys(t),r={},m=0;m<s.length;m++){var C=s[m];typeof t[C]=="function"&&(r[C]=t[C])}var j=Object.keys(r),R;try{Q(r)}catch(O){R=O}return function(H,F){if(H===void 0&&(H={}),R)throw R;for(var G=!1,ae={},se=0;se<j.length;se++){var re=j[se],de=r[re],Z=H[re],oe=de(Z,F);if(typeof oe>"u")throw F&&F.type,new Error(d(14));ae[re]=oe,G=G||oe!==Z}return G=G||j.length!==Object.keys(H).length,G?ae:H}}function L(t,s){return function(){return s(t.apply(this,arguments))}}function q(t,s){if(typeof t=="function")return L(t,s);if(typeof t!="object"||t===null)throw new Error(d(16));var r={};for(var m in t){var C=t[m];typeof C=="function"&&(r[m]=L(C,s))}return r}function M(){for(var t=arguments.length,s=new Array(t),r=0;r<t;r++)s[r]=arguments[r];return s.length===0?function(m){return m}:s.length===1?s[0]:s.reduce(function(m,C){return function(){return m(C.apply(void 0,arguments))}})}function w(){for(var t=arguments.length,s=new Array(t),r=0;r<t;r++)s[r]=arguments[r];return function(m){return function(){var C=m.apply(void 0,arguments),j=function(){throw new Error(d(15))},R={getState:C.getState,dispatch:function(){return j.apply(void 0,arguments)}},O=s.map(function(H){return H(R)});return j=M.apply(void 0,O)(C.dispatch),p(p({},C),{},{dispatch:j})}}}})},f={};function _(b){var n=f[b];if(n!==void 0)return n.exports;var u=f[b]={exports:{}};return o[b].call(u.exports,u,u.exports,_),u.exports}(function(){_.n=function(b){var n=b&&b.__esModule?function(){return b.default}:function(){return b};return _.d(n,{a:n}),n}})(),(function(){_.d=function(b,n){for(var u in n)_.o(n,u)&&!_.o(b,u)&&Object.defineProperty(b,u,{enumerable:!0,get:n[u]})}})(),(function(){_.o=function(b,n){return Object.prototype.hasOwnProperty.call(b,n)}})(),(function(){_.r=function(b){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(b,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(b,"__esModule",{value:!0})}})();var S={};return(function(){var b=_(373),n=_.n(b);_(187),_(883),_(789),_(686),S.default=n()})(),S=S.default,S})()})})(Ut)),Ut.exports}var mn=un();const pn=dn(mn);let Gt=null,Is=[],ge=null,be=null;function es(e,i={}){const o=typeof e=="string"?document.querySelector(e):e;return o?(o.style.visibility="hidden",o.style.opacity="0",new pn(o,{shouldSort:!1,allowHTML:!1,...i})):null}function Ve(e,i){if(!e)return;const o=i??e.value;e.classList.remove("payment-status-select--paid","payment-status-select--unpaid"),o==="paid"?e.classList.add("payment-status-select--paid"):e.classList.add("payment-status-select--unpaid")}function Cs(e){Is=Array.isArray(e)?[...e]:[]}function ws(){return Is}function St(e){return e&&ws().find(i=>String(i.id)===String(e))||null}function hn(e){if(!e)return"";const i=typeof e.title=="string"?e.title.trim():"";return i||y("projects.fallback.untitled","مشروع بدون اسم")}function fn(){const e=document.getElementById("res-company-share");if(!e||!e.checked)return null;const i=e.dataset.companyShare??e.value??os,o=U(String(i).replace("%","").trim()),f=parseFloat(o);return Number.isFinite(f)?f:os}function vn(e){if(!e)return!1;if(e.confirmed===!0)return!0;const i=typeof e.status=="string"?e.status.toLowerCase():"";return["confirmed","in_progress","completed"].includes(i)}function ls(e,i){if(!e)return"";if(e[i])return e[i];if(e[`${i}Datetime`])return e[`${i}Datetime`];if(e[`${i}datetime`])return e[`${i}datetime`];if(e[`${i}_datetime`])return e[`${i}_datetime`];const o=e[`${i}Date`]??e[`${i}_date`],f=e[`${i}Time`]??e[`${i}_time`];if(o){const _=typeof f=="string"&&f.trim()?f.trim():"00:00";return`${o}T${_}`}return""}function gn(e){if(!e)return"";const i=e.customerName??e.full_name??e.fullName??e.name??e.customer_name??"";return typeof i=="string"?i.trim():String(i||"").trim()}function Re({selectedValue:e=""}={}){const i=document.getElementById("res-customer");if(!i)return;const o=Jt()||[],f=y("reservations.create.placeholders.client","اختر عميلًا (اختياري)"),_=e?String(e):"";ge&&(ge.config.placeholderValue=f,ge.config.searchPlaceholderValue=f,ge.config.loadingText=y("common.loading","جاري التحميل..."),ge.config.noResultsText=y("common.noResults","لا توجد نتائج"),ge.config.noChoicesText=y("common.noChoices","لا توجد عناصر متاحة"));const S=new Set,b=o.filter(u=>u&&u.id!=null).map(u=>({value:String(u.id),label:gn(u)||y("customers.fallback.unnamed","عميل بدون اسم")})).filter(u=>!u.label||S.has(u.value)?!1:(S.add(u.value),!0)).sort((u,v)=>u.label.localeCompare(v.label,void 0,{sensitivity:"base"}));ge||(i.innerHTML="",ge=es(i,{searchEnabled:!0,searchChoices:!0,placeholder:!0,placeholderValue:f,searchPlaceholderValue:f,loadingText:y("common.loading","جاري التحميل..."),noResultsText:y("common.noResults","لا توجد نتائج"),noChoicesText:y("common.noChoices","لا توجد عناصر متاحة")}),i.addEventListener("change",()=>{fe()}));const n=i.closest(".choices");n&&(n.classList.add("choices--reservation-dark","choices--ready"),n.style.opacity="1"),ge.clearChoices(),ge.setChoices(b.map(u=>({value:u.value,label:u.label,selected:_&&u.value===_})),"value","label",!0),_&&b.some(u=>u.value===_)?ge.setChoiceByValue(_):(ge.removeActiveItems(!0),i.value="")}function ts({selectedValue:e="",projectsList:i=null}={}){const o=document.getElementById("res-project");if(!o)return;const f=Array.isArray(i)?i:ws()||[],_=y("reservations.create.placeholders.project","اختر مشروعاً (اختياري)"),S=e?String(e):"";be&&(be.config.placeholderValue=_,be.config.searchPlaceholderValue=_,be.config.loadingText=y("common.loading","جاري التحميل..."),be.config.noResultsText=y("common.noResults","لا توجد نتائج"),be.config.noChoicesText=y("common.noChoices","لا توجد عناصر متاحة"));const b=[...f].filter(u=>u&&u.id!=null).sort((u,v)=>String(v.createdAt||v.start||"").localeCompare(String(u.createdAt||u.start||"")));be||(o.innerHTML="",be=es(o,{searchEnabled:!0,searchChoices:!0,placeholder:!0,placeholderValue:_,searchPlaceholderValue:_,loadingText:y("common.loading","جاري التحميل..."),noResultsText:y("common.noResults","لا توجد نتائج"),noChoicesText:y("common.noChoices","لا توجد عناصر متاحة")}),o.addEventListener("change",()=>{const u=o.value,v=u?St(u):null;v?ss(v,{skipProjectSelectUpdate:!0}):(We(),fe())}));const n=o.closest(".choices");n&&(n.classList.add("choices--reservation-dark","choices--ready"),n.style.opacity="1"),be.clearChoices(),be.setChoices(b.map(u=>({value:String(u.id),label:hn(u),selected:S&&String(u.id)===S})),"value","label",!0),S&&b.some(u=>String(u.id)===S)?be.setChoiceByValue(S):(be.removeActiveItems(!0),o.value="")}function bt(e,i,o){const{date:f,time:_}=hs(o),S=document.getElementById(e),b=document.getElementById(i);if(S){if(f)if(S._flatpickr){const n=S._flatpickr.config?.dateFormat||"Y-m-d";S._flatpickr.setDate(f,!1,n)}else S.value=f;else S._flatpickr?S._flatpickr.clear():S.value="";S.dispatchEvent(new Event("input",{bubbles:!0})),S.dispatchEvent(new Event("change",{bubbles:!0}))}if(b){if(_)if(b._flatpickr){const n=b._flatpickr.config?.dateFormat||"H:i";b._flatpickr.setDate(_,!1,n)}else b.value=_;else b._flatpickr?b._flatpickr.clear():b.value="";b.dispatchEvent(new Event("input",{bubbles:!0})),b.dispatchEvent(new Event("change",{bubbles:!0}))}}function ss(e,{forceNotes:i=!1,skipProjectSelectUpdate:o=!1}={}){if(!e)return;const f=e?.id!=null?String(e.id):"";o||ts({selectedValue:f});const S=(Jt()||[]).find(l=>String(l.id)===String(e.clientId)),b=S?.id!=null?String(S.id):"";if(b)if(Re({selectedValue:b}),ge)ge.setChoiceByValue(b);else{const l=document.getElementById("res-customer");l&&(l.value=b)}else Re({selectedValue:""});const n=ls(e,"start"),u=ls(e,"end");n&&bt("res-start","res-start-time",n),u&&bt("res-end","res-end-time",u);const v=document.getElementById("res-notes");v&&e.description&&(i||!v.value)&&(v.value=e.description),We(),fe()}function ns({projectsList:e=null,preselectId:i=null}={}){const o=document.getElementById("res-project");if(!o)return;const{projects:f}=e?{projects:e}:_e(),_=Array.isArray(f)?f:[];Cs(_);const S=i!=null?String(i):be?be.getValue(!0):o.value;ts({selectedValue:S,projectsList:_}),We(),fe()}function We(){const e=document.getElementById("res-project"),i=document.getElementById("res-tax");if(!i)return;if(!!e?.value)i.checked=!1,i.disabled=!0,i.classList.add("disabled");else{const f=i.disabled;i.disabled=!1,i.classList.remove("disabled"),f&&(i.checked=!1)}}function bn(){const e=document.getElementById("res-project");!e||e.dataset.listenerAttached||(e.addEventListener("change",()=>{const i=e.value,o=i?St(i):null;o?ss(o,{skipProjectSelectUpdate:!0}):(We(),fe())}),e.dataset.listenerAttached="true")}function yn(){const e=new URLSearchParams(window.location.search),i=e.get("reservationProjectContext");if(!i)return;let o=null;try{const n=decodeURIComponent(i);o=JSON.parse(n)}catch(n){console.warn("⚠️ [reservations/createForm] Failed to decode project context",n)}e.delete("reservationProjectContext");const f=e.toString(),_=`${window.location.pathname}${f?`?${f}`:""}${window.location.hash||""}`;if(window.history.replaceState({},document.title,_),!o||!o.projectId)return;document.getElementById("res-project")&&(ts({selectedValue:String(o.projectId)}),We());const b=St(o.projectId);if(b?ss(b,{forceNotes:!!o.forceNotes}):fe(),o.start&&bt("res-start","res-start-time",o.start),o.end&&bt("res-end","res-end-time",o.end),o.customerId){const u=(Jt()||[]).find(v=>String(v.id)===String(o.customerId));u?.id!=null&&Re({selectedValue:String(u.id)})}else Re({selectedValue:""})}function It(){const e=document.getElementById("res-start")?.value?.trim(),i=document.getElementById("res-end")?.value?.trim(),o=document.getElementById("res-start-time")?.value?.trim()||"00:00",f=document.getElementById("res-end-time")?.value?.trim()||"00:00";return!e||!i?{start:null,end:null}:{start:at(e,o),end:at(i,f)}}function Ts(e){const i=De(e);if(!i)return null;const o=Es()||[],f=o.find(_=>De(_?.desc||_?.description||"")===i);return f||o.find(_=>De(_?.desc||_?.description||"").includes(i))||null}function As(e,i="equipment-description-options"){const o=De(e);if(!o)return!1;const f=document.getElementById(i);return f&&f.options&&Array.from(f.options).some(b=>De(b.value)===o)?!0:(Es()||[]).some(S=>De(S?.desc||S?.description||"")===o)}function Ge(){const e=document.getElementById("equipment-description-options"),i=document.getElementById("edit-res-equipment-description-options"),{equipment:o=[]}=_e(),f=Array.isArray(o)?o:[];Qs(f);const S=Array.from(new Set(f.map(b=>b?.desc||b?.description||"").filter(Boolean))).sort((b,n)=>b.localeCompare(n,"ar",{sensitivity:"base"})).map(b=>`<option value="${b}"></option>`).join("");e&&(e.innerHTML=S),i&&(i.innerHTML=S)}function Yt(e,i){const o=Ee(e);if(!o)return!1;const{start:f,end:_}=It();if(!f||!_)return J(y("reservations.toast.requireDatesBeforeAdd","⚠️ يرجى تحديد تاريخ ووقت البداية والنهاية قبل إضافة المعدات")),!1;if(ct().some(n=>Ee(n.barcode)===o))return J(y("reservations.toast.equipmentDuplicate","⚠️ هذه المعدة موجودة بالفعل في الحجز")),!1;if(Ue(o,f,_))return J(y("reservations.toast.equipmentTimeConflict","⚠️ لا يمكن إضافة المعدة لأنها محجوزة في نفس الفترة الزمنية")),!1;const b=Zt(o);return b?Ye(b.barcode)?(J(y("reservations.toast.equipmentMaintenance","⚠️ هذه المعدة قيد الصيانة ولا يمكن إضافتها حالياً")),!1):(fs({id:b.id,equipmentId:b.id,barcode:o,desc:b.desc,qty:1,price:b.price,image:lt(b)}),i&&(i.value=""),ze(),fe(),J(y("reservations.toast.equipmentAdded","✅ تم إضافة المعدة بنجاح")),!0):(J(y("reservations.toast.barcodeNotFound","❌ الباركود غير موجود")),!1)}function zt(e){if(!e)return;const i=e.value.trim();if(!i)return;const o=Ts(i);if(!o){J(y("reservations.toast.equipmentNameNotFound","❌ لم يتم العثور على معدة بالاسم المدخل"));return}if(ln(o.barcode)?.status==="صيانة"){J(y("reservations.toast.equipmentMaintenance","⚠️ هذه المعدة قيد الصيانة ولا يمكن إضافتها حالياً"));return}const _=Ee(o.barcode);if(!_){J(y("reservations.toast.equipmentMissingBarcode","⚠️ هذه المعدة لا تحتوي على باركود معرف"));return}const S={id:o.id,equipmentId:o.id,barcode:_,desc:o.desc||o.description||o.name||"",qty:1,price:Number.isFinite(Number(o.price))?Number(o.price):0,image:lt(o)},{start:b,end:n}=It();if(!b||!n){J(y("reservations.toast.requireDatesBeforeAdd","⚠️ يرجى تحديد تاريخ ووقت البداية والنهاية قبل إضافة المعدات"));return}if(ct().some(l=>Ee(l.barcode)===_)){J(y("reservations.toast.equipmentDuplicate","⚠️ هذه المعدة موجودة بالفعل في الحجز"));return}if(Ue(_,b,n)){J(y("reservations.toast.equipmentTimeConflict","⚠️ لا يمكن إضافة المعدة لأنها محجوزة في نفس الفترة الزمنية"));return}if(Ye(_)){J(y("reservations.toast.equipmentMaintenance","⚠️ هذه المعدة قيد الصيانة ولا يمكن إضافتها حالياً"));return}fs(S),ze(),fe(),e.value=""}function En(){Ge();const e=document.getElementById("equipment-description");if(e&&!e.dataset.listenerAttached){e.addEventListener("keydown",o=>{o.key==="Enter"&&(o.preventDefault(),zt(e))});const i=()=>{As(e.value,"equipment-description-options")&&zt(e)};e.addEventListener("input",i),e.addEventListener("change",i),e.dataset.listenerAttached="true"}}function ze(e="reservation-items"){const i=document.getElementById(e);if(!i)return;const o=ct(),f=y("reservations.create.equipment.noneAdded","لا توجد معدات مضافة"),_=y("reservations.create.summary.currency","ريال"),S=y("reservations.create.equipment.imageAlt","صورة");if(o.length===0){i.innerHTML=`<tr><td colspan="5">${f}</td></tr>`;return}i.innerHTML=o.map((b,n)=>{const u=lt(b),v=`${U(String(b.price??0))} ${_}`,l=u?`<img src="${u}" alt="${S}" class="reservation-item-thumb">`:"-";return`
        <tr>
          <td>${b.barcode||"-"}</td>
          <td>${b.desc}</td>
          <td>${v}</td>
          <td>${l}</td>
          <td><button type="button" class="reservation-remove-button" data-action="remove-item" data-index="${n}">🗑️</button></td>
        </tr>
      `}).join("")}function fe(){const e=document.getElementById("res-discount")?.value||"0",i=parseFloat(U(e))||0,o=document.getElementById("res-discount-type")?.value||"percent",f=!!document.getElementById("res-project")?.value,_=document.getElementById("res-tax"),S=f?!1:_?.checked||!1,b=document.getElementById("res-payment-status")?.value||"unpaid",{start:n,end:u}=It(),v=fn(),l=document.getElementById("res-payment-status");Ve(l,b),Ks({selectedItems:ct(),discount:i,discountType:o,applyTax:S,paidStatus:b,start:n,end:u,companySharePercent:v})}function _n(){const e=document.getElementById("res-discount");e&&!e.dataset.listenerAttached&&(e.addEventListener("input",S=>{S.target.value=U(S.target.value),fe()}),e.dataset.listenerAttached="true");const i=document.getElementById("res-discount-type");i&&!i.dataset.listenerAttached&&(i.addEventListener("change",fe),i.dataset.listenerAttached="true");const o=document.getElementById("res-tax");o&&!o.dataset.listenerAttached&&(o.addEventListener("change",fe),o.dataset.listenerAttached="true");const f=document.getElementById("res-company-share");f&&!f.dataset.listenerAttached&&(f.addEventListener("change",fe),f.dataset.listenerAttached="true");const _=document.getElementById("res-payment-status");_&&!_.dataset.listenerAttached&&(_.addEventListener("change",()=>{Ve(_),fe()}),_.dataset.listenerAttached="true"),Ve(_)}function Sn(){const e=document.getElementById("res-start-time"),i=document.getElementById("res-end-time");if(!e||!i||e.dataset.timeSyncAttached)return;let o=!1;const f=()=>{const _=e.value?.trim();if(!_){fe();return}const S=i.dataset.syncedWithStart;(!i.value?.trim()||S!=="false")&&(o=!0,i.value=_,i.dataset.syncedWithStart="true",i.dataset.syncedValue=_,i.dispatchEvent(new Event("input",{bubbles:!0})),i.dispatchEvent(new Event("change",{bubbles:!0})),o=!1),fe()};e.addEventListener("change",f),e.addEventListener("input",f),e.addEventListener("blur",f),i.addEventListener("input",()=>{o||(i.value===e.value?(i.dataset.syncedWithStart="true",i.dataset.syncedValue=i.value):i.dataset.syncedWithStart="false")}),i.value?.trim()||f(),e.dataset.timeSyncAttached="true"}async function ds(){const e=document.getElementById("res-customer"),i=document.getElementById("res-project"),o=e?.value?String(e.value):"",f=i?.value?String(i.value):"",{customers:_}=_e(),S=_.find(s=>String(s.id)===o);if(!S){J(y("reservations.toast.customerNotFound","⚠️ لم يتم العثور على العميل بالاسم المدخل"));return}const b=S.id,n=document.getElementById("res-start").value,u=document.getElementById("res-end").value,v=document.getElementById("res-start-time")?.value||"00:00",l=document.getElementById("res-end-time")?.value||"00:00";if(!n||!u){J(y("reservations.toast.requireDates","⚠️ يرجى تحديد تاريخ البداية والنهاية"));return}const h=`${n}T${v}`,c=`${u}T${l}`,a=new Date(h),p=new Date(c);if(Number.isNaN(a.getTime())||Number.isNaN(p.getTime())||a>=p){J(y("reservations.toast.invalidDateRange","⚠️ تأكد من أن تاريخ ووقت البداية يسبق تاريخ ووقت النهاية"));return}const d=Ys(),A=ct();if(A.length===0&&d.length===0){J(y("reservations.toast.noItems","⚠️ يجب إضافة معدة أو عضو واحد من الطاقم الفني على الأقل"));return}const E=document.getElementById("res-notes")?.value||"",I=parseFloat(U(document.getElementById("res-discount")?.value))||0,x=document.getElementById("res-discount-type")?.value||"percent",B=document.getElementById("res-payment-status")?.value||"unpaid",W=f?St(f):null,Q=vn(W);if(f&&!W){J(y("reservations.toast.projectNotFound","⚠️ لم يتم العثور على المشروع المحدد. حاول تحديث الصفحة."));return}for(const s of A)if(Ye(s.barcode)){J(y("reservations.toast.cannotCreateEquipmentMaintenance","⚠️ لا يمكن إتمام الحجز لأن إحدى المعدات قيد الصيانة"));return}for(const s of A){const r=Ee(s.barcode);if(Ue(r,h,c)){J(y("reservations.toast.cannotCreateEquipmentConflict","⚠️ لا يمكن إتمام الحجز، إحدى المعدات محجوزة في نفس الفترة الزمنية"));return}}for(const s of d)if(vs(s,h,c)){J(y("reservations.toast.cannotCreateCrewConflict","⚠️ لا يمكن إتمام الحجز، أحد أعضاء الطاقم مرتبط بحجز آخر في نفس الفترة"));return}const X=document.getElementById("res-tax"),q=!!f?!1:X?.checked||!1,M=gs(A,I,x,q,d,{start:h,end:c}),w=$s(),t=bs({reservationCode:w,customerId:b,start:h,end:c,status:Q?"confirmed":"pending",title:null,location:null,notes:E,projectId:f||null,totalAmount:M,discount:I,discountType:x,applyTax:q,paidStatus:B,confirmed:Q,items:A.map(s=>({...s,equipmentId:s.equipmentId??s.id})),technicians:d});try{const s=await Ws(t);Gs(),Ge(),_t(),In(),J(y("reservations.toast.created","✅ تم إنشاء الحجز")),typeof Gt=="function"&&Gt({type:"created",reservation:s})}catch(s){console.error("❌ [reservations/createForm] Failed to create reservation",s);const r=ys(s)?s.message:y("reservations.toast.createFailed","تعذر إنشاء الحجز، حاول مرة أخرى");J(r,"error")}}function In(){const e=document.getElementById("res-customer");ge?ge.removeActiveItems():e&&(e.value=""),document.getElementById("res-start").value="",document.getElementById("res-start-time").value="",document.getElementById("res-end").value="",document.getElementById("res-end-time").value="",document.getElementById("res-notes").value="",document.getElementById("res-discount").value="";const i=document.getElementById("res-tax");i&&(i.checked=!1,i.disabled=!1,i.classList.remove("disabled"));const o=document.getElementById("res-company-share");o&&(o.checked=!1);const f=document.getElementById("res-project");be?be.removeActiveItems():f&&(f.value="");const _=document.getElementById("equipment-description");_&&(_.value="");const S=document.getElementById("res-payment-status");S&&(S.value="unpaid",Ve(S,"unpaid")),zs(),Xs([]),ze(),We(),fe()}function Cn(){const e=document.getElementById("reservation-items");!e||e.dataset.listenerAttached||(e.addEventListener("click",i=>{const o=i.target.closest('button[data-action="remove-item"]');if(!o)return;const f=Number(o.dataset.index);Us(f),ze(),fe()}),e.dataset.listenerAttached="true")}function wn(){const e=document.getElementById("equipment-barcode");if(!e||e.dataset.listenerAttached)return;e.addEventListener("keydown",f=>{f.key==="Enter"&&(f.preventDefault(),Yt(e.value,e))});let i=null;const o=()=>{clearTimeout(i);const f=e.value;if(!f?.trim())return;const{start:_,end:S}=It();!_||!S||(i=setTimeout(()=>{Yt(f,e)},150))};e.addEventListener("input",o),e.addEventListener("change",()=>Yt(e.value,e)),e.dataset.listenerAttached="true"}function Tn(){const e=document.getElementById("reservation-form");e&&!e.dataset.listenerAttached&&(e.addEventListener("submit",async o=>{o.preventDefault(),await ds()}),e.dataset.listenerAttached="true");const i=document.getElementById("create-reservation-btn");i&&!i.dataset.listenerAttached&&(i.addEventListener("click",async o=>{o.preventDefault(),await ds()}),i.dataset.listenerAttached="true")}function Jn({onAfterSubmit:e}={}){Gt=typeof e=="function"?e:null;const{customers:i,projects:o}=_e();Vs(i||[]),Re(),Cs(o||[]),ns({projectsList:o}),bn(),Ge(),En(),Sn(),_n(),Cn(),wn(),Tn(),yn(),fe(),ze()}function Ls(){Ge(),ns(),Re(),ze(),fe()}if(typeof document<"u"){const e=()=>{Re(),ns(),fe()};document.addEventListener("language:changed",e),document.addEventListener("language:translationsReady",e)}typeof document<"u"&&document.addEventListener("DOMContentLoaded",()=>{const e=document.documentElement.classList.contains("dark")||document.documentElement.classList.contains("dark-mode")||document.body.classList.contains("dark-mode");Object.entries({"#res-customer":{placeholder:"اكتب اسم العميل..."},"#res-project":{placeholder:"اختر مشروعاً (اختياري)"}}).forEach(([o,{placeholder:f}])=>{const _=document.querySelector(o);if(!_||_.dataset.darkChoicesBootstrap==="true")return;_.dataset.darkChoicesBootstrap="true",_.style.opacity="0";const S=es(_,{placeholder:!0,placeholderValue:f,searchPlaceholderValue:f});o==="#res-customer"?ge=S:be=S,setTimeout(()=>{const b=_.closest(".choices");b&&(b.classList.add("choices--ready"),e&&b.classList.add("choices--reservation-dark"),b.style.opacity="1",b.style.transition="opacity 0.15s ease-in"),_.style.display="none",_.style.visibility="hidden"},150)})});typeof window<"u"&&window.addEventListener("load",()=>{document.querySelectorAll(".choices").forEach(e=>{e.style.opacity="0",setTimeout(()=>{e.style.transition="opacity 0.15s ease-in",e.style.opacity="1"},150)})});function Ds(e){const i=new Date;if(i.setHours(0,0,0,0),e==="today")return{startDate:ke(i),endDate:ke(i)};if(e==="week"){const o=new Date(i),f=o.getDay(),_=f===0?6:f-1;o.setDate(o.getDate()-_);const S=new Date(o);return S.setDate(o.getDate()+6),{startDate:ke(o),endDate:ke(S)}}if(e==="month"){const o=new Date(i.getFullYear(),i.getMonth(),1),f=new Date(i.getFullYear(),i.getMonth()+1,0);return{startDate:ke(o),endDate:ke(f)}}return e==="upcoming"?{startDate:ke(i),endDate:""}:{startDate:"",endDate:""}}function An(){const e=document.getElementById("search-reservation"),i=document.getElementById("filter-start-date"),o=document.getElementById("filter-end-date"),f=document.getElementById("reservation-date-range"),_=document.getElementById("reservation-status-filter");let S=U(i?.value||"").trim(),b=U(o?.value||"").trim(),n=f?.value||"";if(new Set(["","today","week","month"]).has(n)||(n="",f&&(f.value=""),yt(i),yt(o),S="",b=""),!S&&!b&&n){const v=Ds(n);S=v.startDate,b=v.endDate}return{searchTerm:De(e?.value||""),startDate:S,endDate:b,status:_?.value||"",quickRange:n}}function Zn(e){const i=()=>{typeof e=="function"&&e()},o=document.getElementById("search-reservation");o&&!o.dataset.listenerAttached&&(o.addEventListener("input",()=>{o.value=U(o.value),i()}),o.dataset.listenerAttached="true");const f=document.getElementById("filter-start-date");f&&!f.dataset.listenerAttached&&(f.addEventListener("change",()=>{const u=document.getElementById("reservation-date-range");u&&(u.value=""),i()}),f.dataset.listenerAttached="true");const _=document.getElementById("filter-end-date");_&&!_.dataset.listenerAttached&&(_.addEventListener("change",()=>{const u=document.getElementById("reservation-date-range");u&&(u.value=""),i()}),_.dataset.listenerAttached="true");const S=document.getElementById("reservation-date-range");S&&!S.dataset.listenerAttached&&(S.addEventListener("change",()=>{Ln(S.value),i()}),S.dataset.listenerAttached="true");const b=document.getElementById("reservation-status-filter");b&&!b.dataset.listenerAttached&&(b.addEventListener("change",i),b.dataset.listenerAttached="true");const n=document.getElementById("clear-filters");n&&!n.dataset.listenerAttached&&(n.addEventListener("click",()=>{o&&(o.value=""),yt(f),yt(_),S&&(S.value=""),b&&(b.value=""),i()}),n.dataset.listenerAttached="true")}function Ln(e){const i=document.getElementById("filter-start-date"),o=document.getElementById("filter-end-date");if(!i||!o)return;const{startDate:f,endDate:_}=Ds(e);i._flatpickr?f?i._flatpickr.setDate(f,!1,"Y-m-d"):i._flatpickr.clear():i.value=f,o._flatpickr?_?o._flatpickr.setDate(_,!1,"Y-m-d"):o._flatpickr.clear():o.value=_}function ke(e){if(!e)return"";const i=e.getTimezoneOffset()*6e4;return new Date(e.getTime()-i).toISOString().split("T")[0]}function yt(e){e&&(e._flatpickr&&e._flatpickr.clear(),e.value="")}function Dn({reservations:e=[],filters:i={},customersMap:o,techniciansMap:f,projectsMap:_}){const S=e.map((E,I)=>({reservation:E,index:I})),b=i.searchTerm||"",n=i.searchReservationId||"",u=i.searchCustomerName||"",v=i.startDate||"",l=i.endDate||"",h=i.status||"",c=Object.prototype.hasOwnProperty.call(i,"customerId")?i.customerId:null,a=Object.prototype.hasOwnProperty.call(i,"technicianId")?i.technicianId:null,p=v?new Date(`${v}T00:00:00`):null,d=l?new Date(`${l}T23:59:59`):null,A=S.filter(({reservation:E})=>{const I=o.get(String(E.customerId)),x=_?.get?.(String(E.projectId)),B=E.start?new Date(E.start):null,W=rt(E),{effectiveConfirmed:Q}=Be(E,x);if(c!=null&&String(E.customerId)!==String(c)||a!=null&&!(Array.isArray(E.technicians)?E.technicians.map(w=>String(w)):[]).includes(String(a))||h==="confirmed"&&!Q||h==="pending"&&Q||h==="completed"&&!W||p&&B&&B<p||d&&B&&B>d||n&&!De([E.reservationId,E.id].filter(Boolean).map(String).join(" ")).includes(n)||u&&!De(I?.customerName||"").includes(u))return!1;if(!b)return!0;const X=E.items?.map?.(M=>`${M.barcode} ${M.desc}`).join(" ")||"",L=(E.technicians||[]).map(M=>f.get(String(M))?.name).filter(Boolean).join(" ");return De([E.reservationId,I?.customerName,E.notes,X,L,x?.title].filter(Boolean).join(" ")).includes(b)});return A.sort((E,I)=>{const x=rt(E.reservation),B=rt(I.reservation);if(x!==B)return x?1:-1;const W=E.reservation.start?new Date(E.reservation.start).getTime():0;return(I.reservation.start?new Date(I.reservation.start).getTime():0)-W}),A}function On({entries:e,customersMap:i,techniciansMap:o,projectsMap:f}){const _=y("reservations.create.summary.currency","ريال"),S=y("reservations.list.taxIncludedShort","(شامل الضريبة)"),b=y("reservations.list.unknownCustomer","غير معروف"),n=y("reservations.list.noNotes","لا توجد ملاحظات"),u=y("reservations.list.itemsCountShort","{count} عنصر"),v=y("reservations.list.crew.separator","، "),l=y("reservations.list.status.confirmed","✅ مؤكد"),h=y("reservations.list.status.pending","⏳ غير مؤكد"),c=y("reservations.list.payment.paid","💳 مدفوع"),a=y("reservations.list.payment.unpaid","💳 غير مدفوع"),p=y("reservations.list.actions.confirm","✔️ تأكيد"),d=y("reservations.list.project.unlinked","غير مرتبط بمشروع"),A=y("reservations.edit.project.missing","⚠️ المشروع غير متوفر (تم حذفه)"),E={client:y("reservations.list.labels.client","👤 العميل"),project:y("reservations.list.labels.project","📁 المشروع"),start:y("reservations.list.labels.start","🗓️ بداية الحجز"),end:y("reservations.list.labels.end","🗓️ نهاية الحجز"),cost:y("reservations.list.labels.cost","💵 التكلفة"),equipment:y("reservations.list.labels.equipment","📦 المعدات"),crew:y("reservations.list.labels.crew","😎 الفريق")};return e.map(({reservation:I,index:x})=>{const B=i.get(String(I.customerId)),W=I.projectId?f?.get?.(String(I.projectId)):null,Q=rt(I),X=I.paid===!0||I.paid==="paid",{effectiveConfirmed:L,projectLinked:q}=Be(I,W);let M=L?`<span class="badge bg-success reservation-chip">${l}</span>`:`<span class="badge bg-warning text-dark reservation-chip">${h}</span>`,w=X?`<span class="badge bg-primary reservation-chip">${c}</span>`:`<span class="badge bg-danger reservation-chip">${a}</span>`,t=X?" tile-paid":" tile-unpaid";Q&&(t+=" tile-completed");let s="";Q&&(M=`<span class="badge reservation-chip chip-completed">${l}</span>`,w=`<span class="badge reservation-chip chip-completed">${X?c:a}</span>`,s=` data-completed-label="${y("reservations.list.ribbon.completed","منتهي").replace(/"/g,"&quot;")}"`);const r=!q&&!L?`<button class="btn btn-sm btn-success tile-confirm" data-reservation-index="${x}" data-action="confirm">${p}</button>`:"",m=I.items?.length||0,C=(I.technicians||[]).map(Z=>o.get(String(Z))).filter(Boolean),j=C.map(Z=>Z.name).join(v)||"—",R=U(String(I.reservationId??"")),O=I.start?U(je(I.start)):"-",H=I.end?U(je(I.end)):"-",F=U(String(I.cost??0)),G=U(String(m)),ae=I.notes?U(I.notes):n,se=u.replace("{count}",G),re=I.applyTax?`<small>${S}</small>`:"";let de=d;return I.projectId&&(de=W?.title?U(W.title):A),`
      <div class="reservation-tile${t}"${s} data-reservation-index="${x}" data-action="details">
        <div class="tile-top">
          <div class="tile-id">${R}</div>
          <div class="tile-badges">
            ${M}
            ${w}
          </div>
        </div>
        <div class="tile-body">
          <div class="tile-row">
            <span class="tile-label">${E.client}</span>
            <span class="tile-value">${B?.customerName||b}</span>
          </div>
          <div class="tile-row">
            <span class="tile-label">${E.project}</span>
            <span class="tile-value">${de}</span>
          </div>
          <div class="tile-row">
            <span class="tile-label">${E.start}</span>
            <span class="tile-value tile-inline">${O}</span>
          </div>
          <div class="tile-row">
            <span class="tile-label">${E.end}</span>
            <span class="tile-value tile-inline">${H}</span>
          </div>
          <div class="tile-row">
            <span class="tile-label">${E.cost}</span>
            <span class="tile-value">${F} ${_} ${re}</span>
          </div>
          <div class="tile-row">
            <span class="tile-label">${E.equipment}</span>
            <span class="tile-value">${se}</span>
          </div>
          <div class="tile-row">
            <span class="tile-label">${E.crew}</span>
            <span class="tile-value">${C.length?j:"—"}</span>
          </div>
        </div>
        <div class="tile-footer">
          <span class="tile-notes">📝 ${ae}</span>
          ${r}
        </div>
      </div>
    `}).join("")}function Wt(e=""){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function Pn(e,i,o=[],f,_=null){const{projectLinked:S,effectiveConfirmed:b}=Be(e,_),n=e.paid===!0||e.paid==="paid",u=rt(e),v=e.items||[],{technicians:l=[]}=_e(),h=[].concat(Array.isArray(o)?o:[]).concat(Array.isArray(l)?l:[]),c=new Map;h.forEach(ee=>{if(!ee||ee.id==null)return;const me=String(ee.id),we=c.get(me)||{};c.set(me,{...we,...ee})});const a=(e.technicians||[]).map(ee=>c.get(String(ee))).filter(Boolean),p=ps(),d=_s(e.start,e.end),A=(ee={})=>{const me=[ee.dailyWage,ee.daily_rate,ee.dailyRate,ee.wage,ee.rate];for(const we of me){if(we==null)continue;const Ke=parseFloat(U(String(we)));if(Number.isFinite(Ke))return Ke}return 0},I=v.reduce((ee,me)=>ee+(me.qty||1)*(me.price||0),0)*d,B=a.reduce((ee,me)=>ee+A(me),0)*d,W=I+B,Q=parseFloat(e.discount)||0,X=e.discountType==="amount"?Q:W*(Q/100),L=Math.max(0,W-X),q=S?!1:e.applyTax,M=q?L*.15:0,w=Number(e.cost),t=Number.isFinite(w),s=L+M,r=S?Math.round(s):t?w:Math.round(s),m=e.companySharePercent??e.company_share_percent??e.companyShare??e.company_share,C=m!=null?parseFloat(U(String(m))):NaN,O=((e.companyShareEnabled??e.company_share_enabled??e.companyShareApplied)===!0||Number.isFinite(C)&&C>0)&&Number.isFinite(C)?C:0,H=O>0?Math.max(0,(Number.isFinite(r)?r:0)*(O/100)):0,F=U(String(e.reservationId??e.id??"")),G=e.start?U(je(e.start)):"-",ae=e.end?U(je(e.end)):"-",se=U(String(a.length)),re=U(I.toFixed(2)),de=U(X.toFixed(2)),Z=U(L.toFixed(2)),oe=U(M.toFixed(2)),pe=U((r??0).toFixed(2)),le=U(String(d)),ce=y("reservations.create.summary.currency","ريال"),$e=y("reservations.details.labels.discount","الخصم"),At=y("reservations.details.labels.tax","الضريبة (15%)"),Lt=y("reservations.details.labels.crewTotal","إجمالي الفريق"),Dt=y("reservations.details.labels.subtotalAfterDiscount","الإجمالي"),Ot=y("reservations.details.labels.duration","عدد الأيام"),Pt=y("reservations.details.labels.companyShare","🏦 نسبة الشركة"),qe={index:"#",code:y("reservations.details.table.headers.code","الكود"),description:y("reservations.details.table.headers.description","الوصف"),quantity:y("reservations.details.table.headers.quantity","الكمية"),price:y("reservations.details.table.headers.price","السعر"),image:y("reservations.details.table.headers.image","الصورة")},dt=y("reservations.details.noItems","📦 لا توجد معدات ضمن هذا الحجز حالياً."),ut=y("reservations.details.noCrew","😎 لا يوجد فريق مرتبط بهذا الحجز."),Qe=y("reservations.details.technicians.roleUnknown","غير محدد"),mt=y("reservations.details.technicians.phoneUnknown","غير متوفر"),qt=y("reservations.details.technicians.wage","{amount} {currency} / اليوم"),Mt=y("reservations.list.status.confirmed","✅ مؤكد"),Nt=y("reservations.list.status.pending","⏳ غير مؤكد"),xt=y("reservations.list.payment.paid","💳 مدفوع"),kt=y("reservations.list.payment.unpaid","💳 غير مدفوع"),Je=y("reservations.list.status.completed","📁 منتهي"),jt=y("reservations.details.labels.id","🆔 رقم الحجز"),Ze=y("reservations.details.section.bookingInfo","بيانات الحجز"),Fe=y("reservations.details.section.paymentSummary","ملخص الدفع"),et=y("reservations.details.labels.finalTotal","المجموع النهائي"),tt=y("reservations.details.section.crew","😎 الفريق الفني"),Rt=y("reservations.details.crew.count","{count} عضو"),Bt=y("reservations.details.section.items","📦 المعدات المرتبطة"),pt=y("reservations.details.items.count","{count} عنصر"),ht=y("reservations.details.actions.edit","✏️ تعديل"),$t=y("reservations.details.actions.delete","🗑️ حذف"),Ft=y("reservations.details.labels.customer","العميل"),Ht=y("reservations.details.labels.contact","رقم التواصل"),Kt=y("reservations.details.labels.project","📁 المشروع المرتبط");y("reservations.details.project.unlinked","غير مرتبط بأي مشروع.");const Me=y("reservations.edit.project.missing","⚠️ المشروع غير متوفر (تم حذفه)"),T=y("reservations.details.actions.openProject","📁 فتح المشروع"),g=y("reservations.details.labels.start","بداية الحجز"),D=y("reservations.details.labels.end","نهاية الحجز"),P=y("reservations.details.labels.notes","ملاحظات"),N=y("reservations.list.noNotes","لا توجد ملاحظات"),k=y("reservations.details.labels.itemsCount","عدد المعدات"),$=y("reservations.details.labels.itemsTotal","إجمالي المعدات"),K=y("reservations.details.labels.paymentStatus","حالة الدفع"),V=y("reservations.list.unknownCustomer","غير معروف"),Y=n?xt:kt,z=v.length,te=U(String(z)),ie=pt.replace("{count}",te),ue=Rt.replace("{count}",se),he=e.notes?U(e.notes):N,Ie=U(B.toFixed(2)),Oe=U(String(O)),Le=U(H.toFixed(2)),Ne=`${Oe}% (${Le} ${ce})`,Se=[{icon:"💳",label:K,value:Y},{icon:"📦",label:k,value:ie},{icon:"⏱️",label:Ot,value:le},{icon:"💼",label:$,value:`${re} ${ce}`}];Se.push({icon:"😎",label:Lt,value:`${Ie} ${ce}`}),X>0&&Se.push({icon:"💸",label:$e,value:`${de} ${ce}`}),Se.push({icon:"📊",label:Dt,value:`${Z} ${ce}`}),q&&M>0&&Se.push({icon:"🧾",label:At,value:`${oe} ${ce}`}),O>0&&Se.push({icon:"🏦",label:Pt,value:Ne}),Se.push({icon:"💰",label:et,value:`${pe} ${ce}`});const He=Se.map(({icon:ee,label:me,value:we})=>`
    <div class="summary-details-row">
      <span class="summary-details-label">${ee} ${me}</span>
      <span class="summary-details-value">${we}</span>
    </div>
  `).join(""),ft=[{text:b?Mt:Nt,className:b?"status-confirmed":"status-pending"},{text:Y,className:n?"status-paid":"status-unpaid"}];u&&ft.push({text:Je,className:"status-completed"});const st=ft.map(({text:ee,className:me})=>`<span class="status-chip ${me}">${ee}</span>`).join(""),ve=(ee,me,we)=>`
    <div class="res-info-row">
      <span class="label">${ee} ${me}</span>
      <span class="value">${we}</span>
    </div>
  `;let Te="";if(e.projectId){let ee=Wt(Me);if(_){const me=_.title||y("projects.fallback.untitled","مشروع بدون اسم");ee=`${Wt(me)} <button type="button" class="btn btn-sm btn-outline-primary" data-action="open-project" data-project-id="${_.id}">${Wt(T)}</button>`}Te=`
      <div class="res-info-row">
        <span class="label">📁 ${Kt}</span>
        <span class="value">${ee}</span>
      </div>
    `}const ye=[];ye.push(ve("👤",Ft,i?.customerName||V)),ye.push(ve("📞",Ht,i?.phone||"—")),ye.push(ve("🗓️",g,G)),ye.push(ve("🗓️",D,ae)),ye.push(ve("📝",P,he)),Te&&ye.push(Te);const vt=ye.join(""),nt=z?v.map((ee,me)=>{const we=lt(ee),Ke=U(String(ee.barcode||"-")),Vt=U(String(ee.qty||1)),gt=U(String(ee.price||0)),js=U(String(me+1)),Rs=we?`<img src="${we}" alt="${ee.desc||""}" class="reservation-modal-item-thumb">`:"-";return`
          <tr>
            <td>${js}</td>
            <td>${Ke}</td>
            <td>${ee.desc||"-"}</td>
            <td>${Vt}</td>
            <td>${gt} ${ce}</td>
            <td>${Rs}</td>
          </tr>
        `}).join(""):`<tr><td colspan="6" class="text-center">${dt}</td></tr>`,xe=`
    <div class="table-responsive reservation-modal-items-wrapper">
      <table class="table table-sm table-hover align-middle reservation-modal-items-table">
        <thead>
          <tr>
            <th>${qe.index}</th>
            <th>${qe.code}</th>
            <th>${qe.description}</th>
            <th>${qe.quantity}</th>
            <th>${qe.price}</th>
            <th>${qe.image}</th>
          </tr>
        </thead>
        <tbody>${nt}</tbody>
      </table>
    </div>
  `,as=a.map((ee,me)=>{const we=U(String(me+1)),Ke=ee.role||Qe,Vt=ee.phone||mt,gt=ee.wage?qt.replace("{amount}",U(String(ee.wage))).replace("{currency}",ce):"";return`
      <div class="reservation-technician-card">
        <div class="technician-card-head">
          <span class="technician-index">${we}</span>
          <span class="technician-name">${ee.name}</span>
        </div>
        <div class="technician-card-body">
          <div>🎯 ${Ke}</div>
          <div>📞 ${Vt}</div>
          ${gt?`<div>💰 ${gt}</div>`:""}
        </div>
      </div>
    `}).join(""),Ce=a.length?`<div class="reservation-technicians-grid">${as}</div>`:`<ul class="reservation-modal-technicians"><li>${ut}</li></ul>`;return`
    <div class="reservation-modal">
      <div class="reservation-modal-header">
        <div class="reservation-modal-id">
          <span>${jt}</span>
          <strong>${F}</strong>
        </div>
        <div class="status-chips">
          ${st}
        </div>
      </div>

      <div class="reservation-modal-grid">
        <div class="reservation-info-card">
          <h6>${Ze}</h6>
          ${vt}
        </div>
        <div class="reservation-summary-card">
          <div class="summary-icon">💳</div>
          <div class="summary-body">
            <h6 class="summary-heading">${Fe}</h6>
            <div class="summary-details">
              ${He}
            </div>
          </div>
        </div>
      </div>

      <div class="reservation-technicians-section">
        <div class="section-title">
          <span>${tt}</span>
          <span class="count">${ue}</span>
        </div>
        ${Ce}
      </div>

      <div class="reservation-items-section">
        <div class="section-title">
          <span>${Bt}</span>
          <span class="count">${ie}</span>
        </div>
        ${xe}
      </div>

      <div class="reservation-modal-actions">
        <button type="button" class="btn btn-outline-primary" id="reservation-details-export-btn" data-index="${f}">
          ${y("reservations.details.actions.exportPdf","📄 تصدير PDF")}
        </button>
        <button type="button" class="btn btn-warning" id="reservation-details-edit-btn" data-index="${f}">${ht}</button>
        ${p?`<button type="button" class="btn btn-danger" id="reservation-details-delete-btn" data-index="${f}">${$t}</button>`:""}
      </div>
    </div>
  `}const qn="https://cdn.jsdelivr.net/npm/html2pdf.js@0.10.1/dist/html2pdf.bundle.min.js";function Mn(e){return new Promise((i,o)=>{const f=document.querySelector(`script[src="${e}"]`);if(f){f.addEventListener("load",()=>i()),f.addEventListener("error",S=>o(S)),f.readyState==="complete"&&i();return}const _=document.createElement("script");_.src=e,_.async=!0,_.onload=()=>i(),_.onerror=S=>o(S),document.head.appendChild(_)})}async function Nn(){window.html2pdf||await Mn(qn)}function ne(e=""){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function xn(e={}){const i=[e.dailyWage,e.daily_rate,e.dailyRate,e.wage,e.rate];for(const o of i){if(o==null)continue;const f=parseFloat(U(String(o)));if(Number.isFinite(f))return f}return 0}function kn(e){const i=_t()||[],{technicians:o=[]}=_e(),f=[].concat(Array.isArray(i)?i:[]).concat(Array.isArray(o)?o:[]),_=new Map;return f.forEach(S=>{if(!S||S.id==null)return;const b=String(S.id),n=_.get(b)||{};_.set(b,{...n,...S})}),(e.technicians||[]).map(S=>_.get(String(S))).filter(Boolean)}function jn({reservation:e,customer:i,project:o,technicians:f,totals:_,rentalDays:S,currencyLabel:b}){const n=U(String(e?.reservationId??e?.id??"")),u=e.start?U(je(e.start)):"-",v=e.end?U(je(e.end)):"-",l=e.createdAt?U(je(e.createdAt)):"-",h=i?.full_name||i?.name||"-",c=i?.phone||"-",a=i?.email||"-",p=i?.company||i?.company_name||"-",d=o?.title||o?.name||y("reservations.details.project.none","غير مرتبط بمشروع"),A=U(String(S)),E=e?.notes||"",I=f.length?f.map(B=>{const W=ne(B?.name||B?.full_name||"-"),Q=ne(B?.role||y("reservations.details.technicians.roleUnknown","غير محدد")),X=ne(B?.phone||y("reservations.details.technicians.phoneUnknown","غير متوفر"));return`<li><strong>${W}</strong><br><span>${Q}</span><br><span>${X}</span></li>`}).join(""):`<li>${ne(y("reservations.details.noCrew","😎 لا يوجد فريق مرتبط بهذا الحجز."))}</li>`,x=Array.isArray(e.items)&&e.items.length?e.items.map((B,W)=>{const Q=U(String(W+1)),X=ne(B?.barcode||"-"),L=ne(B?.desc||B?.description||"-"),q=U(String(B?.qty||1)),M=U(Number(B?.price||0).toFixed(2));return`<tr>
          <td>${Q}</td>
          <td>${X}</td>
          <td>${L}</td>
          <td>${q}</td>
          <td>${M}</td>
        </tr>`}).join(""):`<tr>
        <td colspan="5" class="empty">${ne(y("reservations.details.noItems","📦 لا توجد معدات ضمن هذا الحجز حالياً."))}</td>
      </tr>`;return`
    <div id="reservation-pdf-root" dir="rtl">
      <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap');
        #reservation-pdf-root {
          width: 210mm;
          min-height: 297mm;
          box-sizing: border-box;
          padding: 14mm 16mm;
          font-family: 'Tajawal', sans-serif;
          color: #111827;
          background: #ffffff;
        }
        #reservation-pdf-root h1,
        #reservation-pdf-root h2,
        #reservation-pdf-root h3,
        #reservation-pdf-root h4,
        #reservation-pdf-root h5,
        #reservation-pdf-root h6 {
          margin: 0;
        }
        .pdf-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 16px;
        }
        .pdf-header h1 {
          font-size: 22px;
          font-weight: 700;
        }
        .pdf-meta {
          display: grid;
          grid-template-columns: repeat(2, minmax(0, 1fr));
          gap: 8px 16px;
          margin-bottom: 18px;
        }
        .pdf-section {
          margin-bottom: 18px;
        }
        .pdf-section h3 {
          font-size: 16px;
          font-weight: 600;
          margin-bottom: 8px;
        }
        .pdf-section ul {
          list-style: none;
          padding: 0;
          margin: 0;
        }
        .pdf-section ul li {
          margin-bottom: 6px;
          line-height: 1.5;
        }
        table {
          width: 100%;
          border-collapse: collapse;
          font-size: 12px;
        }
        table th {
          background: #f3f4f6;
          padding: 8px;
          text-align: center;
        }
        table td {
          padding: 8px;
          border-bottom: 1px solid #e5e7eb;
          text-align: center;
        }
        table td:nth-child(3),
        table td:nth-child(4),
        table td:nth-child(5) {
          font-weight: 600;
        }
        table .empty {
          text-align: center;
          padding: 16px;
          font-weight: 500;
        }
        .totals-grid {
          display: grid;
          grid-template-columns: repeat(2, minmax(0, 1fr));
          gap: 8px 16px;
          margin: 12px 0;
          font-size: 13px;
        }
        .totals-grid div {
          display: flex;
          justify-content: space-between;
          background: #f9fafb;
          padding: 8px 12px;
          border-radius: 8px;
        }
        .totals-grid div span:first-child {
          font-weight: 600;
        }
        .notes {
          background: #f9fafb;
          border-radius: 8px;
          padding: 12px;
          min-height: 60px;
          white-space: pre-wrap;
          font-size: 12px;
        }
      </style>

      <div class="pdf-header">
        <h1>${ne(y("reservations.details.export.title","تفاصيل الحجز"))}</h1>
        <div>
          <div>${ne(y("reservations.details.labels.reservationId","رقم الحجز"))}: <strong>${n||"-"}</strong></div>
          <div>${ne(y("reservations.details.labels.createdAt","تاريخ الإنشاء"))}: ${l}</div>
        </div>
      </div>

      <div class="pdf-meta">
        <div>${ne(y("reservations.details.labels.customer","العميل"))}: <strong>${ne(h)}</strong></div>
        <div>${ne(y("reservations.details.labels.company","الشركة"))}: ${ne(p)}</div>
        <div>${ne(y("reservations.details.labels.phone","الهاتف"))}: ${ne(c)}</div>
        <div>${ne(y("reservations.details.labels.email","البريد"))}: ${ne(a)}</div>
        <div>${ne(y("reservations.details.labels.start","تاريخ البداية"))}: ${u}</div>
        <div>${ne(y("reservations.details.labels.end","تاريخ النهاية"))}: ${v}</div>
        <div>${ne(y("reservations.details.labels.duration","عدد الأيام"))}: ${A}</div>
        <div>${ne(y("reservations.details.labels.project","المشروع"))}: ${ne(d)}</div>
      </div>

      <div class="pdf-section">
        <h3>${ne(y("reservations.details.labels.summary","الملخص المالي"))}</h3>
        <div class="totals-grid">
          <div><span>${ne(y("reservations.details.labels.equipmentTotal","إجمالي المعدات"))}</span><span>${_.equipmentTotal} ${b}</span></div>
          <div><span>${ne(y("reservations.details.labels.crewTotal","إجمالي الفريق"))}</span><span>${_.crewTotal} ${b}</span></div>
          <div><span>${ne(y("reservations.details.labels.discount","الخصم"))}</span><span>${_.discountAmount} ${b}</span></div>
          <div><span>${ne(y("reservations.details.labels.tax","الضريبة (15%)"))}</span><span>${_.taxAmount} ${b}</span></div>
          <div><span>${ne(y("reservations.details.labels.total","الإجمالي النهائي"))}</span><span><strong>${_.finalTotal} ${b}</strong></span></div>
        </div>
      </div>

      <div class="pdf-section">
        <h3>${ne(y("reservations.details.technicians.title","طاقم العمل"))}</h3>
        <ul>${I}</ul>
      </div>

      <div class="pdf-section">
        <h3>${ne(y("reservations.details.items.title","المعدات"))}</h3>
        <table>
          <thead>
            <tr>
              <th>#</th>
              <th>${ne(y("reservations.details.table.headers.code","الكود"))}</th>
              <th>${ne(y("reservations.details.table.headers.description","الوصف"))}</th>
              <th>${ne(y("reservations.details.table.headers.quantity","الكمية"))}</th>
              <th>${ne(y("reservations.details.table.headers.price","السعر"))}</th>
            </tr>
          </thead>
          <tbody>
            ${x}
          </tbody>
        </table>
      </div>

      <div class="pdf-section">
        <h3>${ne(y("reservations.details.labels.notes","ملاحظات الحجز"))}</h3>
        <div class="notes">${ne(E)}</div>
      </div>
    </div>
  `}async function Rn({reservation:e,customer:i,project:o}){if(!e){J(y("reservations.toast.notFound","⚠️ تعذر العثور على بيانات الحجز"));return}await Nn();const f=kn(e),{projectLinked:_}=Be(e,o),S=_s(e.start,e.end),u=(Array.isArray(e.items)?e.items:[]).reduce((q,M)=>q+(Number(M?.qty)||1)*(Number(M?.price)||0),0)*S,l=f.reduce((q,M)=>q+xn(M),0)*S,h=u+l,c=parseFloat(e.discount)||0,a=e.discountType==="amount"?c:h*(c/100),p=Math.max(0,h-a),A=(_?!1:e.applyTax)?p*.15:0,E=Number(e.cost),I=Number.isFinite(E),x=p+A,B=_?Math.round(x):I?E:Math.round(x),W={equipmentTotal:U(u.toFixed(2)),crewTotal:U(l.toFixed(2)),discountAmount:U(a.toFixed(2)),taxAmount:U(A.toFixed(2)),finalTotal:U((B??0).toFixed(2))},Q=y("reservations.create.summary.currency","ريال"),X=jn({reservation:e,customer:i,project:o,technicians:f,totals:W,rentalDays:S,currencyLabel:Q}),L=document.createElement("div");L.innerHTML=X,L.style.position="fixed",L.style.top="-10000px",L.style.left="0",L.style.zIndex="-1",document.body.appendChild(L);try{const M=`reservation-${U(String(e?.reservationId??e?.id??"export"))||"export"}.pdf`;await window.html2pdf().set({margin:[10,10,10,10],filename:M,html2canvas:{scale:2,useCORS:!0},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"}}).from(L.firstElementChild).save()}finally{document.body.removeChild(L)}}function Bn({containerId:e="reservations-list",filters:i=null,onShowDetails:o,onConfirmReservation:f}={}){const _=_t(),{reservations:S=[],customers:b=[],technicians:n=[],projects:u=[]}=_e(),v=Array.isArray(_)?_:n||[],l=new Map((u||[]).map(A=>[String(A.id),A])),h=document.getElementById(e);if(!h){console.warn("⚠️ [reservations/renderers] container not found",e);return}if(!S||S.length===0){h.innerHTML=`<p>${y("reservations.list.empty","⚠️ لا توجد حجوزات بعد.")}</p>`;return}const c=i||An(),a=new Map(b.map(A=>[String(A.id),A])),p=new Map(v.map(A=>[String(A.id),A])),d=Dn({reservations:S,filters:c,customersMap:a,techniciansMap:p,projectsMap:l});if(d.length===0){h.innerHTML=`<p>${y("reservations.list.noResults","🔍 لا توجد حجوزات مطابقة للبحث.")}</p>`;return}h.innerHTML=`<div class="reservations-grid">${On({entries:d,customersMap:a,techniciansMap:p,projectsMap:l})}</div>`,h.querySelectorAll('[data-action="details"]').forEach(A=>{const E=Number(A.dataset.reservationIndex);Number.isNaN(E)||A.addEventListener("click",()=>{typeof o=="function"&&o(E)})}),h.querySelectorAll('button[data-action="confirm"]').forEach(A=>{const E=Number(A.dataset.reservationIndex);Number.isNaN(E)||A.addEventListener("click",I=>{I.stopPropagation(),typeof f=="function"&&f(E,I)})})}function $n(e,{onEdit:i,onDelete:o,getEditContext:f}={}){const{reservations:_=[],customers:S=[],projects:b=[]}=_e(),n=_[e];if(!n)return J(y("reservations.toast.notFound","⚠️ تعذر العثور على بيانات الحجز")),!1;const u=S.find(E=>String(E.id)===String(n.customerId)),v=n.projectId?b.find(E=>String(E.id)===String(n.projectId)):null,l=document.getElementById("reservation-details-body");if(l){const E=_t()||[];l.innerHTML=Pn(n,u,E,e,v)}const h=document.getElementById("reservationDetailsModal"),c=()=>{h&&window.bootstrap?.Modal&&window.bootstrap.Modal.getInstance(h)?.hide()},a=document.getElementById("reservation-details-edit-btn");a&&(a.onclick=()=>{c(),typeof i=="function"&&i(e,{reservation:n,customer:u,getEditContext:f})});const p=document.getElementById("reservation-details-delete-btn");p&&(p.onclick=()=>{c(),typeof o=="function"&&o(e,{reservation:n,customer:u})});const d=l?.querySelector('[data-action="open-project"]');d&&v&&d.addEventListener("click",()=>{c();const E=v?.id!=null?String(v.id):"",I=E?`projects.html?project=${encodeURIComponent(E)}`:"projects.html";window.location.href=I});const A=document.getElementById("reservation-details-export-btn");return A&&(A.onclick=async()=>{try{await Rn({reservation:n,customer:u,project:v})}catch(E){console.error("❌ [reservations] export to PDF failed",E),J(y("reservations.details.actions.exportFailed","⚠️ تعذر تصدير الحجز إلى PDF"),"error")}}),h&&window.bootstrap?.Modal&&window.bootstrap.Modal.getOrCreateInstance(h).show(),!0}let ot=null,Pe=[],Xt=null,Ae={};function Ct(){return{index:ot,items:Pe}}function wt(e,i){ot=typeof e=="number"?e:null,Pe=Array.isArray(i)?[...i]:[]}function Os(){ot=null,Pe=[],sn()}function Fn(e,i){return e?typeof i=="function"?i(e):window?.bootstrap?.Modal?window.bootstrap.Modal.getOrCreateInstance(e):typeof bootstrap<"u"&&bootstrap?.Modal?bootstrap.Modal.getOrCreateInstance(e):null:null}function it(e=""){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function Hn(e=[],i=null){const o=document.getElementById("edit-res-project");if(!o)return;const f=y("reservations.create.placeholders.project","اختر مشروعاً (اختياري)"),_=y("reservations.edit.project.missing","⚠️ المشروع غير متوفر (تم حذفه)"),S=i?.projectId?String(i.projectId):"",b=Array.isArray(e)?[...e].sort((u,v)=>String(v.createdAt||v.start||"").localeCompare(String(u.createdAt||u.start||""))):[],n=[`<option value="">${it(f)}</option>`];b.forEach(u=>{n.push(`<option value="${it(u.id)}">${it(u.title||f)}</option>`)}),S&&!b.some(u=>String(u.id)===S)&&n.push(`<option value="${it(S)}">${it(_)}</option>`),o.innerHTML=n.join(""),S?o.value=S:o.value=""}function Ps(){const e=document.getElementById("edit-res-project"),i=document.getElementById("edit-res-tax");if(!i)return;if(!!e?.value)i.checked=!1,i.disabled=!0,i.classList.add("disabled");else{const f=i.disabled;i.disabled=!1,i.classList.remove("disabled"),f&&(i.checked=!1)}}function us(e,{populateEquipmentDescriptionLists:i,setFlatpickrValue:o,splitDateTime:f,renderEditItems:_,updateEditReservationSummary:S,ensureModal:b}={}){const{customers:n,projects:u}=_e(),l=Ss()?.[e];if(!l){J(y("reservations.toast.notFound","⚠️ تعذر العثور على بيانات الحجز"));return}Ae={...Ae,reservation:l,projects:u||[]},i?.(),Hn(u||[],l);const h=l.projectId&&u?.find?.(t=>String(t.id)===String(l.projectId))||null,{effectiveConfirmed:c,projectLinked:a}=Be(l,h),p=l.items?l.items.map(t=>({...t,equipmentId:t.equipmentId??t.equipment_id??t.id,barcode:Ee(t?.barcode)})):[];wt(e,p);const d=y("reservations.list.unknownCustomer","غير معروف"),A=n?.find?.(t=>String(t.id)===String(l.customerId));document.getElementById("edit-res-index")?.setAttribute("value",String(e));const E=document.getElementById("edit-res-id");E&&(E.value=l.reservationId||l.id);const I=document.getElementById("edit-res-customer");I&&(I.value=A?.customerName||d);const x=typeof f=="function"?f(l.start):{date:"",time:""},B=typeof f=="function"?f(l.end):{date:"",time:""};o?.("edit-res-start",x.date),o?.("edit-res-start-time",x.time),o?.("edit-res-end",B.date),o?.("edit-res-end-time",B.time);const W=document.getElementById("edit-res-notes");W&&(W.value=l.notes||"");const Q=document.getElementById("edit-res-discount");Q&&(Q.value=U(l.discount??0));const X=document.getElementById("edit-res-discount-type");X&&(X.value=l.discountType||"percent");const L=document.getElementById("edit-res-tax");L&&(L.checked=l.projectId?!1:!!l.applyTax);const q=document.getElementById("edit-res-confirmed");q&&(q.checked=c,q.disabled=a,q.classList.toggle("disabled",a),q.closest(".form-check")?.classList.toggle("disabled",a));const M=document.getElementById("edit-res-paid");M&&(M.value=l.paid===!0||l.paid==="paid"?"paid":"unpaid"),Js((l.technicians||[]).map(t=>String(t))),_?.(p),Ps(),S?.();const w=document.getElementById("editReservationModal");Xt=Fn(w,b),Xt?.show?.()}async function Kn({combineDateTime:e,hasEquipmentConflict:i,hasTechnicianConflict:o,updateEditReservationSummary:f,renderReservations:_,populateEquipmentDescriptionLists:S,handleReservationsMutation:b}={}){if(ot===null){console.warn("⚠️ [reservationsEdit.js] No reservation selected for editing");return}const n=document.getElementById("edit-res-start")?.value?.trim(),u=document.getElementById("edit-res-start-time")?.value?.trim()||"00:00",v=document.getElementById("edit-res-end")?.value?.trim(),l=document.getElementById("edit-res-end-time")?.value?.trim()||"00:00",h=document.getElementById("edit-res-notes")?.value||"",c=U(document.getElementById("edit-res-discount")?.value||"0"),a=parseFloat(c)||0,p=document.getElementById("edit-res-discount-type")?.value||"percent",d=document.getElementById("edit-res-confirmed")?.checked||!1,A=document.getElementById("edit-res-paid")?.value||"unpaid",E=document.getElementById("edit-res-project")?.value||"",I=Zs();if(!n||!v){J(y("reservations.toast.requireDates","⚠️ يرجى تحديد تاريخ البداية والنهاية"));return}const x=typeof e=="function"?e:(F,G)=>`${F}T${G||"00:00"}`,B=x(n,u),W=x(v,l);if(B&&W&&new Date(B)>new Date(W)){J(y("reservations.toast.invalidDateOrder","⚠️ تاريخ البداية لا يمكن أن يكون بعد تاريخ النهاية"));return}const X=Ss()?.[ot];if(!X){J(y("reservations.toast.reservationMissing","⚠️ تعذر العثور على الحجز المطلوب"));return}if(!Array.isArray(Pe)||Pe.length===0&&I.length===0){J(y("reservations.toast.updateNoItems","⚠️ يجب إضافة معدة أو عضو واحد من الطاقم الفني على الأقل للحجز"));return}for(const F of Pe)if(Ye(F.barcode)){J(y("reservations.toast.updateEquipmentMaintenance","⚠️ لا يمكن حفظ التعديلات لأن إحدى المعدات قيد الصيانة"));return}const L=typeof i=="function"?i:()=>!1;for(const F of Pe){const G=Ee(F.barcode);if(L(G,B,W,X.id??X.reservationId)){J(y("reservations.toast.updateEquipmentConflict","⚠️ لا يمكن حفظ التعديلات بسبب تعارض في أحد المعدات"));return}}const q=typeof o=="function"?o:()=>!1;for(const F of I)if(q(F,B,W,X.id??X.reservationId)){J(y("reservations.toast.updateCrewConflict","⚠️ لا يمكن حفظ التعديلات بسبب تعارض في جدول أحد أعضاء الطاقم"));return}const M=document.getElementById("edit-res-tax"),w=Array.isArray(Ae.projects)&&Ae.projects.length?Ae.projects:_e().projects||[],t=E&&w.find(F=>String(F.id)===String(E))||null,s={...X,projectId:E?String(E):null,confirmed:d},{effectiveConfirmed:r,projectLinked:m,projectStatus:C}=Be(s,t),j=m?!1:M?.checked||!1,R=gs(Pe,a,p,j,I,{start:B,end:W});let O=X.status??"pending";m?O=t?.status??C??O:["completed","cancelled"].includes(String(O).toLowerCase())||(O=d?"confirmed":"pending");const H=bs({reservationCode:X.reservationCode??X.reservationId??null,customerId:X.customerId,start:B,end:W,status:O,title:X.title??null,location:X.location??null,notes:h,projectId:E?String(E):null,totalAmount:R,discount:a,discountType:p,applyTax:j,paidStatus:A,confirmed:r,items:Pe.map(F=>({...F,equipmentId:F.equipmentId??F.id})),technicians:I});try{const F=await en(X.id||X.reservationId,H);await tn(),J(y("reservations.toast.updated","✅ تم حفظ التعديلات على الحجز")),f?.(),Os(),b?.({type:"updated",reservation:F}),_?.(),S?.(),Xt?.hide?.()}catch(F){console.error("❌ [reservationsEdit] Failed to update reservation",F);const G=ys(F)?F.message:y("reservations.toast.updateFailed","تعذر تحديث بيانات الحجز");J(G,"error")}}function ei(e={}){Ae={...e};const{updateEditReservationSummary:i,addEquipmentToEditingReservation:o,addEquipmentByDescription:f,renderEditItems:_}=Ae,S=document.getElementById("edit-res-discount");S&&!S.dataset.listenerAttached&&(S.addEventListener("input",()=>{S.value=U(S.value),i?.()}),S.dataset.listenerAttached="true");const b=document.getElementById("edit-res-discount-type");b&&!b.dataset.listenerAttached&&(b.addEventListener("change",()=>i?.()),b.dataset.listenerAttached="true");const n=document.getElementById("edit-res-tax");n&&!n.dataset.listenerAttached&&(n.addEventListener("change",()=>i?.()),n.dataset.listenerAttached="true");const u=document.getElementById("edit-res-project");u&&!u.dataset.listenerAttached&&(u.addEventListener("change",()=>{Ps();const a=document.getElementById("edit-res-confirmed");if(a){const p=Array.isArray(Ae.projects)&&Ae.projects.length?Ae.projects:_e().projects||[],d=u.value&&p.find(B=>String(B.id)===String(u.value))||null,E={...Ae?.reservation??{},projectId:u.value||null,confirmed:a.checked},{effectiveConfirmed:I,projectLinked:x}=Be(E,d);a.checked=I,a.disabled=x,a.classList.toggle("disabled",x),a.closest(".form-check")?.classList.toggle("disabled",x)}i?.()}),u.dataset.listenerAttached="true");const v=document.getElementById("save-reservation-changes");v&&!v.dataset.listenerAttached&&(v.addEventListener("click",()=>{Kn(Ae).catch(a=>{console.error("❌ [reservationsEdit] saveReservationChanges failed",a)})}),v.dataset.listenerAttached="true");const l=document.getElementById("edit-res-equipment-barcode");if(l&&!l.dataset.listenerAttached){l.addEventListener("keydown",d=>{d.key==="Enter"&&(d.preventDefault(),o?.(l))});let a=null;const p=()=>{if(clearTimeout(a),!l.value?.trim())return;const{start:d,end:A}=getEditReservationDateRange();!d||!A||(a=setTimeout(()=>{o?.(l)},150))};l.addEventListener("input",p),l.addEventListener("change",()=>o?.(l)),l.dataset.listenerAttached="true"}const h=document.getElementById("edit-res-equipment-description");h&&!h.dataset.listenerAttached&&(h.addEventListener("keydown",a=>{a.key==="Enter"&&(a.preventDefault(),f?.(h,"edit"))}),h.dataset.listenerAttached="true");const c=document.getElementById("editReservationModal");c&&!c.dataset.cleanupAttached&&(c.addEventListener("hidden.bs.modal",()=>{Os(),i?.(),_?.([])}),c.dataset.cleanupAttached="true")}function is(){const e=document.getElementById("edit-res-start")?.value?.trim(),i=document.getElementById("edit-res-end")?.value?.trim(),o=document.getElementById("edit-res-start-time")?.value?.trim()||"00:00",f=document.getElementById("edit-res-end-time")?.value?.trim()||"00:00";return!e||!i?{start:null,end:null}:{start:at(e,o),end:at(i,f)}}function Tt(e=[]){const i=document.getElementById("edit-res-items");if(!i)return;const o=y("reservations.create.equipment.none","لا توجد معدات"),f=y("reservations.create.summary.currency","ريال"),_=y("reservations.create.equipment.imageAlt","صورة");if(!e||e.length===0){i.innerHTML=`<tr><td colspan="6" class="text-center">${o}</td></tr>`,ms(i);return}i.innerHTML=e.map((S,b)=>{const n=lt(S),u=`${U(String(S.price??0))} ${f}`,v=U(String(S.qty||1)),l=n?`<img src="${n}" alt="${_}" class="reservation-item-thumb">`:"-";return`
        <tr>
          <td>${S.barcode||"-"}</td>
          <td>${S.desc||"-"}</td>
          <td>${u}</td>
          <td>${v}</td>
          <td>${l}</td>
          <td><button type="button" class="reservation-remove-button" data-action="remove-edit-item" data-item-index="${b}">🗑️</button></td>
        </tr>
      `}).join(""),ms(i)}function ms(e){!e||e.dataset.removeListenerAttached||(e.addEventListener("click",i=>{const o=i.target.closest('[data-action="remove-edit-item"]');if(!o)return;i.preventDefault();const f=Number(o.dataset.itemIndex);Number.isNaN(f)||Vn(f)}),e.dataset.removeListenerAttached="true")}function Xe(){const e=document.getElementById("edit-res-summary");if(!e)return;const i=document.getElementById("edit-res-discount"),o=document.getElementById("edit-res-discount-type"),f=document.getElementById("edit-res-paid");f&&!f.dataset.listenerAttached&&(f.addEventListener("change",Xe),f.dataset.listenerAttached="true"),Ve(f);const _=U(i?.value||"0");i&&(i.value=_);const S=parseFloat(_)||0,b=o?.value||"percent",n=!!document.getElementById("edit-res-project")?.value,u=document.getElementById("edit-res-tax"),v=n?!1:u?.checked||!1,l=f?.value||"unpaid";Ve(f,l);const{items:h=[]}=Ct(),{start:c,end:a}=is();e.innerHTML=nn({items:h,discount:S,discountType:b,applyTax:v,paidStatus:l,start:c,end:a})}function Vn(e){if(e==null)return;const{index:i,items:o}=Ct();if(!Array.isArray(o))return;const f=o.filter((_,S)=>S!==e);wt(i,f),Tt(f),Xe()}function Un(e){const i=e?.value??"",o=Ee(i);if(!o)return;const f=Zt(o);if(!f){J(y("reservations.toast.barcodeNotInCatalog","❌ الباركود غير موجود ضمن المعدات"));return}if(Ye(o)){J(y("reservations.toast.equipmentMaintenance","⚠️ هذه المعدة قيد الصيانة ولا يمكن إضافتها حالياً"));return}const _=Ee(o),{index:S,items:b=[]}=Ct();if(b.findIndex(p=>Ee(p.barcode)===_)>-1){J(y("reservations.toast.equipmentDuplicate","⚠️ هذه المعدة موجودة بالفعل في الحجز"));return}const{start:u,end:v}=is();if(!u||!v){J(y("reservations.toast.requireDatesBeforeAdd","⚠️ يرجى تحديد تاريخ ووقت البداية والنهاية قبل إضافة المعدات"));return}const{reservations:l=[]}=_e(),h=S!=null&&l[S]||null,c=h?.id??h?.reservationId??null;if(Ue(_,u,v,c)){J(y("reservations.toast.equipmentTimeConflictSimple","⚠️ هذه المعدة محجوزة في نفس الفترة الزمنية"));return}const a=[...b,{id:f.id,equipmentId:f.id,barcode:_,desc:f.desc,qty:1,price:f.price,image:f.image||f.imageUrl||f.img||null}];wt(S,a),e&&(e.value=""),Tt(a),Xe()}function Et(e){if(!e)return;const i=e.value.trim();if(!i)return;const o=Ts(i),f=Ee(o?.barcode||i);if(!o||!f){J(y("reservations.toast.equipmentNameNotFound","❌ لم يتم العثور على معدة بالاسم المدخل"));return}if(Ye(f)){J(y("reservations.toast.equipmentMaintenanceStrict","⚠️ لا يمكن إضافة معدة قيد الصيانة إلى الحجز"));return}const{start:_,end:S}=is();if(!_||!S){J(y("reservations.toast.requireOverallDates","⚠️ يرجى تحديد تواريخ الحجز قبل إضافة المعدات"));return}const{index:b,items:n=[]}=Ct();if(n.some(a=>Ee(a.barcode)===f)){J(y("reservations.toast.equipmentDuplicate","⚠️ هذه المعدة موجودة بالفعل في الحجز"));return}const{reservations:v=[]}=_e(),l=b!=null&&v[b]||null,h=l?.id??l?.reservationId??null;if(Ue(f,_,S,h)){J(y("reservations.toast.equipmentTimeConflictSimple","⚠️ هذه المعدة محجوزة في نفس الفترة الزمنية"));return}const c=[...n,{id:o.id,equipmentId:o.id,barcode:f,desc:o.desc,qty:1,price:o.price,image:o.image||o.imageUrl||o.img||null}];wt(b,c),Tt(c),Xe(),e.value=""}function Yn(){const e=document.getElementById("edit-res-equipment-description");if(e&&!e.dataset.listenerAttached){e.addEventListener("keydown",o=>{o.key==="Enter"&&(o.preventDefault(),Et(e))});const i=()=>{As(e.value,"edit-res-equipment-description-options")&&Et(e)};e.addEventListener("input",i),e.addEventListener("change",i),e.dataset.listenerAttached="true"}}typeof document<"u"&&document.addEventListener("language:changed",()=>{Xe()});function Wn(e,i="create"){if(!(!e||!e.value.trim())){if(i==="create"){zt(e);return}Et(e)}}function ti(){Ge(),Yn()}function Gn(e,i){const o=document.getElementById(e);if(o){if(o._flatpickr){if(i){const f=o._flatpickr.config?.dateFormat||"Y-m-d";o._flatpickr.setDate(i,!1,f)}else o._flatpickr.clear();return}o.value=i||""}}function si(){return on().catch(e=>{console.warn("⚠️ [reservations/controller] Failed to refresh projects before loading form",e)}).finally(()=>{const{technicians:e}=_e()||{};cn(e||[]),Ls()})}function rs(e=null){Ls(),qs(),typeof window.refreshCustomerReservationsViews=="function"&&window.refreshCustomerReservationsViews(),typeof window.refreshTechnicianReservationsViews=="function"&&window.refreshTechnicianReservationsViews();const i=e!=null?{detail:e}:{};document.dispatchEvent(new CustomEvent("reservations:changed",i))}function zn(e){return e?window?.bootstrap?.Modal?window.bootstrap.Modal.getOrCreateInstance(e):typeof bootstrap<"u"&&bootstrap?.Modal?bootstrap.Modal.getOrCreateInstance(e):null:null}function Qt(){return{populateEquipmentDescriptionLists:Ge,setFlatpickrValue:Gn,splitDateTime:hs,renderEditItems:Tt,updateEditReservationSummary:Xe,addEquipmentByDescription:Wn,addEquipmentToEditingReservation:Un,addEquipmentToEditingByDescription:Et,combineDateTime:at,hasEquipmentConflict:Ue,hasTechnicianConflict:vs,renderReservations:qs,handleReservationsMutation:rs,ensureModal:zn}}function qs(e="reservations-list",i=null){Bn({containerId:e,filters:i,onShowDetails:Ms,onConfirmReservation:xs})}function Ms(e){return $n(e,{getEditContext:Qt,onEdit:(i,{reservation:o})=>{ks(i,o)},onDelete:Ns})}function Ns(e){return ps()?window.confirm(y("reservations.toast.deleteConfirm","⚠️ هل أنت متأكد من حذف هذا الحجز؟"))?rn(e,{onAfterChange:rs}):!1:(Fs(),!1)}function xs(e){return an(e,{onAfterChange:rs})}function ks(e,i=null){if(document.getElementById("reservation-form")){try{localStorage.removeItem("pendingReservationEditId"),localStorage.removeItem("pendingReservationEditIndex")}catch(S){console.warn("⚠️ [reservations/controller] Unable to clear pending edit id (inline form)",S)}us(e,Qt());return}if(document.getElementById("editReservationModal")){try{localStorage.removeItem("pendingReservationEditId"),localStorage.removeItem("pendingReservationEditIndex")}catch(S){console.warn("⚠️ [reservations/controller] Unable to clear pending edit id (modal)",S)}us(e,Qt());return}const o=new URLSearchParams;if(i?.id||i?.reservationId){const S=i.id??i.reservationId;o.set("reservationEditId",String(S));try{localStorage.setItem("pendingReservationEditId",String(S)),localStorage.removeItem("pendingReservationEditIndex")}catch(b){console.warn("⚠️ [reservations/controller] Unable to persist pending edit id",b)}}else{o.set("reservationEditIndex",String(e));try{localStorage.setItem("pendingReservationEditIndex",String(e)),localStorage.removeItem("pendingReservationEditId")}catch(S){console.warn("⚠️ [reservations/controller] Unable to persist pending edit index",S)}}Hs({dashboardTab:"reservations-tab",dashboardSubTab:"my-reservations-tab"}).catch(S=>{console.warn("⚠️ [reservations/controller] Failed to persist tab preference",S)});const f=o.toString(),_=f?`dashboard.html?${f}#reservations`:"dashboard.html#reservations";window.location.href=_}function ni(){typeof window>"u"||(window.showReservationDetails=Ms,window.deleteReservation=Ns,window.confirmReservation=xs,window.editReservation=ks)}export{Ds as a,ni as b,Zn as c,ei as d,ti as e,Ls as f,Qt as g,fe as h,Jn as i,rs as j,si as l,qs as r,Ms as s,Xe as u};
