import{e as s}from"./calculations.BVcyzysX.js";import{p as f,e as u,a as h}from"./projects.B_HNL6vL.js";import"./reservationsService.BGgi72ed.js";import"./auth.Dym-pMl4.js";import"./state.D0_ft4YH.js";import"./dashboard.DgtQZpbL.js";import"./form.BoSw5-Ka.js";import"./projectsService.CtAJ7Bct.js";import"./constants.Cby_zQyZ.js";import"./customers.BzFjEKEv.js";import"./controller.DzvKBGXH.js";import"./details.BmsEvKGd.js";import"./equipment.CAaKsH40.js";import"./quotePdf.C2lQPEPC.js";import"./canvasColorUtils.CviLtv6S.js";import"./reservationsActions.DuW1PrtF.js";import"./uiBridge.BLZZT8b9.js";import"./dashboardShell.DF2kUed9.js";async function H(n){if(!n)throw new Error("No host");let d=null;try{d=await s()}catch{d=null}const m=document.createElement("div");Object.assign(m.style,{position:"fixed",top:"0",left:"-12000px",pointerEvents:"none",zIndex:"-1",backgroundColor:"#ffffff"});const t=document.createElement("div");t.id="templates-a4-root",t.setAttribute("data-render-context","export"),t.setAttribute("dir",n.getAttribute("dir")||document.documentElement.getAttribute("dir")||"rtl");const l=document.createElement("div");l.setAttribute("data-a4-pages","");const e=n.querySelector("[data-a4-pages]")?.cloneNode(!0)||n.cloneNode(!0);e.classList&&e.hasAttribute("data-a4-pages")?t.appendChild(e):(l.appendChild(e),t.appendChild(l)),m.appendChild(t),document.body.appendChild(m);try{try{const r=Array.from(t.querySelectorAll(".cs-logo img")).map(i=>i.getAttribute("src")).filter(Boolean);await f(r)}catch{}if(await u(),Array.from(t.querySelectorAll(".a4-page")).forEach(r=>{h(r)||r.parentElement?.removeChild(r)}),typeof d=="function"){await d().set({margin:0,html2canvas:{scale:2,useCORS:!0,allowTaint:!1,backgroundColor:"#ffffff"},jsPDF:{unit:"mm",format:"a4",orientation:"landscape"},pagebreak:{mode:["css","legacy"]},image:{type:"jpeg",quality:.98}}).from(t).save("template-callsheet.pdf");return}const c=`<!doctype html><html dir="${t.getAttribute("dir")||"rtl"}"><head><meta charset="utf-8"><title>Call Sheet</title><style>@page{size:A4 landscape;margin:0}html,body{margin:0;padding:0;background:#fff}#templates-a4-root{transform:none!important}</style></head><body>${t.innerHTML}</body></html>`,o=document.createElement("iframe");Object.assign(o.style,{position:"fixed",right:"0",bottom:"0",width:"1px",height:"1px",border:"0"}),document.body.appendChild(o);const a=o.contentWindow?.document;a&&(a.open(),a.write(c),a.close(),o.onload=()=>{try{o.contentWindow?.focus(),o.contentWindow?.print()}catch{}setTimeout(()=>o.remove(),1200)})}finally{try{m.remove()}catch{}}}async function P(n,{orientation:d="portrait",filename:m="template.pdf"}={}){if(!n)throw new Error("No host");let t=null;try{t=await s()}catch{t=null}const l=document.createElement("div");Object.assign(l.style,{position:"fixed",top:"0",left:"-12000px",pointerEvents:"none",zIndex:"-1",backgroundColor:"#ffffff"});const e=document.createElement("div");e.id="templates-a4-root",e.setAttribute("data-render-context","export"),e.setAttribute("dir",n.getAttribute("dir")||document.documentElement.getAttribute("dir")||"rtl");const c=n.querySelector("[data-a4-pages]")?.cloneNode(!0)||n.cloneNode(!0);if(c.classList&&c.hasAttribute("data-a4-pages"))e.appendChild(c);else{const o=document.createElement("div");o.setAttribute("data-a4-pages",""),Array.from(n.children).forEach(a=>o.appendChild(a.cloneNode(!0))),e.appendChild(o)}l.appendChild(e),document.body.appendChild(l);try{try{const i=Array.from(e.querySelectorAll("img")).map(p=>p.getAttribute("src")).filter(Boolean);await f(i)}catch{}if(await u(),Array.from(e.querySelectorAll(".a4-page")).forEach(i=>{if(!h(i))try{i.parentElement?.removeChild(i)}catch{}}),typeof t=="function"){await t().set({margin:0,html2canvas:{scale:2,useCORS:!0,allowTaint:!1,backgroundColor:"#ffffff"},jsPDF:{unit:"mm",format:"a4",orientation:d==="landscape"?"landscape":"portrait"},pagebreak:{mode:["css","legacy"]},image:{type:"jpeg",quality:.98}}).from(e).save(m);return}const o=`<!doctype html><html dir="${e.getAttribute("dir")||"rtl"}"><head><meta charset="utf-8"><title>Print</title><style>@page{size:A4 ${d};margin:0}html,body{margin:0;padding:0;background:#fff}#templates-a4-root{transform:none!important}</style></head><body>${e.innerHTML}</body></html>`,a=document.createElement("iframe");Object.assign(a.style,{position:"fixed",right:"0",bottom:"0",width:"1px",height:"1px",border:"0"}),document.body.appendChild(a);const r=a.contentWindow?.document;r&&(r.open(),r.write(o),r.close(),a.onload=()=>{try{a.contentWindow?.focus(),a.contentWindow?.print()}catch{}setTimeout(()=>a.remove(),1200)})}finally{try{l.remove()}catch{}}}export{H as printCallsheetFromHost,P as printGenericTemplate};
