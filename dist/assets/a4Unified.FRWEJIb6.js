import{r as y,t as s,e as L,d as O,b as k}from"./calculations.Da10Qu6G.js";import{e as z,l as A,a as H,b as X}from"./reports.DLFtQzjm.js";import"./reservationsService.B1hsYPEN.js";import"./auth.JZrLedpn.js";import"./dashboard.BmWCx2fr.js";import"./controller.BzUaX7iX.js";/* empty css              */import"./dashboardShell.BOz0qBLn.js";import"./customers.D4PMCgmj.js";import"./maintenanceService.B262iOVL.js";const W=`@page { size: A4; margin: 0; }
@import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;600;700;800&display=swap');

/* جذر وثيقة A4 للمعاينة/التصدير */
#reports-a4-root {
  color-scheme: light;
  direction: rtl;
  text-align: right;
  font-family: 'Tajawal', 'Arial', 'Tahoma', sans-serif;
  color: #000 !important;
}

/* إزالة تأثيرات الثيم والظلال كلياً داخل الجذر */
#reports-a4-root, #reports-a4-root * {
  color: #000 !important; background: #fff !important; box-shadow: none !important; filter: none !important;
  letter-spacing: normal !important; word-spacing: normal !important; font-kerning: normal !important; font-variant-ligatures: normal !important;
  -webkit-font-smoothing: antialiased; text-rendering: optimizeLegibility;
}

/* حاوية الصفحات */
#reports-a4-root [data-a4-pages] {
  display: flex; flex-direction: column; gap: 0; padding: 0; margin: 0; align-items: center; justify-content: flex-start;
}

/* صفحة A4 ثابتة بالبكسل، بدون أي هوامش خارجية */
.a4-page {
  position: relative;
  width: 794px; /* 210mm @ 96dpi */
  height: 1123px; /* 297mm @ 96dpi */
  overflow: hidden; background: #fff; border-radius: 0; margin: 0; padding: 0;
}

/* طبقة داخلية تمتد على كامل الصفحة وتُطبّق الحشوات بالـ mm */
.a4-inner { position: absolute; inset: 0; padding: 12mm 14mm 12mm; }
.a4-page--primary .a4-inner { padding-top: 6mm; }

/* العناوين والـ KPI */
.rpt-header { display: flex; flex-direction: column; gap: 8px; margin: 0 0 6mm 0; }
.rpt-header-top { display: flex; align-items: center; justify-content: space-between; gap: 12px; }
.rpt-titleblock { display: flex; flex-direction: column; gap: 4px; text-align: right; }
.rpt-header h1 { margin: 0; font-weight: 800; font-size: 18px; text-align: right; }
.rpt-subtitle { margin: 0; font-size: 12px; opacity: .9; text-align: right; }
.rpt-logo { width: 56px; height: 56px; object-fit: contain; border-radius: 12px; border: 1px solid #e5e7eb; background: #fff; }

.rpt-kpis { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin: 8px 0 6mm; }
.rpt-kpi { border: 1px solid #e5e7eb; border-radius: 8px; padding: 8px 10px; }
.rpt-kpi .label { font-size: 11px; opacity: .85; }
.rpt-kpi .value { font-weight: 700; font-size: 14px; }

/* الجدول */
.rpt-table { width: 100%; border-collapse: collapse; font-size: 11px; border: 1px solid #9ca3af; table-layout: fixed; print-color-adjust: exact; -webkit-print-color-adjust: exact; }
.rpt-table tbody tr:last-child td { border-bottom: 1px solid #9ca3af; }
.rpt-table td, .rpt-table th { vertical-align: middle; border-color: #9ca3af; }
/* تأكيد إغلاق الحواف الخارجية يمين/يسار وأعلى/أسفل */
.rpt-table thead tr:first-child th { border-top: 1px solid #9ca3af; }
.rpt-table thead th:first-child, .rpt-table tbody td:first-child { border-right: 1px solid #9ca3af; }
.rpt-table thead th:last-child, .rpt-table tbody td:last-child { border-left: 1px solid #9ca3af; }
.rpt-table tbody tr + tr td { border-top: 1px solid #9ca3af; }
/* تفاصيل الجسم فقط أصغر وبسطر واحد */
.rpt-table tr { height: 26px; }
.rpt-table tbody td { font-size: 10px; line-height: 1; height: 26px; padding: 0 !important; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; border: 1px solid #9ca3af; position: relative; }

/* تفاصيل الإيرادات داخل المعاينة */
.rpt-revenue {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 8px 12px;
  margin: 6mm 0 6mm;
}
.rpt-revenue__item { display: flex; align-items: center; justify-content: space-between; border: 1px solid #9ca3af; border-radius: 8px; padding: 8px 10px; }
.rpt-revenue__label { font-size: 11px; opacity: .9; }
.rpt-revenue__value { font-weight: 700; font-size: 13px; }
.rpt-revenue__title { margin: 0 0 6px 0; font-size: 13px; font-weight: 800; }
.rpt-table th { background: #f3f4f6 !important; color: #000 !important; border: 1px solid #9ca3af; padding: 6px 8px; text-align: right; font-weight: 800; }
.rpt-table td { background: #ffffff !important; color: #000 !important; border: 1px solid #9ca3af; padding: 0 !important; text-align: right; height: 24px; }

/* تحسين ظهور الحدود في وضع المعاينة (قد تضيع عند التصغير) */
#reports-a4-root[data-render-context="preview"] .rpt-table { border-width: 2px; outline: 2px solid #475569; outline-offset: 0; box-shadow: inset 0 0 0 2px #475569; }
#reports-a4-root[data-render-context="preview"] .rpt-table th,
#reports-a4-root[data-render-context="preview"] .rpt-table td { border-color: #475569; border-width: 1.5px; }

/* توسيط المحتوى عمودياً داخل الخلايا بشكل صريح */
.rpt-table th, .rpt-table td { vertical-align: middle !important; }
.rpt-cell { display: flex; align-items: center; justify-content: flex-start; height: 26px; min-height: 26px; width: 100%; padding: 0 8px; box-sizing: border-box; line-height: 1; direction: rtl; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

/* إخفاء العناصر حسب التفضيلات */
#reports-a4-root[data-hide-header] .rpt-header { display: none !important; }
#reports-a4-root[data-hide-kpis] .rpt-kpis { display: none !important; }
#reports-a4-root[data-hide-revenue] .rpt-revenue-section { display: none !important; }
`,I=96,D=25.4,U=210,$=297,E=Math.round(U/D*I),F=Math.round($/D*I);function G(){try{return{header:localStorage.getItem("reportsPdf.hide.header")==="1",kpis:localStorage.getItem("reportsPdf.hide.kpis")==="1",revenue:localStorage.getItem("reportsPdf.hide.revenue")==="1"}}catch{return{header:!1,kpis:!1,revenue:!1}}}function J(e,t){!e||!t||(e.toggleAttribute("data-hide-header",!!t.header),e.toggleAttribute("data-hide-kpis",!!t.kpis),e.toggleAttribute("data-hide-revenue",!!t.revenue))}function B(e="preview"){const t=document.createElement("div");t.id="reports-a4-root",t.setAttribute("dir",document.documentElement.getAttribute("dir")||"rtl"),t.setAttribute("data-render-context",e);const r=document.createElement("style");r.textContent=String(W).trim(),t.appendChild(r);const d=document.createElement("div");return d.setAttribute("data-a4-pages",""),t.appendChild(d),J(t,G()),t}function K(){const e=document.createElement("div");e.className="rpt-header";const t=document.createElement("div");t.className="rpt-header-top";const r=document.createElement("div");r.className="rpt-titleblock";const d=document.createElement("h1");d.textContent=s("reservations.reports.print.title","تقرير الحجوزات","Reservations report");const o=document.createElement("p");o.className="rpt-subtitle",o.textContent=`${L(new Date)} • ${s("reservations.reports.print.generated","تاريخ التوليد","Generated on")}`,r.appendChild(d),r.appendChild(o);const l=document.createElement("img");return l.className="rpt-logo",l.alt="Logo",l.decoding="async",l.loading="lazy",l.src=M(),t.appendChild(r),t.appendChild(l),e.appendChild(t),e}function j(e){return Number.isFinite(Number(e))?Math.round(Number(e)*100)/100:0}function V(){const e=y.lastSnapshot?.metrics||{},t=document.createElement("div");t.className="rpt-kpis";const r=(b,u)=>{const p=document.createElement("div");return p.className="rpt-kpi",p.innerHTML=`<div class="label">${b}</div><div class="value">${u??"—"}</div>`,p},d=O(e.total||0),o=k(j(e.revenue)),l=k(j(e.netProfit)),c=k(j(e.companyShareTotal)),g=k(j(e.taxTotal)),w=k(j(e.maintenanceExpense));return t.appendChild(r(s("reservations.reports.kpi.total.label","الحجوزات","Reservations"),d)),t.appendChild(r(s("reservations.reports.kpi.revenue.label","الإيرادات","Revenue"),o)),t.appendChild(r(s("reservations.reports.kpi.net.label","صافي الربح","Net profit"),l)),t.appendChild(r(s("reservations.reports.kpi.share.label","نسبة الشركة","Company share"),c)),t.appendChild(r(s("reservations.reports.kpi.tax.label","الضريبة","Tax"),g)),t.appendChild(r(s("reservations.reports.kpi.maintenance.label","مصاريف الصيانة","Maintenance"),w)),t}function q(){const e=y.lastSnapshot?.metrics||{},t=document.createElement("section");t.className="rpt-revenue-section";const r=document.createElement("h4");r.className="rpt-revenue__title",r.textContent=s("reservations.reports.kpi.revenue.details.title","تفاصيل الإيرادات","Revenue details");const d=document.createElement("div");d.className="rpt-revenue";const o=(c,g)=>{const w=document.createElement("div");w.className="rpt-revenue__item";const b=document.createElement("span");b.className="rpt-revenue__label",b.textContent=c;const u=document.createElement("strong");u.className="rpt-revenue__value",u.textContent=g,w.appendChild(b),w.appendChild(u),d.appendChild(w)},l=c=>k(j(c||0));return o(s("reservations.reports.kpi.revenue.details.gross","الإيراد الكلي","Gross revenue"),l(e.revenue)),o(s("reservations.reports.kpi.revenue.details.share","نسبة الشركة","Company share"),l(e.companyShareTotal)),o(s("reservations.reports.kpi.revenue.details.tax","الضريبة","Tax"),l(e.taxTotal)),o(s("reservations.reports.kpi.revenue.details.crewGross","إجمالي الطاقم","Crew total"),l(e.crewTotal)),o(s("reservations.reports.kpi.revenue.details.crew","تكلفة الطاقم","Crew cost"),l(e.crewCostTotal)),Number.isFinite(Number(e.maintenanceExpense))&&o(s("reservations.reports.kpi.revenue.details.maintenance","مصاريف الصيانة","Maintenance"),l(e.maintenanceExpense)),o(s("reservations.reports.kpi.revenue.details.net","صافي الربح","Net profit"),l(e.netProfit)),t.appendChild(r),t.appendChild(d),t}function Z(e){const t=document.createElement("table");t.className="rpt-table";const r=document.createElement("thead"),d=document.createElement("tr");e.forEach(l=>{const c=document.createElement("th");c.textContent=l,d.appendChild(c)}),r.appendChild(d);const o=document.createElement("tbody");return t.appendChild(r),t.appendChild(o),{table:t,tbody:o}}function Y(e,t){const o=[];for(let l=0;l<e.length;l+=28)o.push(e.slice(l,l+28));if(o.length){const l=o[0];if(l.length>18){const c=l.splice(18);o.length>1?o[1]=c.concat(o[1]):o.push(c)}}return o}function _(e=[]){try{const t=new Set;return e.forEach(r=>{const d=`reportsPdf.column.${r}`,o=localStorage.getItem(d);(o==null||o==="1")&&t.add(r)}),t}catch{return new Set(e)}}function T(e,t,r){if(!r)return e;const d=r.showPaid??!0,o=r.showUnpaid??!0,l=r.showConfirmed??!0,c=r.showPending??!0,g=r.showCompleted??!0,w=t.find(h=>/الحالة|status/i.test(h))||null,b=t.find(h=>/الدفع|payment/i.test(h))||null;if(!w&&!b)return e;const u=h=>/مدفوعة|مدفوع|paid|partial/i.test(h||""),p=h=>/غير مدفوعة|غير مدفوع|unpaid/i.test(h||""),m=h=>{const n=String(h||"").toLowerCase();return/completed|منته/.test(n)?"completed":/confirmed|مؤكد/.test(n)?"confirmed":/pending|غير مؤكد|قيد التأكيد/.test(n)?"pending":"other"};return e.filter(h=>{let n=!0;if(b){const a=h[b];!d&&u(a)&&(n=!1),!o&&p(a)&&(n=!1)}if(w){const a=m(h[w]);!g&&a==="completed"&&(n=!1),!l&&a==="confirmed"&&(n=!1),!c&&a==="pending"&&(n=!1)}return n})}function N(e=[],{context:t="preview",columns:r,rowFilters:d}={}){const o=B(t),l=o.querySelector("[data-a4-pages]"),c=Array.isArray(e)&&e.length?e:y.lastSnapshot?.tableRows||[];let g=Object.keys(c[0]||{});const w=r&&r.length?new Set(r):_(g);g=g.filter(p=>w.has(p));const b=T(c,g,d),u=Y(b);return u.length||u.push([]),u.forEach((p,m)=>{const h=document.createElement("section");h.className=`a4-page ${m===0?"a4-page--primary":"a4-page--continuation"}`,h.style.width=`${E}px`,h.style.height=`${F}px`;const n=document.createElement("div");n.className="a4-inner",m===0&&(n.appendChild(K()),n.appendChild(V()),n.appendChild(q()));const{table:a,tbody:i}=Z(g);p.forEach(f=>{const x=document.createElement("tr");g.forEach(C=>{const P=document.createElement("td"),v=document.createElement("div");v.className="rpt-cell",v.textContent=f[C]!=null?String(f[C]):"",P.appendChild(v),x.appendChild(P)}),i.appendChild(x)}),n.appendChild(a),h.appendChild(n),l.appendChild(h)}),o}async function de(e=[],{action:t="save",strict:r=!1}={}){const d=N(e,{context:"export"}),o=document.createElement("div");Object.assign(o.style,{position:"fixed",top:0,left:0,width:0,height:0,pointerEvents:"none",zIndex:-1}),o.appendChild(d),document.body.appendChild(o);try{if(r||localStorage.getItem("reportsPdf.strict")==="on"){await new Promise(f=>setTimeout(f,0));const n=document.createElement("iframe");Object.assign(n.style,{position:"fixed",width:"1px",height:"1px",right:"0",bottom:"0",border:"0",opacity:"0",pointerEvents:"none"}),document.body.appendChild(n);const a=n.contentWindow?.document,i=`<!DOCTYPE html><html lang="ar" dir="rtl"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1" /><title>${s("reservations.reports.print.title","تقرير الحجوزات","Reservations report")}</title><style>@page{size:A4;margin:0;}html,body{margin:0;padding:0;background:#fff;direction:rtl;text-align:right;}#reports-a4-root{width:${E}px;height:auto} .a4-page{width:${E}px;height:${F}px}</style></head><body></body></html>`;try{a.open(),a.write(i),a.close()}catch{}try{const f=d.cloneNode(!0);a.body.appendChild(f),a.fonts?.ready&&await a.fonts.ready}catch{}await new Promise(f=>setTimeout(f,60));try{n.contentWindow?.focus(),n.contentWindow?.print()}catch{}setTimeout(()=>{try{n.remove()}catch{}},1500);return}try{await z()}catch{}let c=window.jspdf&&window.jspdf.jsPDF||window.jsPDF&&window.jsPDF.jsPDF||window.jspdf&&window.jspdf.default&&window.jspdf.default.jsPDF||window.jsPDF&&window.jsPDF.default&&window.jsPDF.default.jsPDF,g=window.html2canvas;if(typeof c!="function")try{await A("https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"),c=window.jspdf&&window.jspdf.jsPDF||window.jsPDF&&window.jsPDF.jsPDF||window.jsPDF&&window.jsPDF.default&&window.jsPDF.default.jsPDF||window.jspdf&&window.jspdf.default&&window.jspdf.default.jsPDF}catch{}if(typeof g!="function")try{await A("https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"),g=window.html2canvas}catch{}if(typeof c!="function"||typeof g!="function"){const n=typeof c=="function",a=typeof g=="function";throw new Error(`PDF dependencies not available (jsPDF: ${n}, html2canvas: ${a})`)}const w=new c({unit:"mm",format:"a4",orientation:"portrait",compress:!0}),b=Math.min(2,Math.max(1.6,(window.devicePixelRatio||1)*1.25)),u=(()=>{try{const n=e&&e[0]?Object.keys(e[0]):Object.keys(y.lastSnapshot?.tableRows?.[0]||{}),a=_(n);return n.filter(i=>a.has(i))}catch{return null}})(),p={showPaid:localStorage.getItem("reportsPdf.rows.paid")!=="0",showUnpaid:localStorage.getItem("reportsPdf.rows.unpaid")!=="0",showConfirmed:localStorage.getItem("reportsPdf.rows.confirmed")!=="0",showPending:localStorage.getItem("reportsPdf.rows.pending")!=="0",showCompleted:localStorage.getItem("reportsPdf.rows.completed")!=="0"},m=N(e,{context:"export",columns:u||void 0,rowFilters:p});o.innerHTML="",o.appendChild(m);const h=Array.from(m.querySelectorAll(".a4-page"));for(let n=0;n<h.length;n+=1){const a=h[n],f=(await g(a,{scale:b,scrollX:0,scrollY:0,backgroundColor:"#ffffff",useCORS:!0,allowTaint:!1,windowWidth:E,windowHeight:F,letterRendering:!0,imageTimeout:0})).toDataURL("image/jpeg",.98);n>0&&w.addPage(),w.addImage(f,"JPEG",0,0,U,$,`page-${n+1}`,"FAST"),await new Promise(x=>requestAnimationFrame(x))}if(t==="print"){const n=w.output("bloburl");await new Promise(a=>{const i=document.createElement("iframe");Object.assign(i.style,{position:"fixed",right:0,bottom:0,width:"1px",height:"1px",border:0}),i.onload=()=>{try{i.contentWindow?.focus(),i.contentWindow?.print()}catch{}setTimeout(()=>{i.remove(),a()},700)},i.src=n,document.body.appendChild(i)})}else{const n=w.output("blob"),a=URL.createObjectURL(n),i=document.createElement("a");i.href=a,i.download="reservations-report.pdf",i.rel="noopener",i.style.display="none",document.body.appendChild(i),i.click(),setTimeout(()=>{try{URL.revokeObjectURL(a),i.remove()}catch{}},1500)}}finally{o.remove()}}async function ce(e=[]){await H();const t=window.XLSX;if(!t)throw new Error("XLSX dependency not available");const r=e&&e[0]?Object.keys(e[0]):Object.keys(y.lastSnapshot?.tableRows?.[0]||{}),d=_(r),o=r.filter(f=>d.has(f)),l={showPaid:localStorage.getItem("reportsPdf.rows.paid")!=="0",showUnpaid:localStorage.getItem("reportsPdf.rows.unpaid")!=="0",showConfirmed:localStorage.getItem("reportsPdf.rows.confirmed")!=="0",showPending:localStorage.getItem("reportsPdf.rows.pending")!=="0",showCompleted:localStorage.getItem("reportsPdf.rows.completed")!=="0"},c=Array.isArray(e)&&e.length?e:y.lastSnapshot?.tableRows||[],g=T(c,o,l),w=s("reservations.reports.print.title","تقرير الحجوزات","Reservations report"),b=`${L(new Date)} • ${s("reservations.reports.print.generated","تاريخ التوليد","Generated on")}`,u=y.lastSnapshot?.metrics||{},p=[];p.push([w]),p.push([b]),p.push([]),p.push([s("reservations.reports.kpi.total.label","إجمالي الحجوزات","Total"),String(u.total??0),s("reservations.reports.kpi.revenue.label","الإيرادات","Revenue"),String(u.revenue??0),s("reservations.reports.kpi.net.label","صافي الربح","Net"),String(u.netProfit??0)]),p.push([s("reservations.reports.kpi.share.label","نسبة الشركة","Company share"),String(u.companyShareTotal??0),s("reservations.reports.kpi.tax.label","الضريبة","Tax"),String(u.taxTotal??0),s("reservations.reports.kpi.maintenance.label","مصاريف الصيانة","Maintenance"),String(u.maintenanceExpense??0)]),p.push([]),p.push(o),g.forEach(f=>{const x=o.map(C=>f[C]!=null?String(f[C]):"");p.push(x)});const m=t.utils.aoa_to_sheet(p);m["!merges"]||(m["!merges"]=[]);const h=Math.max(1,o.length)-1;m["!merges"].push({s:{r:0,c:0},e:{r:0,c:Math.max(3,h)}}),m["!merges"].push({s:{r:1,c:0},e:{r:1,c:Math.max(3,h)}});const n=o.map((f,x)=>{let P=(f||"").length+2;for(let v=7;v<p.length;v+=1){const S=p[v][x]||"";P=Math.max(P,String(S).length)}return{wch:Math.min(40,Math.max(10,P))}});m["!cols"]=n;const a=t.utils.book_new();t.utils.book_append_sheet(a,m,s("reservations.reports.export.sheetName","الحجوزات","Reservations"));const i=`${s("reservations.reports.export.filePrefix","تقرير-الحجوزات","reservations-report")}.xlsx`;t.writeFile(a,i)}async function me(e=[]){const t=e&&e[0]?Object.keys(e[0]):Object.keys(y.lastSnapshot?.tableRows?.[0]||{}),r=_(t),d=t.filter(n=>r.has(n)),o={showPaid:localStorage.getItem("reportsPdf.rows.paid")!=="0",showUnpaid:localStorage.getItem("reportsPdf.rows.unpaid")!=="0",showConfirmed:localStorage.getItem("reportsPdf.rows.confirmed")!=="0",showPending:localStorage.getItem("reportsPdf.rows.pending")!=="0",showCompleted:localStorage.getItem("reportsPdf.rows.completed")!=="0"},l=Array.isArray(e)&&e.length?e:y.lastSnapshot?.tableRows||[],c=T(l,d,o),g=s("reservations.reports.print.title","تقرير الحجوزات","Reservations report"),w=`${L(new Date)} • ${s("reservations.reports.print.generated","تاريخ التوليد","Generated on")}`,b=y.lastSnapshot?.metrics||{},u=M(),p=n=>{const a=String(n??"");return/[",\n]/.test(a)?'"'+a.replace(/"/g,'""')+'"':a},m=[];m.push(p(g)),m.push(p(w)),m.push(`Logo,${p(u)}`),m.push(""),m.push([s("reservations.reports.kpi.total.label","إجمالي الحجوزات","Total"),b.total??0,s("reservations.reports.kpi.revenue.label","الإيرادات","Revenue"),b.revenue??0,s("reservations.reports.kpi.net.label","صافي الربح","Net"),b.netProfit??0].map(p).join(",")),m.push([s("reservations.reports.kpi.share.label","نسبة الشركة","Company share"),b.companyShareTotal??0,s("reservations.reports.kpi.tax.label","الضريبة","Tax"),b.taxTotal??0,s("reservations.reports.kpi.maintenance.label","مصاريف الصيانة","Maintenance"),b.maintenanceExpense??0].map(p).join(",")),m.push(""),m.push(d.map(p).join(",")),c.forEach(n=>{const a=d.map(i=>p(n[i]!=null?n[i]:""));m.push(a.join(","))});let h=!1;try{await X();const n=window.JSZip;if(n){const a=new n,i=s("reservations.reports.export.filePrefix","تقرير-الحجوزات","reservations-report"),f=["\uFEFF"+m.slice(0,m.indexOf(d.map(p).join(","))).join(`
`)],x=["\uFEFF"+[d.map(p).join(","),...c.map(S=>d.map(R=>p(S[R]??"")).join(","))].join(`
`)];a.file(`${i}-metadata.csv`,f.join("")),a.file(`${i}.csv`,x.join(""));try{const R=await(await fetch(u,{mode:"cors"})).blob();a.file("logo.png",R)}catch{}const C=await a.generateAsync({type:"blob"}),P=URL.createObjectURL(C),v=document.createElement("a");v.href=P,v.download=`${i}.zip`,v.style.display="none",document.body.appendChild(v),v.click(),setTimeout(()=>{URL.revokeObjectURL(P),v.remove()},1500),h=!0}}catch{}if(!h){const n=new Blob(["\uFEFF"+m.join(`
`)],{type:"text/csv;charset=utf-8"}),a=URL.createObjectURL(n),i=document.createElement("a");i.href=a,i.download=`${s("reservations.reports.export.filePrefix","تقرير-الحجوزات","reservations-report")}.csv`,i.style.display="none",document.body.appendChild(i),i.click(),setTimeout(()=>{URL.revokeObjectURL(a),i.remove()},1500)}}const Q="https://art-ratio.sirv.com/AR-Logo-v3.5-curved.png";function M(){try{const e=localStorage.getItem("reportsPdf.logoUrl");if(e&&/^https?:|^data:|^blob:/.test(e))return e}catch{}return Q}export{N as buildA4ReportPages,me as exportA4ReportCsv,ce as exportA4ReportExcel,de as exportA4ReportPdf};
