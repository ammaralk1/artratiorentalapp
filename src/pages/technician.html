<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title data-i18n data-i18n-key="technicianDetails.pageTitle">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¹Ø¶Ùˆ Ø§Ù„Ø·Ø§Ù‚Ù…</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <script>
    (function () {
      try {
        var theme = localStorage.getItem('app-theme');
        if (!theme && window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
          theme = 'dark';
        }
        if (theme === 'dark') {
          document.documentElement.classList.add('dark-mode');
        }
      } catch (error) {
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
          document.documentElement.classList.add('dark-mode');
        }
      }
    })();
  </script>

  <!-- Bootstrap RTL -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/src/styles/index.css">

  <!-- Flatpickr CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
</head>
<body>
  <div class="container py-5">
    <div class="d-flex flex-wrap justify-content-between align-items-center mb-4 gap-2">
      <h2 class="mb-0" data-i18n data-i18n-key="technicianDetails.title">ğŸ˜ Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ø¶Ùˆ Ø§Ù„Ø·Ø§Ù‚Ù…</h2>
      <div class="d-flex gap-2">
        <button class="btn btn-outline-secondary language-toggle-btn" id="language-toggle" data-label-ar="ğŸ‡¸ğŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©" data-label-en="ğŸ‡¬ğŸ‡§ English" aria-pressed="false"></button>
        <button class="btn btn-outline-secondary theme-toggle-btn" id="theme-toggle" data-i18n data-i18n-key="actions.toggleTheme">ğŸŒ™ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ</button>
        <a href="dashboard.html" class="btn btn-secondary" data-i18n data-i18n-key="technicianDetails.actions.back">â¬…ï¸ Ø§Ù„Ø¹ÙˆØ¯Ø©</a>
      </div>
    </div>

    <div class="box">
      <div id="technician-details">
        <!-- ØªÙØ§ØµÙŠÙ„ Ø¹Ø¶Ùˆ Ø§Ù„Ø·Ø§Ù‚Ù… Ø³ÙŠØªÙ… Ø¹Ø±Ø¶Ù‡Ø§ Ù‡Ù†Ø§ -->
      </div>
    </div>

    <section class="technician-reservations-section mt-4">
      <div class="d-flex flex-wrap gap-2 align-items-center mb-3 filters-bar">
        <input type="text" id="technician-search-reservation" class="form-control w-auto" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø£Ùˆ Ø±Ù‚Ù… Ø§Ù„Ø­Ø¬Ø²..." data-i18n data-i18n-placeholder-key="technicianDetails.filters.search">
        <input type="text" id="technician-filter-start-date" class="form-control w-auto" placeholder="ğŸ“… Ù…Ù† ØªØ§Ø±ÙŠØ®" data-i18n data-i18n-placeholder-key="reservations.list.filters.start">
        <input type="text" id="technician-filter-end-date" class="form-control w-auto" placeholder="ğŸ“… Ø¥Ù„Ù‰ ØªØ§Ø±ÙŠØ®" data-i18n data-i18n-placeholder-key="reservations.list.filters.end">
        <select id="technician-reservation-date-range" class="form-select w-auto">
          <option value="" data-i18n data-i18n-key="reservations.list.filters.range.all">â±ï¸ ÙƒÙ„ Ø§Ù„ØªÙˆØ§Ø±ÙŠØ®</option>
          <option value="today" data-i18n data-i18n-key="reservations.list.filters.range.today">ğŸ“… Ø§Ù„ÙŠÙˆÙ…</option>
          <option value="week" data-i18n data-i18n-key="reservations.list.filters.range.week">ğŸ“† Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</option>
          <option value="month" data-i18n data-i18n-key="reservations.list.filters.range.month">ğŸ—“ï¸ Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±</option>
        </select>
        <select id="technician-reservation-status-filter" class="form-select w-auto">
          <option value="" data-i18n data-i18n-key="reservations.list.filters.status.all">âš™ï¸ ÙƒÙ„ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option>
          <option value="confirmed" data-i18n data-i18n-key="reservations.list.filters.status.confirmed">âœ… Ù…Ø¤ÙƒØ¯Ø©</option>
          <option value="pending" data-i18n data-i18n-key="reservations.list.filters.status.pending">â³ ØºÙŠØ± Ù…Ø¤ÙƒØ¯Ø©</option>
          <option value="completed" data-i18n data-i18n-key="reservations.list.filters.status.completed">ğŸ“ Ù…Ù†ØªÙ‡ÙŠØ©</option>
        </select>
        <button type="button" class="btn btn-outline-secondary" id="technician-clear-filters" data-i18n data-i18n-key="actions.clearFilters">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØµÙÙŠØ©</button>
      </div>
      <div id="technician-reservations" class="mt-3"></div>
    </section>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>

  <script type="module" src="/src/scripts/translations/common.js"></script>
  <script type="module" src="/src/scripts/translations/dashboard.js"></script>
  <script type="module" src="/src/scripts/translations/technician.js"></script>

  <script type="module">
    import { getTechnicianById, syncTechniciansStatuses } from '/src/scripts/technicians.js';
    import { renderTechnicianReservations } from '/src/scripts/technicianDetails.js';
    import { showReservationDetails } from '/src/scripts/reservationsUI.js';
    import { normalizeNumbers } from '/src/scripts/utils.js';
    import { applyStoredTheme, initThemeToggle } from '/src/scripts/theme.js';
    import { t } from '/src/scripts/language.js';

    applyStoredTheme();

    const urlParams = new URLSearchParams(window.location.search);
    const technicianId = urlParams.get('id');
    const container = document.getElementById('technician-details');

    window.showReservationDetails = showReservationDetails;
    initThemeToggle();

    function formatWageValue(wage) {
      const wageNumber = Number(wage ?? 0);
      if (!Number.isFinite(wageNumber)) return '0';
      return wageNumber.toLocaleString('en-US', {
        minimumFractionDigits: 0,
        maximumFractionDigits: 2
      });
    }

    function renderTechnicianDetails(technician) {
      const nameDisplay = technician.name || t('technicianDetails.fallback.name', 'â€”');
      const statusKey = technician.status === 'busy'
        ? 'technicians.status.busy'
        : 'technicians.status.available';
      const statusClass = technician.status === 'busy' ? 'bg-danger' : 'bg-success';
      const statusBadge = `
        <span class="badge ${statusClass}" data-i18n data-i18n-key="${statusKey}">
          ${t(statusKey)}
        </span>
      `;

      const phoneValue = technician.phone
        ? normalizeNumbers(technician.phone)
        : `<span data-i18n data-i18n-key="reservations.details.technicians.phoneUnknown">${t('reservations.details.technicians.phoneUnknown', 'ØºÙŠØ± Ù…ØªÙˆÙØ±')}</span>`;

      const roleValue = technician.role
        ? technician.role
        : `<span data-i18n data-i18n-key="technicianDetails.fallback.role">${t('technicianDetails.fallback.role', 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯')}</span>`;

      const departmentValue = technician.department
        ? technician.department
        : `<span data-i18n data-i18n-key="technicianDetails.fallback.department">${t('technicianDetails.fallback.department', 'â€”')}</span>`;

      const notesValue = technician.notes
        ? technician.notes
        : `<span data-i18n data-i18n-key="technicianDetails.fallback.notes">${t('technicianDetails.fallback.notes', 'â€”')}</span>`;

      const currencyLabel = t('reservations.create.summary.currency', 'Ø±ÙŠØ§Ù„');
      const currencySpan = `<span data-i18n data-i18n-key="reservations.create.summary.currency">${currencyLabel}</span>`;
      const wageValue = `${formatWageValue(technician.dailyWage)} ${currencySpan}`;

      const baseStatus = technician.baseStatus || technician.status || 'available';
      const baseStatusKey = baseStatus === 'busy'
        ? 'technicians.status.busy'
        : 'technicians.status.available';
      const baseStatusValue = `<span data-i18n data-i18n-key="${baseStatusKey}">${t(baseStatusKey)}</span>`;
      const editButtonLabel = t('technicianDetails.actions.edit', 'âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø¹Ø¶Ùˆ Ø§Ù„Ø·Ø§Ù‚Ù…');

      const detailRows = [
        { key: 'technicianDetails.fields.role', value: roleValue },
        { key: 'technicianDetails.fields.department', value: departmentValue },
        { key: 'technicianDetails.fields.phone', value: phoneValue },
        { key: 'technicianDetails.fields.wage', value: wageValue },
        { key: 'technicianDetails.fields.baseStatus', value: baseStatusValue },
        { key: 'technicianDetails.fields.notes', value: notesValue }
      ].map(({ key, value }) => `
        <p class="technician-detail-row">
          <strong data-i18n data-i18n-key="${key}">${t(key)}</strong>
          <span>${value}</span>
        </p>
      `).join('');

      container.innerHTML = `
        <div class="technician-details">
          <div class="d-flex align-items-center gap-2 technician-header">
            <h3 class="mb-0 technician-name">${nameDisplay}</h3>
            ${statusBadge}
          </div>
          <div class="technician-details-body">
            ${detailRows}
          </div>
          <div class="d-flex justify-content-start mt-3 gap-2">
            <button type="button" class="btn btn-warning" id="edit-technician-btn" data-i18n data-i18n-key="technicianDetails.actions.edit">${editButtonLabel}</button>
          </div>
        </div>
      `;
    }

    function loadTechnicianDetails() {
      if (!technicianId) {
        container.innerHTML = `<p class="text-danger" data-i18n data-i18n-key="technicianDetails.errors.missingId">${t('technicianDetails.errors.missingId', 'âš ï¸ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø¹Ø±Ù Ø¹Ø¶Ùˆ Ø·Ø§Ù‚Ù… ÙÙŠ Ø§Ù„Ø±Ø§Ø¨Ø·.')}</p>`;
        return;
      }

      syncTechniciansStatuses();
      const technician = getTechnicianById(technicianId);

      if (!technician) {
        container.innerHTML = `<p class="text-danger" data-i18n data-i18n-key="technicianDetails.errors.notFound">${t('technicianDetails.errors.notFound', 'âš ï¸ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ø¹Ø¶Ùˆ.')}</p>`;
      } else {
        renderTechnicianDetails(technician);
        renderTechnicianReservations(technicianId);
        const inlineBtn = document.getElementById('edit-technician-btn');
        if (inlineBtn) {
          inlineBtn.onclick = () => {
            const modalEl = document.getElementById('editTechnicianModal');
            document.dispatchEvent(new CustomEvent('technician:prefill', { detail: technician }));
            if (modalEl && window.bootstrap?.Modal) {
              window.bootstrap.Modal.getOrCreateInstance(modalEl).show();
            }
          };
        }
      }
    }

    document.addEventListener('technicians:updated', () => {
      if (!technicianId) return;
      const refreshed = getTechnicianById(technicianId);
      if (!refreshed) return;
      renderTechnicianDetails(refreshed);
      if (typeof window.refreshTechnicianReservationsViews === 'function') {
        window.refreshTechnicianReservationsViews();
      }
      const inlineBtn = document.getElementById('edit-technician-btn');
      if (inlineBtn && refreshed) {
        inlineBtn.onclick = () => {
          const modalEl = document.getElementById('editTechnicianModal');
          document.dispatchEvent(new CustomEvent('technician:prefill', { detail: refreshed }));
          if (modalEl && window.bootstrap?.Modal) {
            window.bootstrap.Modal.getOrCreateInstance(modalEl).show();
          }
        };
      }
    });

    loadTechnicianDetails();
  </script>

  <!-- âœ… Ù…ÙˆØ¯Ø§Ù„ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø­Ø¬Ø² -->
  <div class="modal fade" id="reservationDetailsModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" data-i18n data-i18n-key="reservations.details.modalTitle">ğŸ“‹ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø­Ø¬Ø²</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Ø¥ØºÙ„Ø§Ù‚" data-i18n data-i18n-aria-label-key="actions.close"></button>
        </div>
        <div class="modal-body" id="reservation-details-body"></div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" data-i18n data-i18n-key="actions.close">Ø¥ØºÙ„Ø§Ù‚</button>
        </div>
      </div>
    </div>
  </div>

  <!-- âœ… Ù…ÙˆØ¯Ø§Ù„ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø­Ø¬Ø² -->
  <div class="modal fade" id="editReservationModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" data-i18n data-i18n-key="reservations.edit.modalTitle">âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø­Ø¬Ø²</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Ø¥ØºÙ„Ø§Ù‚" data-i18n data-i18n-aria-label-key="actions.close"></button>
        </div>
        <div class="modal-body">
          <form id="edit-reservation-form" class="row g-3">
            <input type="hidden" id="edit-res-index">

            <div class="col-md-6">
              <label class="form-label" for="edit-res-id" data-i18n data-i18n-key="reservations.edit.labels.id">ğŸ†” Ø±Ù‚Ù… Ø§Ù„Ø­Ø¬Ø²</label>
              <input type="text" class="form-control" id="edit-res-id" disabled>
            </div>
            <div class="col-md-6">
              <label class="form-label" for="edit-res-customer" data-i18n data-i18n-key="reservations.edit.labels.customer">ğŸ‘¤ Ø§Ù„Ø¹Ù…ÙŠÙ„</label>
              <input type="text" class="form-control" id="edit-res-customer" disabled>
            </div>

            <div class="col-md-6">
              <label class="form-label" for="edit-res-start" data-i18n data-i18n-key="reservations.edit.labels.startDate">ğŸ“… ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©</label>
              <input type="text" class="form-control" id="edit-res-start">
            </div>
            <div class="col-md-6">
              <label class="form-label" for="edit-res-start-time" data-i18n data-i18n-key="reservations.edit.labels.startTime">â° ÙˆÙ‚Øª Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©</label>
              <input type="text" class="form-control" id="edit-res-start-time">
            </div>

            <div class="col-md-6">
              <label class="form-label" for="edit-res-end" data-i18n data-i18n-key="reservations.edit.labels.endDate">ğŸ“… ØªØ§Ø±ÙŠØ® Ø§Ù„Ù†Ù‡Ø§ÙŠØ©</label>
              <input type="text" class="form-control" id="edit-res-end">
            </div>
            <div class="col-md-6">
              <label class="form-label" for="edit-res-end-time" data-i18n data-i18n-key="reservations.edit.labels.endTime">â° ÙˆÙ‚Øª Ø§Ù„Ù†Ù‡Ø§ÙŠØ©</label>
              <input type="text" class="form-control" id="edit-res-end-time">
            </div>

            <div class="col-md-6">
              <label class="form-label" for="edit-res-discount" data-i18n data-i18n-key="reservations.edit.labels.discount">ğŸ’µ Ø§Ù„Ø®ØµÙ…</label>
              <div class="input-group">
                <input type="text" class="form-control" id="edit-res-discount" placeholder="Ø§Ø¯Ø®Ù„ Ù‚ÙŠÙ…Ø© Ø§Ù„Ø®ØµÙ…" data-i18n data-i18n-placeholder-key="reservations.edit.placeholders.discount">
                <select id="edit-res-discount-type" class="form-select">
                  <option value="percent" data-i18n data-i18n-key="reservations.edit.discount.percent">Ùª Ù†Ø³Ø¨Ø©</option>
                  <option value="amount" data-i18n data-i18n-key="reservations.edit.discount.amount">ğŸ’µ Ù…Ø¨Ù„Øº</option>
                </select>
              </div>
            </div>
            <div class="col-md-6 d-flex align-items-center gap-3">
              <div class="form-check">
                <input type="checkbox" class="form-check-input" id="edit-res-tax">
                <label class="form-check-label" for="edit-res-tax" data-i18n data-i18n-key="reservations.edit.labels.tax">Ø´Ø§Ù…Ù„ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© (15%)</label>
              </div>
              <div class="form-check">
                <input type="checkbox" class="form-check-input" id="edit-res-confirmed">
                <label class="form-check-label" for="edit-res-confirmed" data-i18n data-i18n-key="reservations.edit.labels.confirmed">âœ… ØªÙ… Ø§Ù„ØªØ£ÙƒÙŠØ¯</label>
              </div>
            </div>

            <div class="col-md-6">
              <label class="form-label" for="edit-res-paid" data-i18n data-i18n-key="reservations.edit.labels.paymentStatus">ğŸ’³ Ø­Ø§Ù„Ø© Ø§Ù„Ø¯ÙØ¹</label>
              <select id="edit-res-paid" class="form-select">
                <option value="paid" data-i18n data-i18n-key="reservations.edit.payment.paid">Ù…Ø¯ÙÙˆØ¹</option>
                <option value="unpaid" selected data-i18n data-i18n-key="reservations.edit.payment.unpaid">Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¯ÙØ¹</option>
              </select>
            </div>

            <div class="col-12">
              <label class="form-label" for="edit-res-notes" data-i18n data-i18n-key="reservations.edit.labels.notes">ğŸ“ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
              <textarea class="form-control" id="edit-res-notes" rows="3" placeholder="Ø§ÙƒØªØ¨ Ø£ÙŠ Ù…Ù„Ø§Ø­Ø¸Ø§Øª..." data-i18n data-i18n-placeholder-key="reservations.edit.placeholders.notes"></textarea>
            </div>

            <div class="col-12">
              <label class="form-label" data-i18n data-i18n-key="technicians.picker.selectedLabel">ğŸ˜ Ø·Ø§Ù‚Ù… Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ù…Ø´Ø§Ø±Ùƒ</label>
              <div id="edit-selected-technicians-list" class="selected-technicians-list"></div>
              <button type="button" class="btn btn-outline-primary mt-2" id="open-edit-technician-picker" data-i18n data-i18n-key="technicians.picker.editButton">ğŸ” ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø·Ø§Ù‚Ù…</button>
            </div>

            <div class="col-12">
              <div id="edit-res-summary" class="alert alert-info"></div>
            </div>

            <div class="col-12">
              <label class="form-label" data-i18n data-i18n-key="reservations.edit.labels.addEquipment">ğŸ¥ Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø¯Ø©</label>
              <div class="row g-2 mb-2">
                <div class="col-md-6">
                  <input type="text" class="form-control" id="edit-res-equipment-barcode" placeholder="ğŸ” Ø§Ù…Ø³Ø­ Ø£Ùˆ Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯ Ø«Ù… Ø§Ø¶ØºØ· Enter" data-i18n data-i18n-placeholder-key="reservations.edit.placeholders.barcode">
                </div>
                <div class="col-md-6">
                  <input type="text" class="form-control" id="edit-res-equipment-description" list="edit-res-equipment-description-options" placeholder="ğŸ¥ Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ø¯Ø© Ø«Ù… Ø§Ø¶ØºØ· Enter" data-i18n data-i18n-placeholder-key="reservations.edit.placeholders.description">
                  <datalist id="edit-res-equipment-description-options"></datalist>
                </div>
              </div>
              <div class="table-responsive">
                <table class="table table-sm table-hover align-middle reservation-items-table">
                  <thead class="table-light">
                    <tr>
                      <th data-i18n data-i18n-key="reservations.edit.table.headers.code">Ø§Ù„ÙƒÙˆØ¯</th>
                      <th data-i18n data-i18n-key="reservations.edit.table.headers.description">Ø§Ù„ÙˆØµÙ</th>
                      <th data-i18n data-i18n-key="reservations.edit.table.headers.price">Ø§Ù„Ø³Ø¹Ø±</th>
                      <th data-i18n data-i18n-key="reservations.edit.table.headers.quantity">Ø§Ù„ÙƒÙ…ÙŠØ©</th>
                      <th data-i18n data-i18n-key="reservations.edit.table.headers.image">Ø§Ù„ØµÙˆØ±Ø©</th>
                      <th data-i18n data-i18n-key="reservations.edit.table.headers.delete">Ø­Ø°Ù</th>
                    </tr>
                  </thead>
                  <tbody id="edit-res-items">
                    <tr><td colspan="6" class="text-center" data-i18n data-i18n-key="reservations.edit.table.empty">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¹Ø¯Ø§Øª</td></tr>
                  </tbody>
                </table>
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" data-i18n data-i18n-key="actions.cancel">Ø¥Ù„ØºØ§Ø¡</button>
          <button type="button" class="btn btn-primary" id="save-reservation-changes" data-i18n data-i18n-key="reservations.edit.actions.save">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª</button>
        </div>
      </div>
    </div>
  </div>

  <!-- âœ… Ù…ÙˆØ¯Ø§Ù„ Ø§Ø®ØªÙŠØ§Ø± Ø·Ø§Ù‚Ù… Ø§Ù„Ø¹Ù…Ù„ -->
  <div class="modal fade" id="selectTechniciansModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" data-i18n data-i18n-key="technicians.picker.modalTitle">ğŸ˜ Ø§Ø®ØªÙŠØ§Ø± Ø·Ø§Ù‚Ù… Ø§Ù„Ø¹Ù…Ù„</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Ø¥ØºÙ„Ø§Ù‚" data-i18n data-i18n-aria-label-key="actions.close"></button>
        </div>
        <div class="modal-body">
          <div class="row g-2 align-items-center mb-3">
            <div class="col-sm-6">
              <input type="text" class="form-control" id="technician-picker-search" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„ÙˆØ¸ÙŠÙØ© Ø£Ùˆ Ø§Ù„Ù‚Ø³Ù…..." data-i18n data-i18n-placeholder-key="technicians.search.placeholder">
            </div>
          </div>
          <div class="table-responsive">
            <table class="table table-hover align-middle" id="technician-picker-table">
              <thead class="table-light">
                <tr>
                  <th style="width:40px;"></th>
                  <th data-i18n data-i18n-key="technicians.table.headers.name">Ø§Ù„Ø§Ø³Ù…</th>
                  <th data-i18n data-i18n-key="technicians.table.headers.role">Ø§Ù„ÙˆØ¸ÙŠÙØ©</th>
                  <th data-i18n data-i18n-key="technicians.table.headers.department">Ø§Ù„Ù‚Ø³Ù…</th>
                  <th data-i18n data-i18n-key="technicians.table.headers.status">Ø§Ù„Ø­Ø§Ù„Ø©</th>
                </tr>
              </thead>
              <tbody>
                <tr><td colspan="5" class="text-center text-muted" data-i18n data-i18n-key="technicians.table.loading">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</td></tr>
              </tbody>
            </table>
          </div>
        </div>
        <div class="modal-footer">
          <span class="text-muted me-auto" id="technician-picker-selection-info"></span>
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" data-i18n data-i18n-key="actions.cancel">Ø¥Ù„ØºØ§Ø¡</button>
          <button type="button" class="btn btn-primary" id="apply-technician-selection" data-i18n data-i18n-key="technicians.picker.actions.apply">ØªÙ…</button>
        </div>
      </div>
    </div>
  </div>

  <!-- âœ… Ù…ÙˆØ¯Ø§Ù„ ØªØ¹Ø¯ÙŠÙ„ Ø¹Ø¶Ùˆ Ø§Ù„Ø·Ø§Ù‚Ù… -->
  <div class="modal fade" id="editTechnicianModal" tabindex="-1" aria-labelledby="editTechnicianModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="editTechnicianModalLabel" data-i18n data-i18n-key="technicianDetails.edit.modalTitle">âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ø¶Ùˆ Ø§Ù„Ø·Ø§Ù‚Ù…</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Ø¥ØºÙ„Ø§Ù‚" data-i18n data-i18n-aria-label-key="actions.close"></button>
        </div>
        <div class="modal-body">
          <form id="edit-technician-form" class="row g-3">
            <input type="hidden" id="edit-technician-id">
            <div class="col-md-6">
              <label for="edit-technician-name" class="form-label" data-i18n data-i18n-key="technicians.form.labels.name">ğŸ˜ Ø§Ø³Ù… Ø§Ù„Ø¹Ø¶Ùˆ</label>
              <input type="text" class="form-control" id="edit-technician-name" required data-i18n data-i18n-placeholder-key="technicians.form.placeholders.name">
            </div>
            <div class="col-md-6">
              <label for="edit-technician-phone" class="form-label" data-i18n data-i18n-key="technicians.form.labels.phone">ğŸ“ Ø§Ù„Ø¬ÙˆØ§Ù„</label>
              <input type="text" class="form-control" id="edit-technician-phone" inputmode="tel" required data-i18n data-i18n-placeholder-key="technicians.form.placeholders.phone">
            </div>
            <div class="col-md-6">
              <label for="edit-technician-role" class="form-label" data-i18n data-i18n-key="technicians.form.labels.role">ğŸ‘” Ø§Ù„ÙˆØ¸ÙŠÙØ©</label>
              <input type="text" class="form-control" id="edit-technician-role" required data-i18n data-i18n-placeholder-key="technicians.form.placeholders.role">
            </div>
            <div class="col-md-6">
              <label for="edit-technician-department" class="form-label" data-i18n data-i18n-key="technicians.form.labels.department">ğŸ§© Ø§Ù„Ù‚Ø³Ù…</label>
              <input type="text" class="form-control" id="edit-technician-department" data-i18n data-i18n-placeholder-key="technicians.form.placeholders.department">
            </div>
            <div class="col-md-6">
              <label for="edit-technician-wage" class="form-label" data-i18n data-i18n-key="technicians.form.labels.wage">ğŸ’° Ø§Ù„Ø£Ø¬Ø± Ø§Ù„ÙŠÙˆÙ…ÙŠ</label>
              <input type="text" class="form-control" id="edit-technician-wage" inputmode="decimal" required data-i18n data-i18n-placeholder-key="technicians.form.placeholders.wage">
            </div>
            <div class="col-md-6">
              <label for="edit-technician-status" class="form-label" data-i18n data-i18n-key="technicians.form.labels.status">âš™ï¸ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</label>
              <select id="edit-technician-status" class="form-select" required>
                <option value="available" data-i18n data-i18n-key="technicians.form.options.available">âœ… Ù…ØªØ§Ø­</option>
                <option value="busy" data-i18n data-i18n-key="technicians.form.options.busy">â›” Ù…Ø´ØºÙˆÙ„</option>
              </select>
            </div>
            <div class="col-12">
              <label for="edit-technician-notes" class="form-label" data-i18n data-i18n-key="technicians.form.labels.notes">ğŸ“ Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
              <textarea id="edit-technician-notes" class="form-control" rows="2" data-i18n data-i18n-placeholder-key="technicians.form.placeholders.notes"></textarea>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" data-i18n data-i18n-key="actions.cancel">Ø¥Ù„ØºØ§Ø¡</button>
          <button type="button" class="btn btn-primary" id="save-technician-changes" data-i18n data-i18n-key="technicians.form.actions.update">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª</button>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
